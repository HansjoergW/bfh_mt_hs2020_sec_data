---

title: Complete

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_Complete.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_processed_folder</span>       <span class="o">=</span> <span class="s2">&quot;D:/data_mt/04_unified/&quot;</span>
<span class="n">all_completed_folder</span>       <span class="o">=</span> <span class="s2">&quot;D:/data_mt/05_completed/&quot;</span>

<span class="n">all_data_local_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/&quot;</span>

<span class="n">pivot_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">]</span>
<span class="n">analyze_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;value_count&quot;</span><span class="p">,</span><span class="s2">&quot;null_count&quot;</span><span class="p">,</span><span class="s2">&quot;difference&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">count_null</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">(</span><span class="n">pivot_group</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="n">value_cols</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">(</span><span class="n">analyze_fields</span><span class="p">)</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;null_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;lines with missing values: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">stmt</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;04_&quot;</span> <span class="o">+</span> <span class="n">stmt</span> <span class="o">+</span> <span class="s2">&quot;_unified.csv&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">filed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filed</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_number_of_reports</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    check if there is only one entry per report (unique adsh)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is there just one report per ADSH: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">missing_value_report</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="n">df_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;null_count&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_missing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Complete-BS">01_Complete BS<a class="anchor-link" href="#01_Complete-BS"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  1301
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116519, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-Equity">complete missing Equity<a class="anchor-link" href="#complete-missing-Equity"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># complete c_Equity = Assets - Liabilities</span>
<span class="n">do_set_equity</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">c_Equity</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;c_Equity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  559
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-liabilities">complete missing liabilities<a class="anchor-link" href="#complete-missing-liabilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do_set_liab</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">c_Equity</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">LiabilitiesNoncurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;c_Equity&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  282
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-assets">complete missing assets<a class="anchor-link" href="#complete-missing-assets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do_set_liab</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">c_Equity</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">AssetsCurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">AssetsNoncurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;c_Equity&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  274
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fields_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">analyze_fields</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">fields_to_drop</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_bs_completed.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_bs_completed.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;05_bs_completed.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/05_bs_completed.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Complete-CF">02_Complete CF<a class="anchor-link" href="#02_Complete-CF"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;cf&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  8631
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116187, 16)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-CashIncreaseDecrease">complete CashIncreaseDecrease<a class="anchor-link" href="#complete-CashIncreaseDecrease"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition CashIncreaseDecrease = NetCashProvidedByUsedInOperatingActivities + NetCashProvidedByUsedInInvestingActivities + NetCashProvidedByUsedInFinancingActivities</span>
<span class="n">do_set_cshinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashIncreaseDecrease</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromOperating</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> 
                 <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromInvesting</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;c_CashIncreaseDecrease&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;c_CashFromOperating&#39;</span><span class="p">]</span> \
                                                    <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;c_CashFromInvesting&#39;</span><span class="p">]</span> \
                                                    <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;c_CashFromFinancing&#39;</span><span class="p">]</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  377
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-c_CashFromOperating">complete c_CashFromOperating<a class="anchor-link" href="#complete-c_CashFromOperating"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition CashIncreaseDecrease = CashFromOperating + CashFromInvesting + CashFromFinancing</span>
<span class="c1"># hence CashFromOperating = CashIncreaseDecrease - (CashFromInvesting + CashFromFinancing)</span>
<span class="n">do_set_netop</span> <span class="o">=</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashIncreaseDecrease</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromOperating</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> 
                 <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromInvesting</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;c_CashFromOperating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;c_CashIncreaseDecrease&#39;</span><span class="p">]</span> \
                                                 <span class="o">-</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;c_CashFromInvesting&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;c_CashFromFinancing&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  312
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="invert-values-for-c_PaymentsOfDividendsTotal-and-c_PaymentsForRepurchaseOfStockTotal">invert values for c_PaymentsOfDividendsTotal and c_PaymentsForRepurchaseOfStockTotal<a class="anchor-link" href="#invert-values-for-c_PaymentsOfDividendsTotal-and-c_PaymentsForRepurchaseOfStockTotal"> </a></h3><p>Since PaymentsOfDividends and PaymentsForRepurchaseOfStock are outflowing, they appear with a negative number. However, it more intuitiv if have them as positive values</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span> <span class="o">=</span> <span class="o">-</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">c_PaymentsForRepurchaseOfStockTotal</span> <span class="o">=</span> <span class="o">-</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">c_PaymentsForRepurchaseOfStockTotal</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fields_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">analyze_fields</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">fields_to_drop</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_cf_completed.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_cf_completed.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;05_cf_completed.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/05_cf_completed.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Complete-IS">02_Complete IS<a class="anchor-link" href="#02_Complete-IS"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;is&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">is_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  116275
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116298, 17)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">is_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-GrossProfit">complete GrossProfit<a class="anchor-link" href="#complete-GrossProfit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue</span>
<span class="n">do_set_grossp</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_CostOfRevenue</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;c_CostOfRevenue&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition: grossprofit - opexpenses = op-income -&gt; grossprofit = opincome + opexpenses</span>
<span class="n">do_set_grossp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">OperatingExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-Revenues">complete Revenues<a class="anchor-link" href="#complete-Revenues"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue -&gt; Revenues = Grossprofit + CostOfRevenue</span>
<span class="n">do_set_rev</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_CostOfRevenue</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;c_CostOfRevenue&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span>
<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">is_df</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-CostOfRevenue">complete CostOfRevenue<a class="anchor-link" href="#complete-CostOfRevenue"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue -&gt; CostOfRevenue = Revenues - Grossprofit</span>
<span class="n">do_set_cstrev</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_CostOfRevenue</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;c_CostOfRevenue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-OperatingIncomeLoss">complete OperatingIncomeLoss<a class="anchor-link" href="#complete-OperatingIncomeLoss"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition: opIncomeLoss = grossprofit - opexpenses</span>
<span class="n">do_set_opinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">OperatingExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4251</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="estimate-c_OperatingIncomeLoss-based-on-GrossProfit-and-NetIncomeLoss">estimate c_OperatingIncomeLoss based on GrossProfit and NetIncomeLoss<a class="anchor-link" href="#estimate-c_OperatingIncomeLoss-based-on-GrossProfit-and-NetIncomeLoss"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if OperatingIncomeLoss is not set, we can try to estimate it based on the average compared to GrossProfit and NetIncomeLoss</span>

<span class="c1"># based on existing c_OperatingIncomeLoss Values, we calculate the average c_OperatingIncomeLoss between GrossProfit and NetIncomeLoss (in percent)</span>
<span class="c1">#  we may only consider entries where NetIncomeLoss isn&#39;t equal to GrossProfit. since this would cause a division by zero</span>
<span class="n">calc_mean_opinc_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span> <span class="o">!=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="p">))</span>
<span class="n">selected_cols</span> <span class="o">=</span> <span class="n">is_df</span><span class="p">[</span><span class="n">calc_mean_opinc_avg</span><span class="p">][[</span><span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">avg_opinc</span> <span class="o">=</span> <span class="p">((</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># if we have grossprofit and c_NetIncomeLoss, we try estimate OperatingIncomeLoss based on the average position</span>
<span class="n">do_updated_opinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>

<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> \
                                    <span class="o">-</span> <span class="n">avg_opinc</span> <span class="o">*</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3944</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="estimate-c_OperatingIncomeLoss-based-on-Revenues-and-NetIncomeLoss">estimate c_OperatingIncomeLoss based on Revenues and NetIncomeLoss<a class="anchor-link" href="#estimate-c_OperatingIncomeLoss-based-on-Revenues-and-NetIncomeLoss"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if OperatingIncomeLoss is not set, we can try to estimate it based on the average compared to Revenues and NetIncomeLoss</span>

<span class="c1"># based on existing c_OperatingIncomeLoss Values, we calculate the average c_OperatingIncomeLoss between Revenue and NetIncomeLoss (in percent)</span>
<span class="n">calc_mean_opinc_avg</span> <span class="o">=</span> <span class="p">((</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()))</span>
<span class="n">selected_cols</span> <span class="o">=</span> <span class="n">is_df</span><span class="p">[</span><span class="n">calc_mean_opinc_avg</span><span class="p">][[</span><span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">avg_opinc</span> <span class="o">=</span> <span class="p">((</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># if we have revenue and c_NetIncomeLoss, we try estimate OperatingIncomeLoss based on the average position</span>
<span class="n">do_updated_opinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>

<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> \
                                    <span class="o">-</span> <span class="n">avg_opinc</span> <span class="o">*</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_opinc</span><span class="p">,</span><span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>297</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="estimate-GrossProfit-based-on-Revenue-and-OperatingIncomeLoss">estimate GrossProfit based on Revenue and OperatingIncomeLoss<a class="anchor-link" href="#estimate-GrossProfit-based-on-Revenue-and-OperatingIncomeLoss"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if Grossprofit is not set, we can try to estimate it based on the average compared to reveneue and operatingIncomeLoss</span>

<span class="c1"># based on existing GrossProfit Values, we calculate the average grossprofit between Revenue and OperatingIncome (in percent)</span>
<span class="n">calc_mean_gp_selection</span> <span class="o">=</span> <span class="p">((</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()))</span>
<span class="n">selected_cols</span> <span class="o">=</span> <span class="n">is_df</span><span class="p">[</span><span class="n">calc_mean_gp_selection</span><span class="p">][[</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">avg_gross</span> <span class="o">=</span> <span class="p">((</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">GrossProfit</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># if we have revenue and operatingincome, we try estimate grossprofit based on the average position</span>
<span class="n">do_updated_grossprofit</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>

<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_grossprofit</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_grossprofit</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> \
                                    <span class="o">-</span> <span class="n">avg_gross</span> <span class="o">*</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_grossprofit</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_updated_grossprofit</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>879</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pivot_group</span><span class="p">)</span>
<span class="n">fields</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">,</span><span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[</span><span class="n">fields</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_is_completed.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_is_completed.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;05_is_completed.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/05_is_completed.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XX_Trials">XX_Trials<a class="anchor-link" href="#XX_Trials"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[((</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="p">))]</span> \
  <span class="p">[[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">,</span><span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">]]</span> <span class="c1">#721</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[((</span><span class="n">is_df</span><span class="o">.</span><span class="n">c_Revenues</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="p">))]</span> \
  <span class="p">[[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">,</span><span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">]]</span> <span class="c1">#721</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[((</span><span class="n">is_df</span><span class="o">.</span><span class="n">CostsAndExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span><span class="o">.</span><span class="n">isnull</span><span class="p">()))][[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">]]</span> <span class="c1">#721</span>
<span class="c1">#is_df[((is_df.OperatingExpenses.notnull() &amp; is_df.GrossProfit.isnull() &amp; is_df.c_OperatingIncomeLoss.notnull()))][[&#39;cik&#39;,&#39;adsh&#39;,&#39;OperatingExpenses&#39;,&#39;GrossProfit&#39;,&#39;c_OperatingIncomeLoss&#39;]] #11618</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">missing_value_report</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">qtrs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">cf_df</span><span class="p">[(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;cik&#39;, &#39;ticker&#39;, &#39;adsh&#39;, &#39;period&#39;, &#39;filed&#39;, &#39;form&#39;, &#39;qtrs&#39;, &#39;fp&#39;,
       &#39;c_CashIncreaseDecrease&#39;, &#39;c_CashFromOperating&#39;, &#39;c_CashFromInvesting&#39;,
       &#39;c_CashFromFinancing&#39;, &#39;c_PaymentsOfDividendsTotal&#39;,
       &#39;c_PaymentsForRepurchaseOfStockTotal&#39;, &#39;value_count&#39;, &#39;null_count&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromOperating</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromInvesting</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>312
0
0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

