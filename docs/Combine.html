---

title: Combine

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 06_Combine.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_completed_folder</span>       <span class="o">=</span> <span class="s2">&quot;D:/data_mt/05_completed/&quot;</span>
<span class="n">all_combined_folder</span>        <span class="o">=</span> <span class="s2">&quot;D:/data_mt/06_combined/&quot;</span>

<span class="n">all_data_local_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/&quot;</span>

<span class="n">join_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">]</span>
<span class="n">analyze_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">,</span><span class="s1">&#39;null_count&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_number_of_reports</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    check if there is only one entry per report (unique adsh)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is there just one report per ADSH: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">stmt</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_completed_folder</span> <span class="o">+</span> <span class="s2">&quot;05_&quot;</span> <span class="o">+</span> <span class="n">stmt</span> <span class="o">+</span> <span class="s2">&quot;_completed.csv&quot;</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">filed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filed</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;qtrs&#39;</span><span class="p">:</span><span class="n">stmt</span> <span class="o">+</span> <span class="s1">&#39;_qtrs&#39;</span><span class="p">})</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">count_null</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">(</span><span class="n">join_group</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="n">value_cols</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;bs_qtrs&#39;</span><span class="p">,</span><span class="s1">&#39;is_qtrs&#39;</span><span class="p">,</span><span class="s1">&#39;cf_qtrs&#39;</span><span class="p">])</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;null_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;lines with missing values: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_stats</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of reports:   &#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of companies: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Load-data">01_Load data<a class="anchor-link" href="#01_Load-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">)</span>
<span class="n">cf_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;cf&quot;</span><span class="p">)</span>
<span class="n">is_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;is&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bs: &quot;</span><span class="p">,</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cf: &quot;</span><span class="p">,</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is: &quot;</span><span class="p">,</span> <span class="n">is_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>bs:  (116519, 16)
cf:  (116187, 14)
is:  (116298, 12)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Join-data">02_Join data<a class="anchor-link" href="#02_Join-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">bs_df</span><span class="p">,</span> <span class="n">cf_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">join_group</span><span class="p">)</span>
<span class="n">joined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">joined_df</span><span class="p">,</span> <span class="n">is_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">join_group</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116643, 28)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="03Check-data">03<em>Check data</em><a class="anchor-link" href="#03Check-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># checkdata -&gt; every adsh should only appear once</span>
<span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">joined_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  1655
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plot count of missing values. y-axis shows the number of reports, x-axis shows how many values are missing</span>
<span class="n">joined_df</span><span class="o">.</span><span class="n">null_count</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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o6MV13vyyScxduxYnDhxAvX19QgLC8PQoUORnZ3dp/cmutlHQvr7+2P8+PEYP368olqJiYmIjY1FV1cXhg4diieeeALvv/8+fvSjH2H69OmKe1uxYgUef/xx/P3vf8f69esRERGBa9euYevWrfjmN7+puF5gYCA+//xzPPTQQ93GP/vssz79UbiyshLvvPMO4uLibvp4UlKSonpCCLS2tmLIkCEYNWoU3nzzTSxatKjPV7jt7e0YOXIk1q1b577yuXbtGjo7OxXXWrJkCaZNm4ZXX30VTz/9NJKSkjB06FBMmTJFcS0AaG1tRVNTE4xGI+x2u/vq2+Fw9OmKdMiQIbhw4QLGjh2Lr3/967h8+TIeeughWK1Wxc+tTqfD/fffj23btqGurg75+flYvnw5nE4njEYjDhw4oLg/ANo/kye6250+fVpER0eLZcuWifT0dLF27VqxbNkyER0dLSorK/tUMzU1VRw6dEiV/g4cOCBiYmJERUWFe+xf//qXiI6OFo8//riiWvv37xcxMTHdrm6rqqrEzJkzxcGDB/vco9PpFFu2bBFms1nMmTOnz3XWr18v5s6dK8LDw8WqVauEEEIcP35cREdHi9///veK63300Udi+vTpwmw2i7Vr14rp06eLH/zgByIqKkq8++67imrd6qrpypUr3WYflLqn7q4h6i9OpxPV1dVobGyEy+WC0WjEhAkT+nQmDwCNjY04evQonn/+eVX6q6urQ0BAQLerDbvdjoKCAixbtkxRrUuXLmH06NHu5c8//xwtLS0YO3bsbfd5+vRpHDt2DK+99tpt1XE4HLDZbAgJCcE///lPCCH6dJUG/O/7VFFRgfr6enR1deH+++/Hd77zHRiNRkV1ysvL+zwD0BuGPJGPffbZZ70+fuM0zt1cT8u9ab2e2r1dx5An8jGTyaTaHWJar3cnetPpdO475bT4vetrf2r35tbniR4i8oqad4hpvZ6We9N6PbV7u47vXUPkY9fvEDty5Ij09bTcm9brqd3bdZyuISKSGM/kiYgkxpAnIpIYQ56ISGIMeSIiiTHkiYgk9n+TU96JASdoPgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;companies with just one incomplete report: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">joined_df</span><span class="p">[</span><span class="n">joined_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">joined_df</span><span class="p">[</span><span class="n">joined_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">())))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>companies with just one incomplete report:  121
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plount count of available reports: y-axis shows the number of companies, x-axis shows number of reports available</span>
<span class="n">joined_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="04_Remove-Companies-with-missing-data">04_Remove Companies with missing data<a class="anchor-link" href="#04_Remove-Companies-with-missing-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_cleaned_df</span> <span class="o">=</span> <span class="n">joined_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">print_stats</span><span class="p">(</span><span class="n">joined_cleaned_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of reports:    116643
number of companies:  4356
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="only-consider-companies-with-at-least-4-years-of-data">only consider companies with at least 4 years of data<a class="anchor-link" href="#only-consider-companies-with-at-least-4-years-of-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filtered</span> <span class="o">=</span> <span class="n">joined_cleaned_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">15</span>
<span class="n">ciks_with_4yrplus</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[</span><span class="n">filtered</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ciks_with_4yrplus</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3533</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_cleaned_df</span> <span class="o">=</span> <span class="n">joined_cleaned_df</span><span class="p">[</span><span class="n">joined_cleaned_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ciks_with_4yrplus</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="n">joined_cleaned_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of reports:    109152
number of companies:  3533
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="remove-ciks-who-have-reports-with-missing-values">remove ciks who have reports with missing values<a class="anchor-link" href="#remove-ciks-who-have-reports-with-missing-values"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">joined_cleaned_df</span><span class="p">[</span><span class="n">joined_cleaned_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>455
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_cleaned_df</span> <span class="o">=</span> <span class="n">joined_cleaned_df</span><span class="p">[</span><span class="o">~</span><span class="n">joined_cleaned_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="n">joined_cleaned_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of reports:    95395
number of companies:  3078
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="05_Save">05_Save<a class="anchor-link" href="#05_Save"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joined_cleaned_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">analyze_cols</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_combined_folder</span> <span class="o">+</span> <span class="s2">&quot;06_all_combined.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_combined_folder</span> <span class="o">+</span> <span class="s2">&quot;06_all_combined.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;06_all_combined.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/06_all_combined.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

