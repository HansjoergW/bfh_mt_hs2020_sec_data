---

title: Uniform CF

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_02_Uniform_CF.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.dataframe</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_pivot_selected_folder</span>  <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_select&quot;</span>
<span class="n">all_pivoted_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_split&quot;</span>
<span class="n">all_processed_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_processed/&quot;</span>

<span class="n">col_list</span> <span class="o">=</span>    <span class="p">[</span><span class="s2">&quot;stmt&quot;</span><span class="p">,</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;uom&quot;</span><span class="p">]</span>
<span class="n">pivot_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># init Spark</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark_session</span><span class="p">()</span> <span class="c1"># Session anlegen</span>
<span class="n">spark</span> <span class="c1"># display the moste important information of the session</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <p><b>SparkSession - in-memory</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="http://192.168.0.163:4040">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v2.4.5</code></dd>
              <dt>Master</dt>
                <dd><code>local[*]</code></dd>
              <dt>AppName</dt>
                <dd><code>default</code></dd>
            </dl>
        </div>
        
            </div>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Raw_data">00_Raw_data<a class="anchor-link" href="#00_Raw_data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># loading the complete unpivoted dataset - if it is needed for debbuging</span>
<span class="n">df_all_selected</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivot_selected_folder</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># it happens sometimes, that the data could not be associated with a right sheet (bs, is, cf, ..). in this cases, the data can appea under &quot;UN&quot;</span>
<span class="c1"># so if expected information cannot be found in the appropriate statement, we have to look in the un statement</span>
<span class="n">un_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">all_pivoted_folder</span><span class="p">,</span> <span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;UN&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">un_pivot_pd</span> <span class="o">=</span> <span class="n">un_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">un_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5989, 1775)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">prepare_un_values</span><span class="p">(</span><span class="n">df_to_merge_into</span><span class="p">,</span> <span class="n">attr_list</span><span class="p">):</span>
    <span class="c1"># add possible columns from un set to  cf data with prefix cpy_</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="n">pivot_group</span><span class="p">[:]</span> <span class="c1"># create copy</span>
    <span class="n">attributes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">un_prepared</span> <span class="o">=</span> <span class="n">un_pivot_pd</span><span class="p">[</span><span class="n">attributes</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">un_prepared</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>  <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pivot_group</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;cpy_&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_to_merge_into</span><span class="p">,</span> <span class="n">un_prepared</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">pivot_group</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_CashFlow">01_CashFlow<a class="anchor-link" href="#01_CashFlow"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Operation</p>
<ul>
<li>NetIncomeLoss</li>
<li>ProfitLoss</li>
<li>NetCashProvidedByUsedInOperatingActivities: NetIncome + other positions ergibt diese Position</li>
</ul>
<p>Investing</p>
<ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>
<p>Financing activities</p>
<ul>
<li>PaymentsForRepurchaseOfCommonStock: Aktienrückkäufe</li>
<li>PaymentsOfDividends</li>
<li>NetCashProvidedByUsedInFinancingActivities</li>
</ul>
<p>Cash Bestand unterschied</p>
<ul>
<li>CashAndCashEquivalentsPeriodIncreaseDecrease: increase/decrease in cash</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">all_pivoted_folder</span><span class="p">,</span> <span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;CF&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">cf_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116187, 2436)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">cf_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116187, 2436)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Merge-Data-from-&quot;unknown&quot;-statement">Merge Data from "unknown" statement<a class="anchor-link" href="#Merge-Data-from-&quot;unknown&quot;-statement"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge relevant columns from the UN dataset</span>
<span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">prepare_un_values</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
     <span class="c1"># &#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span>   
    <span class="c1"># &#39;CashPeriodIncreaseDecrease&#39;,</span>
    <span class="c1"># &#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;,</span>
    <span class="s1">&#39;NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">,</span>
    
    <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
 
    <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span>
    
    <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39; ,</span>
<span class="p">])</span>
<span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116187, 2450)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cash-Increase/Decrease">Cash Increase/Decrease<a class="anchor-link" href="#Cash-Increase/Decrease"> </a></h3><ul>
<li>'CashAndCashEquivalentsPeriodIncreaseDecrease',</li>
<li>'CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect',</li>
<li>'CashPeriodIncreaseDecrease',</li>
<li>'CashPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'NetCashProvidedByUsedInContinuingOperations'</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashAndCashEquivalentsPeriodIncreaseDecrease   29201
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span> <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">)</span>


<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecrease&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashIncreaseDecrease_hj   1293
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NetIncomeLoss-/-Operation-CashFlow">NetIncomeLoss / Operation CashFlow<a class="anchor-link" href="#NetIncomeLoss-/-Operation-CashFlow"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   50151
ProfitLoss   73931
NetCashProvidedByUsedInOperatingActivities   30576
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetIncomeLoss&#39;</span><span class="p">,</span>  <span class="s1">&#39;NetIncomeLoss&#39;</span> <span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   137
ProfitLoss   137
NetCashProvidedByUsedInOperatingActivities   377
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Investing">Investing<a class="anchor-link" href="#Investing"> </a></h3><ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   31288
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span> <span class="p">,</span><span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span> <span class="c1"># it is absolutely possible, that there are no investing activities</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Financing-activities">Financing activities<a class="anchor-link" href="#Financing-activities"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="NetCashProvidedByUsedInFinancingActivities">NetCashProvidedByUsedInFinancingActivities<a class="anchor-link" href="#NetCashProvidedByUsedInFinancingActivities"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   31409
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">)</span>

<span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> 
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span> <span class="p">,</span>
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span> <span class="c1"># it is absolutely possible, that there are no financing activities</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsOfDividends">PaymentsOfDividends<a class="anchor-link" href="#PaymentsOfDividends"> </a></h4><p>Simply set to 0.0 if no data is present
 'PaymentsOfDividends',
 'PaymentsOfDividendsCommonStock',
 'PaymentsOfDividendsMinorityInterest',
 'PaymentsOfDividendsPreferredStockAndPreferenceStock',
 'PaymentsOfOrdinaryDividends',</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsOfDividendsTotal_hj&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsOfDividends&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsCommonStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsMinorityInterest&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfOrdinaryDividends&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsForRepurchaseOfCommonStock:-Stock-buybacks">PaymentsForRepurchaseOfCommonStock: Stock buybacks<a class="anchor-link" href="#PaymentsForRepurchaseOfCommonStock:-Stock-buybacks"> </a></h4><p>'PaymentsForRepurchaseOfCommonStock',
 'PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations',
 'PaymentsForRepurchaseOfConvertiblePreferredStock',
 'PaymentsForRepurchaseOfPreferredStockAndPreferenceStock',
 'PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock',
 'PaymentsForRepurchaseOfRedeemablePreferredStock'</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal_hj&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsForRepurchaseOfCommonStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemablePreferredStock&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span>
                                     <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsOfDividendsTotal_hj&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal_hj&#39;</span><span class="p">]]</span> \
                  <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;cf_not_cleaned.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XX_Trials">XX_Trials<a class="anchor-link" href="#XX_Trials"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># cf_pivot_value.select(&#39;adsh&#39;).distinct().count() # 116482</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;).where(&#39;form == &quot;10-K&quot;&#39;).distinct().count() # 27556</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;).where(&#39;form == &quot;10-Q&quot;&#39;).distinct().count() # 88926</span>

<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-K&quot; and qtrs=&quot;0&quot;&#39;).distinct().count() # 27264</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-K&quot; and qtrs=&quot;1&quot;&#39;).distinct().count() # 16405</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-K&quot; and qtrs=&quot;2&quot;&#39;).distinct().count() # 63</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-K&quot; and qtrs=&quot;3&quot;&#39;).distinct().count() # 44</span>
<span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="s1">&#39;qtrs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;form == &quot;10-K&quot; and qtrs=&quot;4&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># 27497</span>

<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-Q&quot; and qtrs=&quot;0&quot;&#39;).distinct().count() # 88076</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-Q&quot; and qtrs=&quot;1&quot;&#39;).distinct().count() # 86728</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-Q&quot; and qtrs=&quot;2&quot;&#39;).distinct().count() # 30215</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-Q&quot; and qtrs=&quot;3&quot;&#39;).distinct().count() # 28150</span>
<span class="c1"># cf_pivot_value.select(&#39;adsh&#39;,&#39;form&#39;, &#39;qtrs&#39;).where(&#39;form == &quot;10-Q&quot; and qtrs=&quot;4&quot;&#39;).distinct().count() # 185</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">piv_by_qtrs_pd</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">,</span><span class="s1">&#39;qtrs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s1">&#39;qtrs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>


<span class="c1">#pd_frame = df_all_selected.where(&quot;adsh == &#39;0001564590-20-043606&#39; and stmt == &#39;IS&#39; and qtrs==&#39;1&#39;&quot;).toPandas()</span>
<span class="c1">#pd_frame = df_all_selected.where(&quot;adsh == &#39;0001628279-20-000210&#39;&quot;).toPandas()</span>
<span class="c1">#pd_frame = df_all_selected.where(&quot;adsh == &#39;0001193125-20-213555&#39;&quot;).toPandas()</span>
<span class="c1">#print(pd_frame.sort_values([&#39;report&#39;, &#39;line&#39;]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">piv_by_qtrs_pd</span><span class="p">[[</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span><span class="s1">&#39;form&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adsh</th>
      <th>fp</th>
      <th>form</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0001193125-14-434590</td>
      <td>Q2</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0001283699-17-000032</td>
      <td>Q2</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000946673-19-000012</td>
      <td>Q1</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0001558370-19-008195</td>
      <td>Q2</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0001654954-19-002486</td>
      <td>FY</td>
      <td>10-K</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>116477</th>
      <td>0001564590-17-007757</td>
      <td>Q1</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>116478</th>
      <td>0001437749-12-004522</td>
      <td>Q1</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>116479</th>
      <td>0000078890-17-000026</td>
      <td>Q1</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>116480</th>
      <td>0001193125-14-284514</td>
      <td>Q2</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>116481</th>
      <td>0001193125-13-169761</td>
      <td>Q1</td>
      <td>10-Q</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>116482 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 0001392972-17-000128  Q3 / qtrs 0,1,3 -&gt; 3 voll</span>
<span class="n">pd_frame</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001193125-13-315367&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39; 0001392972-17-000128&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">pd_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd_frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;qtrs&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>form</th>
      <th>period</th>
      <th>filed</th>
      <th>fp</th>
      <th>qtrs</th>
      <th>AmortizationOfFinancingCostsAndDiscounts</th>
      <th>CashAndCashEquivalentsAtCarryingValue</th>
      <th>...</th>
      <th>PaymentsToAcquireIntangibleAssets</th>
      <th>PaymentsToAcquirePropertyPlantAndEquipment</th>
      <th>PaymentsToAcquireShortTermInvestments</th>
      <th>ProceedsFromConvertibleDebt</th>
      <th>ProceedsFromMaturitiesPrepaymentsAndCallsOfAvailableForSaleSecurities</th>
      <th>ProceedsFromStockOptionsExercised</th>
      <th>ProceedsFromStockPlans</th>
      <th>ProvisionForDoubtfulAccounts</th>
      <th>RepaymentsOfNotesPayable</th>
      <th>ShareBasedCompensation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1392972</td>
      <td>PRO</td>
      <td>0001392972-17-000128</td>
      <td>10-Q</td>
      <td>2017-09-30</td>
      <td>2017-10-26</td>
      <td>Q3</td>
      <td>0</td>
      <td>NaN</td>
      <td>157359000.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1392972</td>
      <td>PRO</td>
      <td>0001392972-17-000128</td>
      <td>10-Q</td>
      <td>2017-09-30</td>
      <td>2017-10-26</td>
      <td>Q3</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1392972</td>
      <td>PRO</td>
      <td>0001392972-17-000128</td>
      <td>10-Q</td>
      <td>2017-09-30</td>
      <td>2017-10-26</td>
      <td>Q3</td>
      <td>3</td>
      <td>6363000.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>75000.0</td>
      <td>1235000.0</td>
      <td>0.0</td>
      <td>93500000.0</td>
      <td>15992000.0</td>
      <td>6347000.0</td>
      <td>1535000.0</td>
      <td>0.0</td>
      <td>155000.0</td>
      <td>17665000.0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 34 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001193125-13-315367&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">pd_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd_frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;qtrs&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>form</th>
      <th>period</th>
      <th>filed</th>
      <th>fp</th>
      <th>qtrs</th>
      <th>CashAndCashEquivalentsAtCarryingValue</th>
      <th>CashAndCashEquivalentsPeriodIncreaseDecrease</th>
      <th>...</th>
      <th>PaymentsForRepurchaseOfCommonStock</th>
      <th>PaymentsToAcquireOtherInvestments</th>
      <th>PaymentsToAcquirePropertyPlantAndEquipment</th>
      <th>PaymentsToAcquireTradingSecuritiesHeldforinvestment</th>
      <th>ProceedsFromSaleAndMaturityOfAvailableForSaleSecurities</th>
      <th>ProceedsFromSaleAndMaturityOfOtherInvestments</th>
      <th>ProceedsFromSaleAndMaturityOfTradingSecuritiesHeldforinvestment</th>
      <th>ProceedsFromStockOptionsExercised</th>
      <th>ShareBasedCompensation</th>
      <th>UnrealizedGainLossOnInvestments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1163348</td>
      <td>AWH</td>
      <td>0001193125-13-315367</td>
      <td>10-Q</td>
      <td>2013-06-30</td>
      <td>2013-08-02</td>
      <td>Q2</td>
      <td>0</td>
      <td>674103000.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1163348</td>
      <td>AWH</td>
      <td>0001193125-13-315367</td>
      <td>10-Q</td>
      <td>2013-06-30</td>
      <td>2013-08-02</td>
      <td>Q2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1163348</td>
      <td>AWH</td>
      <td>0001193125-13-315367</td>
      <td>10-Q</td>
      <td>2013-06-30</td>
      <td>2013-08-02</td>
      <td>Q2</td>
      <td>2</td>
      <td>NaN</td>
      <td>-7776000.0</td>
      <td>...</td>
      <td>82571000.0</td>
      <td>141805000.0</td>
      <td>3363000.0</td>
      <td>3.186162e+09</td>
      <td>0.0</td>
      <td>126491000.0</td>
      <td>3.171977e+09</td>
      <td>5293000.0</td>
      <td>6566000.0</td>
      <td>-95698000.0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 35 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0000946673-19-000012&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">pd_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd_frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;qtrs&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>form</th>
      <th>period</th>
      <th>filed</th>
      <th>fp</th>
      <th>qtrs</th>
      <th>CashAndCashEquivalentsAtCarryingValue</th>
      <th>CashAndCashEquivalentsPeriodIncreaseDecrease</th>
      <th>...</th>
      <th>ProceedsFromMaturitiesPrepaymentsAndCallsOfHeldToMaturitySecurities</th>
      <th>ProceedsFromSaleOfAvailableForSaleSecurities</th>
      <th>ProceedsFromSaleOfFederalHomeLoanBankStock</th>
      <th>ProceedsFromSaleOfLoansHeldForInvestment</th>
      <th>ProceedsFromSaleOfLoansHeldForSale</th>
      <th>ProceedsFromSaleOfPropertyPlantAndEquipment</th>
      <th>ProvisionForLoanAndLeaseLosses</th>
      <th>ProvisionForLoanLeaseAndOtherLosses</th>
      <th>ShareBasedCompensation</th>
      <th>TransferToOtherRealEstate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>946673</td>
      <td>BANR</td>
      <td>0000946673-19-000012</td>
      <td>10-Q</td>
      <td>2019-03-31</td>
      <td>2019-05-03</td>
      <td>Q1</td>
      <td>0</td>
      <td>261538000.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>946673</td>
      <td>BANR</td>
      <td>0000946673-19-000012</td>
      <td>10-Q</td>
      <td>2019-03-31</td>
      <td>2019-05-03</td>
      <td>Q1</td>
      <td>1</td>
      <td>NaN</td>
      <td>-10658000.0</td>
      <td>...</td>
      <td>14744000.0</td>
      <td>516000.0</td>
      <td>52372000.0</td>
      <td>3186000.0</td>
      <td>261978000.0</td>
      <td>876000.0</td>
      <td>2000000.0</td>
      <td>0.0</td>
      <td>1219000.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 53 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001654954-19-002486&#39; and stmt = &#39;CF&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;line&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>+----+-------+------+--------------------+----------+----+----------+------------------------------------------------------+----------+------+----+---+---+----+-----------+
|stmt|cik    |ticker|adsh                |period    |form|filed     |tag                                                   |value     |report|line|fp |uom|qtrs|period_year|
+----+-------+------+--------------------+----------+----+----------+------------------------------------------------------+----------+------+----+---+---+----+-----------+
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|NetIncomeLoss                                         |-9100000.0|7     |2   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|ShareBasedCompensation                                |680000.0  |7     |4   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|AmortizationOfIntangibleAssets                        |0.0       |7     |5   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|AccretionAmortizationOfDiscountsAndPremiumsInvestments|-176000.0 |7     |6   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|Depreciation                                          |638000.0  |7     |7   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|DeferredIncomeTaxExpenseBenefit                       |0.0       |7     |8   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|GainLossOnDispositionOfAssets                         |0.0       |7     |9   |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInAccountsReceivable                  |341000.0  |7     |11  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInPrepaidDeferredExpenseAndOtherAssets|210000.0  |7     |12  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInOtherOperatingAssets                |-159000.0 |7     |13  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInAccountsPayable                     |-136000.0 |7     |14  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInEmployeeRelatedLiabilities          |257000.0  |7     |16  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInOtherAccruedLiabilities             |-358000.0 |7     |17  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInOtherNoncurrentLiabilities          |-85000.0  |7     |18  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncreaseDecreaseInDeferredRevenue                     |-884000.0 |7     |19  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|NetCashProvidedByUsedInOperatingActivities            |796000.0  |7     |20  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|PaymentsToAcquirePropertyPlantAndEquipment            |208000.0  |7     |22  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|PaymentsToAcquireInvestments                          |3.0049E7  |7     |23  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|ProceedsFromSaleAndMaturityOfMarketableSecurities     |3.6604E7  |7     |24  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|NetCashProvidedByUsedInInvestingActivities            |6347000.0 |7     |25  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|ProceedsFromStockOptionsExercised                     |185000.0  |7     |28  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|ProceedsFromStockPlans                                |72000.0   |7     |29  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|PaymentsForRepurchaseOfCommonStock                    |0.0       |7     |30  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|NetCashProvidedByUsedInFinancingActivities            |257000.0  |7     |31  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|CashAndCashEquivalentsPeriodIncreaseDecrease          |7400000.0 |7     |32  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|EffectOfExchangeRateOnCashAndCashEquivalents          |-268000.0 |7     |33  |FY |USD|4   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|CashAndCashEquivalentsAtCarryingValue                 |2.5182E7  |7     |34  |FY |USD|0   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|CashAndCashEquivalentsAtCarryingValue                 |2.5182E7  |7     |35  |FY |USD|0   |2018       |
|CF  |1104855|SPRT  |0001654954-19-002486|2018-12-31|10-K|2019-03-08|IncomeTaxesPaid                                       |72000.0   |7     |37  |FY |USD|4   |2018       |
+----+-------+------+--------------------+----------+----+----------+------------------------------------------------------+----------+------+----+---+---+----+-----------+

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

