---

title: Final preparations

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 09_Final_Preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">yahoo_historical</span> <span class="kn">import</span> <span class="n">Fetcher</span>
<span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_data_local_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/&quot;</span>
<span class="n">stock_data_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/stocks/sec/&quot;</span>
<span class="n">training_set_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/mt/&quot;</span>

<span class="n">join_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_sec_features</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;07_all_features_complete_corrected.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">read_additional_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;08_add_ticker_info.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span>  <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># create a list with all stockdata files</span>
<span class="k">def</span> <span class="nf">get_stock_data_files</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">stock_data_folder</span> <span class="o">+</span> <span class="s2">&quot;**/*_processed.csv&quot;</span><span class="p">,</span><span class="n">recursive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_ticker_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">filename</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stock_data_folder</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_additional-company-information">01_additional company information<a class="anchor-link" href="#01_additional-company-information"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sector-and-Industries">Sector and Industries<a class="anchor-link" href="#Sector-and-Industries"> </a></h3><p>Important features are the industry and the sector a company works in and in order to use these during training, wie have to one-hot-encode them.
There are about 12 different sectors and about 142 different industries in the data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span> <span class="o">=</span> <span class="n">read_additional_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;length of dataset:           &quot;</span><span class="p">,</span> <span class="n">add_info</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of unique sectors:    &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">sector</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of unique industries: &quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>length of dataset:            2065
number of unique sectors:     12
number of unique industries:  142
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;sector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">sector</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">add_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">add_info</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">sector</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;sec_&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>it doesn't make sense to hot encode all 140 industries, we will only use industries which appear more than 20 times in the data (at least in one percent of the data). Othe industries will be set to "other"</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;—&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_industries</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">df_relevant_industries</span> <span class="o">=</span> <span class="n">df_industries</span><span class="p">[</span><span class="n">df_industries</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># create a list with industries that appear at least 20 times in the data</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df_relevant_industries</span><span class="p">),</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Other&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">add_info</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;ind_&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2065, 47)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Market-Capitalization">Market Capitalization<a class="anchor-link" href="#Market-Capitalization"> </a></h3><p>We will use the Market Capitalization to rank the companies and then create features like top 10, top 100, top 200, ...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;marketCap_rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">marketCap</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top100&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top200&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top500&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">add_info</span><span class="p">[</span><span class="s1">&#39;mc_top1000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>   <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;mc_top10&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>   <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;mc_top20&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>   <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;mc_top30&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>   <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;mc_top50&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>  <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;mc_top100&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>  <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;mc_top200&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span>  <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;mc_top500&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;mc_top1000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">add_info</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2065, 56)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Drop-unnecessary-columns-and-save">Drop unnecessary columns and save<a class="anchor-link" href="#Drop-unnecessary-columns-and-save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;marketCap_rank&#39;</span><span class="p">,</span> <span class="s1">&#39;sector&#39;</span><span class="p">,</span> <span class="s1">&#39;industry&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">add_info</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s1">&#39;09_add_ticker_info_features.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Company-Reports">02_Company Reports<a class="anchor-link" href="#02_Company-Reports"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sec</span> <span class="o">=</span> <span class="n">load_sec_features</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-Ticker-and-CIK-in-07_all_features_complete_corrected.csv">Check Ticker and CIK in 07_all_features_complete_corrected.csv<a class="anchor-link" href="#Check-Ticker-and-CIK-in-07_all_features_complete_corrected.csv"> </a></h3><p>it could be that the same Ticker-Symbol is used for several CIKs. This could happen, if a company is delisted or if companies are part of a holding. However, we have to ensure that the mapping between the ticker and cik we are using is unambiguous.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_ciktik</span> <span class="o">=</span> <span class="n">df_sec</span><span class="p">[[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;ticker&#39;</span><span class="p">]]</span>
<span class="n">df_ciktik_unique</span> <span class="o">=</span> <span class="n">df_ciktik</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_cik_to_tickers</span> <span class="o">=</span> <span class="n">df_ciktik_unique</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="c1"># this shows how often a ticker is is used for how many ciks</span>
<span class="c1"># what we would want to see is one row starting with &quot;1&quot;.  </span>
<span class="c1"># If there multiple rows, wie now that there are tickers which seem to be used for different ciks.</span>
<span class="n">df_cik_to_tickers</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1    3050
Name: ticker, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">used_mulitple_times</span> <span class="o">=</span> <span class="n">df_cik_to_tickers</span><span class="p">[</span><span class="n">df_cik_to_tickers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">used_mulitple_times</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_ciktik_unique</span><span class="p">[</span><span class="n">df_ciktik_unique</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">used_mulitple_times</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="add-one-hot_encoding-for-financial-period">add one hot_encoding for financial period<a class="anchor-link" href="#add-one-hot_encoding-for-financial-period"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sec</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_sec</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;fp_&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sec</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(94599, 58)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sec</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s1">&#39;09_company_reports.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="05_Check-completeness-of-data">05_Check completeness of data<a class="anchor-link" href="#05_Check-completeness-of-data"> </a></h2><p>there are now 3 datasets with features</p>
<ul>
<li>07_all_feature_complete.csv contains comparable data from the business reports</li>
<li>[ticker]_processed.csv contain the historical stockdata</li>
<li>09_add_ticker_info_features.csv contains additional information for a company</li>
</ul>
<p>for the training, we can only use the data of companies that are present in all 3 datasets</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sd_files</span> <span class="o">=</span> <span class="n">get_stock_data_files</span><span class="p">()</span>
<span class="n">ticker_sd_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_ticker_from_filename</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sd_files</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_ticker_add_info</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">set_ticker_df_sec</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_sec</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">set_ticker_sd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ticker_sd_files</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set_ticker_add_info</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set_ticker_df_sec</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set_ticker_sd</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2065
3050
2294
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define which tickers are present in all 3 datasets</span>
<span class="n">intersected</span> <span class="o">=</span> <span class="n">set_ticker_add_info</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set_ticker_df_sec</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set_ticker_sd</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">intersected</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2053</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save/copy-data-of-companies-present-in-all-3-datasets-to-a-special-folder">save/copy data of companies present in all 3 datasets to a special folder<a class="anchor-link" href="#save/copy-data-of-companies-present-in-all-3-datasets-to-a-special-folder"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info_cleaned</span> <span class="o">=</span> <span class="n">add_info</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">intersected</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
<span class="n">add_info_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;company_info.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sec_cleaned</span> <span class="o">=</span> <span class="n">df_sec</span><span class="p">[</span><span class="n">df_sec</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">intersected</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
<span class="n">df_sec_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;company_reports.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">:</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;stocks/&quot;</span> <span class="o">+</span> <span class="n">char</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sd_files</span><span class="p">:</span>
    <span class="n">ticker</span> <span class="o">=</span> <span class="n">get_ticker_from_filename</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="n">intersected</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;stocks/&quot;</span> <span class="o">+</span> <span class="n">ticker</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">ticker</span> <span class="o">+</span><span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="06_Combine-Stockdata-into-a-single-dataset">06_Combine Stockdata into a single dataset<a class="anchor-link" href="#06_Combine-Stockdata-into-a-single-dataset"> </a></h2><p>In order to be able to normalize the stockdata, we need to have them all in a single dataset. <br>
Sice we don't know how we will use them, we store the data with spark as a parquet dataset and a pure csv dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># init Spark</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark_session</span><span class="p">()</span> <span class="c1"># Session anlegen</span>
<span class="n">spark</span> <span class="c1"># display the moste important information of the session</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <p><b>SparkSession - in-memory</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="http://192.168.0.163:4040">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v2.4.5</code></dd>
              <dt>Master</dt>
                <dd><code>local[*]</code></dd>
              <dt>AppName</dt>
                <dd><code>default</code></dd>
            </dl>
        </div>
        
            </div>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;stocks/*/*&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dateFormat</span><span class="o">=</span><span class="s2">&quot;yyyy-MM-dd&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>
<span class="n">df_all_partioned</span> <span class="o">=</span> <span class="n">df_all</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;ticker&quot;</span><span class="p">))</span>
<span class="n">df_all_partioned</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;/all_stock_data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_df</span> <span class="o">=</span> <span class="n">df_all</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">training_set_folder</span> <span class="o">+</span> <span class="s2">&quot;all_stock_data.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XX_Trials">XX_Trials<a class="anchor-link" href="#XX_Trials"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">sector</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>12
142
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="o">.</span><span class="n">sector</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>FinancialServices        375
Industrials              324
Technology               293
Healthcare               264
ConsumerCyclical         235
RealEstate               131
Energy                   115
ConsumerDefensive        102
BasicMaterials            85
CommunicationServices     81
Utilities                 54
IndustrialGoods            1
Name: sector, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">industries</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">industries</span><span class="p">[</span><span class="n">industries</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Other&#39;,
 &#39;BanksRegional&#39;,
 &#39;Biotechnology&#39;,
 &#39;SoftwareApplication&#39;,
 &#39;SpecialtyIndustrialMachinery&#39;,
 &#39;OilGasEP&#39;,
 &#39;Semiconductors&#39;,
 &#39;MedicalDevices&#39;,
 &#39;InformationTechnologyServices&#39;,
 &#39;PackagedFoods&#39;,
 &#39;InsurancePropertyCasualty&#39;,
 &#39;SpecialtyChemicals&#39;,
 &#39;SoftwareInfrastructure&#39;,
 &#39;MedicalInstrumentsSupplies&#39;,
 &#39;AutoParts&#39;,
 &#39;CommunicationEquipment&#39;,
 &#39;SpecialtyRetail&#39;,
 &#39;AssetManagement&#39;,
 &#39;DiagnosticsResearch&#39;,
 &#39;ElectronicComponents&#39;,
 &#39;AerospaceDefense&#39;,
 &#39;Restaurants&#39;,
 &#39;OilGasEquipmentServices&#39;,
 &#39;ScientificTechnicalInstruments&#39;,
 &#39;CreditServices&#39;,
 &#39;OilGasMidstream&#39;,
 &#39;SpecialtyBusinessServices&#39;,
 &#39;ApparelRetail&#39;,
 &#39;SemiconductorEquipmentMaterials&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_info</span><span class="p">[</span><span class="n">add_info</span><span class="o">.</span><span class="n">marketCap_rank</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;marketCap_rank&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ticker</th>
      <th>sector</th>
      <th>industry</th>
      <th>marketCap</th>
      <th>sharesOutstanding</th>
      <th>message</th>
      <th>sec__BasicMaterials</th>
      <th>sec__CommunicationServices</th>
      <th>sec__ConsumerCyclical</th>
      <th>sec__ConsumerDefensive</th>
      <th>...</th>
      <th>ind__SpecialtyRetail</th>
      <th>marketCap_rank</th>
      <th>mc_top10</th>
      <th>mc_top20</th>
      <th>mc_top30</th>
      <th>mc_top50</th>
      <th>mc_top100</th>
      <th>mc_top200</th>
      <th>mc_top500</th>
      <th>mc_top1000</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>AAPL</td>
      <td>Technology</td>
      <td>Other</td>
      <td>2.081190e+12</td>
      <td>1.710250e+10</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>MSFT</td>
      <td>Technology</td>
      <td>SoftwareInfrastructure</td>
      <td>1.612352e+12</td>
      <td>7.560500e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>914</th>
      <td>AMZN</td>
      <td>ConsumerCyclical</td>
      <td>Other</td>
      <td>1.563667e+12</td>
      <td>5.008900e+08</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>203</th>
      <td>FB</td>
      <td>CommunicationServices</td>
      <td>Other</td>
      <td>7.791497e+11</td>
      <td>2.403970e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>834</th>
      <td>TSLA</td>
      <td>ConsumerCyclical</td>
      <td>Other</td>
      <td>5.782101e+11</td>
      <td>9.479010e+08</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>61</th>
      <td>V</td>
      <td>FinancialServices</td>
      <td>CreditServices</td>
      <td>4.546376e+11</td>
      <td>1.695680e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1699</th>
      <td>WMT</td>
      <td>ConsumerDefensive</td>
      <td>Other</td>
      <td>4.159056e+11</td>
      <td>2.829290e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1480</th>
      <td>JNJ</td>
      <td>Healthcare</td>
      <td>Other</td>
      <td>4.026470e+11</td>
      <td>2.632540e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>740</th>
      <td>JPM</td>
      <td>FinancialServices</td>
      <td>Other</td>
      <td>3.644428e+11</td>
      <td>3.048200e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1132</th>
      <td>PG</td>
      <td>ConsumerDefensive</td>
      <td>Other</td>
      <td>3.384916e+11</td>
      <td>2.479610e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>983</th>
      <td>MA</td>
      <td>FinancialServices</td>
      <td>CreditServices</td>
      <td>3.264132e+11</td>
      <td>9.884700e+08</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>476</th>
      <td>NVDA</td>
      <td>Technology</td>
      <td>Semiconductors</td>
      <td>3.222081e+11</td>
      <td>6.190000e+08</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1183</th>
      <td>UNH</td>
      <td>Healthcare</td>
      <td>Other</td>
      <td>3.198191e+11</td>
      <td>9.488210e+08</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1344</th>
      <td>DIS</td>
      <td>CommunicationServices</td>
      <td>Other</td>
      <td>3.181375e+11</td>
      <td>1.807060e+09</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 56 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">industries</span> <span class="o">=</span> <span class="n">add_info</span><span class="o">.</span><span class="n">industry</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reit_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;REIT&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">,</span> <span class="n">industries</span><span class="p">))</span>
<span class="n">real_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;RealEstate&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">,</span> <span class="n">industries</span><span class="p">))</span>
<span class="n">gasoil_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;Gas&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">,</span> <span class="n">industries</span><span class="p">))</span>
<span class="n">health_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;Health&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">,</span> <span class="n">industries</span><span class="p">))</span>
<span class="n">insurance_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;Insurance&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">,</span> <span class="n">industries</span><span class="p">))</span>
<span class="n">rest</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">industries</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">reit_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">gasoil_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">real_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">health_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">insurance_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reit_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gasoil_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">real_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">health_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">insurance_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rest</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>9
7
3
3
6
115
{&#39;CapitalMarkets&#39;, &#39;ApparelManufacturing&#39;, &#39;FoodDistribution&#39;, &#39;Airlines&#39;, &#39;AutoTruckDealerships&#39;, &#39;DiversifiedMachinery&#39;, &#39;BuildingProductsEquipment&#39;, &#39;Semiconductors&#39;, &#39;LumberWoodProduction&#39;, &#39;Entertainment&#39;, &#39;ResidentialConstruction&#39;, &#39;Lodging&#39;, &#39;Tobacco&#39;, &#39;DrugManufacturersSpecialtyGeneric&#39;, &#39;RecreationalVehicles&#39;, &#39;MortgageFinance&#39;, &#39;InformationTechnologyServices&#39;, &#39;AgriculturalInputs&#39;, &#39;Steel&#39;, &#39;MedicalCareFacilities&#39;, &#39;ElectronicComponents&#39;, &#39;Gold&#39;, &#39;SoftwareApplication&#39;, &#39;UtilitiesRegulatedWater&#39;, &#39;Leisure&#39;, &#39;MarineShipping&#39;, &#39;TravelServices&#39;, &#39;SpecialtyRetail&#39;, &#39;FarmHeavyConstructionMachinery&#39;, &#39;AutoParts&#39;, &#39;ApparelRetail&#39;, &#39;FinancialConglomerates&#39;, &#39;SpecialtyIndustrialMachinery&#39;, &#39;Railroads&#39;, &#39;BeveragesBrewers&#39;, &#39;AirportsAirServices&#39;, &#39;Confectioners&#39;, &#39;TelecomServices&#39;, &#39;Chemicals&#39;, &#39;AssetManagement&#39;, &#39;InternetContentInformation&#39;, &#39;Broadcasting&#39;, &#39;HomeImprovementRetail&#39;, &#39;WasteManagement&#39;, &#39;PaperPaperProducts&#39;, &#39;ShellCompanies&#39;, &#39;LuxuryGoods&#39;, &#39;UtilitiesIndependentPowerProducers&#39;, &#39;CreditServices&#39;, &#39;OtherIndustrialMetalsMining&#39;, &#39;ConsumerElectronics&#39;, &#39;Conglomerates&#39;, &#39;PackagedFoods&#39;, &#39;Restaurants&#39;, &#39;SpecialtyBusinessServices&#39;, &#39;ComputerHardware&#39;, &#39;ElectronicsComputerDistribution&#39;, &#39;AdvertisingAgencies&#39;, &#39;ToolsAccessories&#39;, &#39;ScientificTechnicalInstruments&#39;, &#39;FootwearAccessories&#39;, &#39;ThermalCoal&#39;, &#39;DiagnosticsResearch&#39;, &#39;PharmaceuticalRetailers&#39;, &#39;PackagingContainers&#39;, &#39;SecurityProtectionServices&#39;, &#39;Publishing&#39;, &#39;Trucking&#39;, &#39;DrugManufacturersGeneral&#39;, &#39;ElectricalEquipmentParts&#39;, &#39;Furnishings,FixturesAppliances&#39;, &#39;InternetRetail&#39;, &#39;CommunicationEquipment&#39;, &#39;GroceryStores&#39;, &#39;TextileManufacturing&#39;, &#39;RentalLeasingServices&#39;, &#39;BusinessEquipmentSupplies&#39;, &#39;AutoManufacturers&#39;, &#39;PersonalServices&#39;, &#39;HouseholdPersonalProducts&#39;, &#39;BeveragesWineriesDistilleries&#39;, &#39;Biotechnology&#39;, &#39;StaffingEmploymentServices&#39;, &#39;SemiconductorEquipmentMaterials&#39;, &#39;Solar&#39;, &#39;MetalFabrication&#39;, &#39;CokingCoal&#39;, &#39;ConsultingServices&#39;, &#39;ElectronicGamingMultimedia&#39;, &#39;UtilitiesDiversified&#39;, &#39;IntegratedFreightLogistics&#39;, &#39;UtilitiesRegulatedElectric&#39;, &#39;DiscountStores&#39;, &#39;BeveragesNon-Alcoholic&#39;, &#39;EducationTrainingServices&#39;, &#39;MedicalInstrumentsSupplies&#39;, &#39;Copper&#39;, &#39;DepartmentStores&#39;, &#39;PollutionTreatmentControls&#39;, &#39;BuildingMaterials&#39;, &#39;AerospaceDefense&#39;, &#39;Aluminum&#39;, &#39;BanksRegional&#39;, &#39;EngineeringConstruction&#39;, &#39;UtilitiesRenewable&#39;, &#39;Uranium&#39;, &#39;SoftwareInfrastructure&#39;, &#39;SpecialtyChemicals&#39;, &#39;MedicalDevices&#39;, &#39;MedicalDistribution&#39;, &#39;FarmProducts&#39;, &#39;FinancialDataStockExchanges&#39;, &#39;IndustrialDistribution&#39;, &#39;BanksDiversified&#39;, &#39;ResortsCasinos&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">adf</span> <span class="o">=</span> <span class="n">read_additional_info</span><span class="p">()</span>
<span class="n">adf</span><span class="p">[</span><span class="n">adf</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ticker</th>
      <th>sector</th>
      <th>industry</th>
      <th>marketCap</th>
      <th>sharesOutstanding</th>
      <th>message</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAL</td>
      <td>Industrials</td>
      <td>Airlines</td>
      <td>1.041370e+10</td>
      <td>6.107740e+08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AAOI</td>
      <td>Technology</td>
      <td>Semiconductors</td>
      <td>1.782953e+08</td>
      <td>2.297620e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AAPL</td>
      <td>Technology</td>
      <td>Consumer Electronics</td>
      <td>2.081190e+12</td>
      <td>1.710250e+10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAME</td>
      <td>Financial Services</td>
      <td>Insurance—Life</td>
      <td>4.634046e+07</td>
      <td>2.041430e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AAN</td>
      <td>Consumer Cyclical</td>
      <td>Specialty Retail</td>
      <td>5.985550e+08</td>
      <td>3.377850e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3037</th>
      <td>FDP</td>
      <td>Consumer Defensive</td>
      <td>Farm Products</td>
      <td>1.228697e+09</td>
      <td>4.736690e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3039</th>
      <td>SCOR</td>
      <td>Communication Services</td>
      <td>Advertising Agencies</td>
      <td>1.805105e+08</td>
      <td>7.278650e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3042</th>
      <td>MDRX</td>
      <td>Healthcare</td>
      <td>Health Information Services</td>
      <td>2.265462e+09</td>
      <td>1.579820e+08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3044</th>
      <td>GILD</td>
      <td>Healthcare</td>
      <td>Drug Manufacturers—General</td>
      <td>7.616448e+10</td>
      <td>1.253530e+09</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>CACI</td>
      <td>Technology</td>
      <td>Information Technology Services</td>
      <td>6.125142e+09</td>
      <td>2.521880e+07</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2060 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

