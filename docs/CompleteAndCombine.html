---

title: Complete and Combine

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_CompleteAndCombine.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_pivot_selected_folder</span>  <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_select&quot;</span>
<span class="n">all_pivoted_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_split&quot;</span>
<span class="n">all_processed_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_processed/&quot;</span>

<span class="n">pivot_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">]</span>
<span class="n">analyze_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;value_count&quot;</span><span class="p">,</span><span class="s2">&quot;null_count&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Tools">02_Tools<a class="anchor-link" href="#02_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">count_null</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">(</span><span class="n">pivot_group</span><span class="p">)</span>
    <span class="n">value_cols</span> <span class="o">=</span> <span class="n">value_cols</span> <span class="o">-</span>  <span class="nb">set</span><span class="p">(</span><span class="n">analyze_fields</span><span class="p">)</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;null_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">value_cols</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;lines with missing values: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">stmt</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="n">stmt</span> <span class="o">+</span> <span class="s2">&quot;_not_cleaned.csv&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">filed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filed</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_number_of_reports</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    check if there is only one entry per report (unique adsh)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is there just one report per ADSH: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">missing_value_report</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="n">df_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;null_count&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_missing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Complete-BS">01_Complete BS<a class="anchor-link" href="#01_Complete-BS"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  1301
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116519, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-Equity">complete missing Equity<a class="anchor-link" href="#complete-missing-Equity"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># complete Equity_hj = Assets - Liabilities</span>
<span class="n">do_set_equity</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">Equity_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;Equity_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_equity</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  559
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-liabilities">complete missing liabilities<a class="anchor-link" href="#complete-missing-liabilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do_set_liab</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Equity_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">LiabilitiesNoncurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Equity_hj&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  282
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-missing-assets">complete missing assets<a class="anchor-link" href="#complete-missing-assets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do_set_liab</span> <span class="o">=</span> <span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">Liabilities</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Equity_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">AssetsCurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">AssetsNoncurrent</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Equity_hj&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">]</span>
<span class="n">bs_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_liab</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  274
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="remove-companies-with-incomplete-balancesheets">remove companies with incomplete balancesheets<a class="anchor-link" href="#remove-companies-with-incomplete-balancesheets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">bs_df</span><span class="p">[</span><span class="n">bs_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>82
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cleaned</span> <span class="o">=</span> <span class="n">bs_df</span><span class="p">[</span><span class="o">~</span><span class="n">bs_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(114481, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">analyze_fields</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;bs_clean.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Complete-CF">02_Complete CF<a class="anchor-link" href="#02_Complete-CF"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;cf&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  1359
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116187, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-CashIncreaseDecrease">complete CashIncreaseDecrease<a class="anchor-link" href="#complete-CashIncreaseDecrease"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition CashIncreaseDecrease = NetCashProvidedByUsedInOperatingActivities + NetCashProvidedByUsedInInvestingActivities + NetCashProvidedByUsedInFinancingActivities</span>
<span class="n">do_set_cshinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">CashIncreaseDecrease_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInOperatingActivities</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> 
                 <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInInvestingActivities</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInFinancingActivities</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">]</span> \
                                                    <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">]</span> \
                                                    <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cshinc</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">]</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  377
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-NetCashProvidedByUsedInOperatingActivities">complete NetCashProvidedByUsedInOperatingActivities<a class="anchor-link" href="#complete-NetCashProvidedByUsedInOperatingActivities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition CashIncreaseDecrease = NetCashProvidedByUsedInOperatingActivities + NetCashProvidedByUsedInInvestingActivities + NetCashProvidedByUsedInFinancingActivities</span>
<span class="c1"># hence NetCashProvidedByUsedInOperatingActivities = CashIncreaseDecrease - (NetCashProvidedByUsedInInvestingActivities + NetCashProvidedByUsedInFinancingActivities)</span>
<span class="n">do_set_netop</span> <span class="o">=</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">CashIncreaseDecrease_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInOperatingActivities</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> 
                 <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInInvestingActivities</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">NetCashProvidedByUsedInFinancingActivities</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;CashIncreaseDecrease_hj&#39;</span><span class="p">]</span> \
                                                                      <span class="o">-</span> <span class="p">(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="n">cf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_netop</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count_null</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  316
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="remove-companies-with-incomplete-cash-flow-statment">remove companies with incomplete cash flow statment<a class="anchor-link" href="#remove-companies-with-incomplete-cash-flow-statment"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">cf_df</span><span class="p">[</span><span class="n">cf_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>146
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cleaned</span> <span class="o">=</span> <span class="n">cf_df</span><span class="p">[</span><span class="o">~</span><span class="n">cf_df</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(112417, 18)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">analyze_fields</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;cf_clean.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="03_Complete-IS">03_Complete IS<a class="anchor-link" href="#03_Complete-IS"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="load-data">load data<a class="anchor-link" href="#load-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;is&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">is_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  115883
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(115899, 21)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_number_of_reports</span><span class="p">(</span><span class="n">is_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>is there just one report per ADSH:  True
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-GrossProfit">complete GrossProfit<a class="anchor-link" href="#complete-GrossProfit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue</span>
<span class="n">do_set_grossp</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">CostOfRevenue_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition: grossprofit - opexpenses = op-income -&gt; grossprofit = opincome + opexpenses</span>
<span class="n">do_set_grossp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">OperatingExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_grossp1</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-Revenues">complete Revenues<a class="anchor-link" href="#complete-Revenues"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue -&gt; Revenues = Grossprofit + CostOfRevenue</span>
<span class="n">do_set_rev</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">CostOfRevenue_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_rev</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span>
<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">is_df</span><span class="p">,</span><span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-CostOfRevenue">complete CostOfRevenue<a class="anchor-link" href="#complete-CostOfRevenue"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition Grossprofit = Revenues - CostOfRevenue -&gt; CostOfRevenue = Revenues - Grossprofit</span>
<span class="n">do_set_cstrev</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">CostOfRevenue_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_cstrev</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="set-GrossProfit-and-CostOfRevenue-to-0.0-if-Revenue-is-0.0">set GrossProfit and CostOfRevenue to 0.0 if Revenue is 0.0<a class="anchor-link" href="#set-GrossProfit-and-CostOfRevenue-to-0.0-if-Revenue-is-0.0"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># do_set_grossp_zero = (is_df.Revenues_hj==0.0) &amp; (is_df.GrossProfit.isnull())</span>
<span class="c1"># is_df.loc[do_set_grossp_zero, &#39;GrossProfit&#39;] = 0.0</span>

<span class="c1"># do_set_costofrev_zero = (is_df.Revenues_hj==0.0) &amp; (is_df.CostOfRevenue_hj.isnull())</span>
<span class="c1"># is_df.loc[do_set_grossp_zero, &#39;CostOfRevenue_hj&#39;] = 0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="complete-OperatingIncomeLoss">complete OperatingIncomeLoss<a class="anchor-link" href="#complete-OperatingIncomeLoss"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per definition: opIncomeLoss = grossprofit - opexpenses</span>
<span class="n">do_set_opinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">OperatingExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">is_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set_opinc</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Falls OpIncome vorhanden und CostsAndExpenses vorhanden und das dem Revenue entspricht, dann</span>
<span class="c1"># - entweder grossprofit auf opIncome setzen</span>
<span class="c1"># - oder oder schauen, wie sich die existierenden aufteilen , bzw. schauen wo im durchschnitt grosssprofit zwischen opincome und revenues liegt</span>
<span class="n">selection</span> <span class="o">=</span> <span class="p">((</span><span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()))</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
<span class="n">selected_cols</span> <span class="o">=</span> <span class="n">is_df</span><span class="p">[</span><span class="n">selection</span><span class="p">][[</span><span class="s1">&#39;Revenues_hj&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="p">((</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">GrossProfit</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">-</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5154839817248579</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">do_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;is&quot;</span><span class="p">)</span>
<span class="n">count_null</span><span class="p">(</span><span class="n">is_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lines with missing values:  115883
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>OperatingIncome</p>
<ul>
<li>können wir nur von oben nauch unten nachrechnen, da keine differenz zu netincome vorhanden ist</li>
<li>man könnte opertating income schätzen, falls REvenue und NetIncome vorhanden ist -&gt; gleich wie auch GrossProfit geschätzt werden kann</li>
</ul>
<p>Grossprofit if null</p>
<ul>
<li>falls CostAndExpenses + OperationgIncome ~= Revenue
dann könnte man grossprofit schätzen -&gt; Operating income + 0.5* CostAndExpenses</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XX_Trials">XX_Trials<a class="anchor-link" href="#XX_Trials"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[((</span><span class="n">is_df</span><span class="o">.</span><span class="n">CostsAndExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">Revenues_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">NetIncomeLoss_hj</span><span class="o">.</span><span class="n">notnull</span><span class="p">()))]</span> \
  <span class="p">[[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;Revenues_hj&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">,</span><span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">]]</span> <span class="c1">#721</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>adsh</th>
      <th>Revenues_hj</th>
      <th>GrossProfit</th>
      <th>OperatingIncomeLoss_hj</th>
      <th>NetIncomeLoss_hj</th>
      <th>OperatingExpenses</th>
      <th>CostsAndExpenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1465112</td>
      <td>0001047469-14-001182</td>
      <td>3.175400e+10</td>
      <td>NaN</td>
      <td>5.150000e+09</td>
      <td>2.859000e+09</td>
      <td>NaN</td>
      <td>2.660400e+10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>816761</td>
      <td>0000816761-15-000008</td>
      <td>2.732000e+09</td>
      <td>1.479000e+09</td>
      <td>5.030000e+08</td>
      <td>3.670000e+08</td>
      <td>NaN</td>
      <td>2.229000e+09</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1275229</td>
      <td>0001558370-18-002006</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>-7.129000e+06</td>
      <td>-8.045000e+06</td>
      <td>NaN</td>
      <td>7.129000e+06</td>
    </tr>
    <tr>
      <th>13</th>
      <td>764622</td>
      <td>0000764622-16-000087</td>
      <td>3.495443e+09</td>
      <td>NaN</td>
      <td>8.546020e+08</td>
      <td>4.372570e+08</td>
      <td>NaN</td>
      <td>2.640841e+09</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1179929</td>
      <td>0001179929-14-000017</td>
      <td>2.312039e+09</td>
      <td>NaN</td>
      <td>3.242700e+07</td>
      <td>7.811000e+06</td>
      <td>NaN</td>
      <td>2.279612e+09</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>115885</th>
      <td>1481506</td>
      <td>0001104659-12-075408</td>
      <td>6.612700e+07</td>
      <td>NaN</td>
      <td>1.986700e+07</td>
      <td>1.788900e+07</td>
      <td>NaN</td>
      <td>4.626000e+07</td>
    </tr>
    <tr>
      <th>115888</th>
      <td>1297996</td>
      <td>0001297996-17-000057</td>
      <td>5.505690e+08</td>
      <td>NaN</td>
      <td>1.372830e+08</td>
      <td>8.353800e+07</td>
      <td>NaN</td>
      <td>4.132860e+08</td>
    </tr>
    <tr>
      <th>115895</th>
      <td>1008586</td>
      <td>0001558370-19-008592</td>
      <td>4.793000e+06</td>
      <td>NaN</td>
      <td>-4.330000e+05</td>
      <td>-6.080000e+05</td>
      <td>NaN</td>
      <td>5.226000e+06</td>
    </tr>
    <tr>
      <th>115896</th>
      <td>44689</td>
      <td>0001437749-14-014713</td>
      <td>6.349990e+05</td>
      <td>NaN</td>
      <td>-1.285444e+06</td>
      <td>-5.388500e+04</td>
      <td>NaN</td>
      <td>1.740727e+06</td>
    </tr>
    <tr>
      <th>115897</th>
      <td>1125345</td>
      <td>0001125345-16-000070</td>
      <td>3.255000e+06</td>
      <td>NaN</td>
      <td>-3.426500e+07</td>
      <td>-3.384600e+07</td>
      <td>NaN</td>
      <td>3.752000e+07</td>
    </tr>
  </tbody>
</table>
<p>28206 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="p">[((</span><span class="n">is_df</span><span class="o">.</span><span class="n">CostsAndExpenses</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">GrossProfit</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">is_df</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">()))][[</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingExpenses&#39;</span><span class="p">,</span><span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span><span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">]]</span> <span class="c1">#721</span>
<span class="c1">#is_df[((is_df.OperatingExpenses.notnull() &amp; is_df.GrossProfit.isnull() &amp; is_df.OperatingIncomeLoss_hj.notnull()))][[&#39;cik&#39;,&#39;adsh&#39;,&#39;OperatingExpenses&#39;,&#39;GrossProfit&#39;,&#39;OperatingIncomeLoss_hj&#39;]] #11618</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>adsh</th>
      <th>CostsAndExpenses</th>
      <th>OperatingExpenses</th>
      <th>GrossProfit</th>
      <th>OperatingIncomeLoss_hj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>55</th>
      <td>1399541</td>
      <td>0001193125-12-462451</td>
      <td>2.429200e+06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>124</th>
      <td>1399542</td>
      <td>0001193125-13-135825</td>
      <td>7.784700e+06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>150</th>
      <td>820027</td>
      <td>0000820027-14-000020</td>
      <td>9.229000e+09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>156</th>
      <td>1283810</td>
      <td>0001193125-12-462787</td>
      <td>4.129000e+05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>184</th>
      <td>1393311</td>
      <td>0001393311-19-000041</td>
      <td>3.710000e+08</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>115241</th>
      <td>1357361</td>
      <td>0001193125-13-135714</td>
      <td>6.750500e+06</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115365</th>
      <td>1399542</td>
      <td>0001564590-15-007375</td>
      <td>7.840000e+05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115606</th>
      <td>1037540</td>
      <td>0001656423-20-000007</td>
      <td>1.914925e+09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115685</th>
      <td>1479094</td>
      <td>0001104659-12-035291</td>
      <td>1.543100e+07</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115827</th>
      <td>1524358</td>
      <td>0001524358-20-000011</td>
      <td>3.897000e+09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>850 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>cik                           0
ticker                        0
adsh                          0
period                        0
filed                         0
form                          0
qtrs                          0
fp                            1
Revenues_hj                   0
CostOfRevenue_hj          34159
GrossProfit               34159
OperatingExpenses         73773
OperatingIncomeLoss_hj     3352
CostsAndExpenses          87531
NetIncomeLoss_hj            621
NetIncomeLoss             15026
ProfitLoss                76441
SharesOutstanding_hj      40947
EarningsPerShare_hj        7099
value_count                   0
null_count                    0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0000049826-16-000259    1
0001193125-13-432993    1
0000023666-13-000019    1
0001437749-17-013867    1
0001104659-15-059052    1
                       ..
0001564590-16-014500    1
0000808326-17-000011    1
0001144204-14-064668    1
0001104659-15-075802    1
0001628280-19-012903    1
Name: adsh, Length: 115899, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">missing_value_report</span><span class="p">(</span><span class="n">cf_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>316
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">adsh</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="n">bs_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>cik                                                    int64
ticker                                                object
adsh                                                  object
period                                        datetime64[ns]
filed                                         datetime64[ns]
form                                                  object
qtrs                                                   int64
fp                                                    object
CashIncreaseDecrease_hj                              float64
NetIncomeLoss                                        float64
ProfitLoss                                           float64
NetCashProvidedByUsedInOperatingActivities           float64
NetCashProvidedByUsedInInvestingActivities           float64
NetCashProvidedByUsedInFinancingActivities           float64
PaymentsOfDividendsTotal_hj                          float64
PaymentsForRepurchaseOfStockTotal_hj                 float64
value_count                                            int64
null_count                                             int64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">bs_df</span><span class="o">.</span><span class="n">qtrs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1349</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>IS
Was kann man alles berechnen, wenn vorhanden
GrossProfit = Revenues - costofsales
OperatingIncome = (GrossProfit) - CostsAndExpenses
OperatingIncome = Revenues - CostsAndExpenses</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">cf_df</span><span class="p">[(</span><span class="n">cf_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>132
REG     20
LM      19
SKT      5
WLS      4
BMR      3
        ..
PAH      1
WGL      1
KODK     1
WM       1
AEE      1
Name: ticker, Length: 66, dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span><span class="o">==</span><span class="s1">&#39;REG&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>filed</th>
      <th>form</th>
      <th>qtrs</th>
      <th>fp</th>
      <th>CashIncreaseDecrease_hj</th>
      <th>NetIncomeLoss</th>
      <th>ProfitLoss</th>
      <th>NetCashProvidedByUsedInOperatingActivities</th>
      <th>NetCashProvidedByUsedInInvestingActivities</th>
      <th>NetCashProvidedByUsedInFinancingActivities</th>
      <th>PaymentsOfDividendsTotal_hj</th>
      <th>PaymentsForRepurchaseOfStockTotal_hj</th>
      <th>value_count</th>
      <th>null_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4076</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-13-000009</td>
      <td>2012-12-31</td>
      <td>2013-03-01</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>323125000.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9886</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-14-000008</td>
      <td>2014-03-31</td>
      <td>2014-05-08</td>
      <td>10-Q</td>
      <td>1</td>
      <td>Q1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>30704</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-14-000033</td>
      <td>2014-09-30</td>
      <td>2014-11-04</td>
      <td>10-Q</td>
      <td>3</td>
      <td>Q3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>42848</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-16-000073</td>
      <td>2016-06-30</td>
      <td>2016-08-05</td>
      <td>10-Q</td>
      <td>2</td>
      <td>Q2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>44157</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-13-000030</td>
      <td>2013-09-30</td>
      <td>2013-11-01</td>
      <td>10-Q</td>
      <td>3</td>
      <td>Q3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>45278</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-13-000026</td>
      <td>2013-06-30</td>
      <td>2013-08-02</td>
      <td>10-Q</td>
      <td>2</td>
      <td>Q2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>49340</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-18-000030</td>
      <td>2018-06-30</td>
      <td>2018-08-03</td>
      <td>10-Q</td>
      <td>2</td>
      <td>Q2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>50505</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-15-000006</td>
      <td>2014-12-31</td>
      <td>2015-02-20</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>52818</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-14-000029</td>
      <td>2014-06-30</td>
      <td>2014-08-08</td>
      <td>10-Q</td>
      <td>2</td>
      <td>Q2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>55494</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-16-000047</td>
      <td>2015-12-31</td>
      <td>2016-02-18</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>69126</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-18-000010</td>
      <td>2017-12-31</td>
      <td>2018-02-27</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>69750</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-15-000035</td>
      <td>2015-09-30</td>
      <td>2015-11-05</td>
      <td>10-Q</td>
      <td>3</td>
      <td>Q3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>74344</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-15-000030</td>
      <td>2015-06-30</td>
      <td>2015-08-06</td>
      <td>10-Q</td>
      <td>2</td>
      <td>Q2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>79577</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-19-000006</td>
      <td>2018-12-31</td>
      <td>2019-02-21</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>83669</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-13-000016</td>
      <td>2013-03-31</td>
      <td>2013-05-09</td>
      <td>10-Q</td>
      <td>1</td>
      <td>Q1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>86371</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-15-000020</td>
      <td>2015-03-31</td>
      <td>2015-05-07</td>
      <td>10-Q</td>
      <td>1</td>
      <td>Q1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>91110</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-16-000063</td>
      <td>2016-03-31</td>
      <td>2016-05-06</td>
      <td>10-Q</td>
      <td>1</td>
      <td>Q1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>91690</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-18-000034</td>
      <td>2018-09-30</td>
      <td>2018-11-05</td>
      <td>10-Q</td>
      <td>3</td>
      <td>Q3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>98040</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-19-000014</td>
      <td>2019-03-31</td>
      <td>2019-05-10</td>
      <td>10-Q</td>
      <td>1</td>
      <td>Q1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>102690</th>
      <td>910606</td>
      <td>REG</td>
      <td>0000910606-14-000004</td>
      <td>2013-12-31</td>
      <td>2014-02-19</td>
      <td>10-K</td>
      <td>4</td>
      <td>FY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_df_missing</span> <span class="o">=</span> <span class="n">cf_df</span><span class="p">[</span><span class="n">cdf_df</span><span class="o">.</span><span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bs_df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;null_count&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cf_df_missing</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-189-bd1bd0492fc3&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>cf_df_missing <span class="ansi-yellow-intense-fg ansi-bold">=</span> cf_df<span class="ansi-yellow-intense-fg ansi-bold">[</span>cdf_df<span class="ansi-yellow-intense-fg ansi-bold">.</span>null_count <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">      2</span> print<span class="ansi-yellow-intense-fg ansi-bold">(</span>bs_df_missing<span class="ansi-yellow-intense-fg ansi-bold">.</span>shape<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">      3</span> sns<span class="ansi-yellow-intense-fg ansi-bold">.</span>catplot<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;null_count&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> kind<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;count&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> data<span class="ansi-yellow-intense-fg ansi-bold">=</span>cf_df_missing<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;cdf_df&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>bs_df[bs_df.fp.isna()]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>BS
Checks:</p>
<ul>
<li>Assets = Liabilities + Equity</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CF</span>
<span class="n">Cash</span> <span class="n">Differenz</span> <span class="n">kann</span> <span class="n">auch</span> <span class="n">aufgrund</span> <span class="n">des</span> <span class="n">vergangenen</span> <span class="n">geschäftsbericht</span> <span class="n">ermittlet</span> <span class="n">werden</span> <span class="o">-&gt;</span> <span class="n">Position</span> <span class="n">Cash</span> <span class="n">im</span> <span class="n">BS</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

