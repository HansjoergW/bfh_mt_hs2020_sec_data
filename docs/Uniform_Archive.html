---

title: todos

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_Uniform_Archive.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="uniform-and-complete">uniform and complete<a class="anchor-link" href="#uniform-and-complete"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once the data is pivoted, we want to create a dataset that contains only columns which appear in every report.</p>
<p>For instance, we want to have all the columns 'Assets', 'AssetsCurrent', 'AssetsNoncurrent' to be present in every balancesheet. However, not all desired tags are present and we have to find ways to calculate and complete them. Often, only 2 of 'Assets', 'AssetsCurrent', 'AssetsNoncurrent' are present, however, since Assets = AssetsCurrent + AssetsNoncurrent we can calculate the third.</p>
<p>Sometimes different tags are used to express the same meaning, so we have to figure out which tags belong together.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.dataframe</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_pivot_selected_folder</span>  <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_select&quot;</span>
<span class="n">all_pivoted_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_split&quot;</span>
<span class="n">all_processed_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_processed/&quot;</span>

<span class="n">col_list</span> <span class="o">=</span>    <span class="p">[</span><span class="s2">&quot;stmt&quot;</span><span class="p">,</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;uom&quot;</span><span class="p">]</span>
<span class="n">pivot_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">]</span>
<span class="n">pivot_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">]</span>
<span class="n">statements</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;IS&#39;</span><span class="p">,</span><span class="s1">&#39;CF&#39;</span><span class="p">,</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span><span class="s1">&#39;BS&#39;</span><span class="p">,</span><span class="s1">&#39;CI&#39;</span><span class="p">,</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span><span class="s1">&#39;UN&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># init Spark</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark_session</span><span class="p">()</span> <span class="c1"># Session anlegen</span>
<span class="n">spark</span> <span class="c1"># display the moste important information of the session</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <p><b>SparkSession - in-memory</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="http://192.168.0.163:4040">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v2.4.5</code></dd>
              <dt>Master</dt>
                <dd><code>local[*]</code></dd>
              <dt>AppName</dt>
                <dd><code>default</code></dd>
            </dl>
        </div>
        
            </div>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Raw_data">00_Raw_data<a class="anchor-link" href="#00_Raw_data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># loading the complete unpivoted dataset - if it is needed for debbuging</span>
<span class="n">df_all_selected</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivot_selected_folder</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># it happens sometimes, that the data could not be associated with a right sheet (bs, is, cf, ..). in this cases, the data can appea under &quot;UN&quot;</span>
<span class="c1"># so if expected information cannot be found in the appropriate statement, we have to look in the un statement</span>
<span class="n">un_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;UN&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">un_pivot_pd</span> <span class="o">=</span> <span class="n">un_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">un_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5989, 1774)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">prepare_un_values</span><span class="p">(</span><span class="n">df_to_merge_into</span><span class="p">,</span> <span class="n">attr_list</span><span class="p">):</span>
    <span class="c1"># add possible columns from un set to  cf data with prefix cpy_</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="n">pivot_group</span><span class="p">[:]</span> <span class="c1"># create copy</span>
    <span class="n">attributes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">un_prepared</span> <span class="o">=</span> <span class="n">un_pivot_pd</span><span class="p">[</span><span class="n">attributes</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">un_prepared</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>  <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pivot_group</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;cpy_&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_to_merge_into</span><span class="p">,</span> <span class="n">un_prepared</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">pivot_group</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Balance_Sheet">01_Balance_Sheet<a class="anchor-link" href="#01_Balance_Sheet"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(117868, 2243)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd</span> <span class="o">=</span> <span class="n">bs_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span> <span class="o">=</span> <span class="n">bs_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Assets">Assets<a class="anchor-link" href="#Assets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   1801
AssetsNoncurrent   111944
AssetsCurrent   28053
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Somtimes AssetsNet is present instead of Assets, copy its content to Assets</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">)</span>

<span class="c1"># if one of the three provided columns is missing, calculate its content based on Assets = AssetsCurrent + AssetsNoncurrent</span>
<span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>

<span class="c1"># if Assets contains data but AssetsCurrent and AssetsNoncurrent are empty, assume that only AssetsCurrent is present</span>
<span class="c1"># copy value from Assets to AssetsCurrent and set AssetsNoncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>

<span class="c1"># if AssetsCurrent contains data and Assets  and AssetsNoncurrent are empty, assume that only AssetsCurrent is present</span>
<span class="c1"># copy value from AssetsCurrent to Assets and set AssetsNoncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for how many entries Assets, AssetsNoncurrent and AsstesCurrent couldn&#39;t be completed</span>
<span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   1675
AssetsNoncurrent   1675
AssetsCurrent   1675
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Liabilities">Liabilities<a class="anchor-link" href="#Liabilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   1983
LiabilitiesNoncurrent   1982
LiabilitiesCurrent   1983
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Completing the Liabilities columns follows the same logic as for the Assets columns</span>

<span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for how many entries we were not able to complete the Liabilities information</span>
<span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   1983
LiabilitiesNoncurrent   1982
LiabilitiesCurrent   1983
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Equity">Equity<a class="anchor-link" href="#Equity"> </a></h3><p>In the Equity section of the balance sheet, we are intereste in the StockholdersEquity and the Earnings (Tag. RetainedEarningsAccumulatedDeficit)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   11898
RetainedEarningsAccumulatedDeficit   10396
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per  definition, LiabilitisAndStockholdersEquity has to match Assets in a balance sheet</span>
<span class="c1"># so if LiabilitiesAndStockholdersEquity is not set, we copy the value from the Assets column</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesAndStockholdersEquity&#39;</span><span class="p">)</span> <span class="c1"># has to be the same</span>

<span class="c1"># if there is partner capital but no StockholdersEquite, we consider it the same as stockholder equity</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PartnersCapital&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> 

<span class="c1"># if there is StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest instead of StockholdersEquity, we use this as StocholdersEquity</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> 

<span class="c1"># if RetainedEarnings has no value, we set it to zero</span>
<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   2423
RetainedEarningsAccumulatedDeficit   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span>
                 <span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">]]</span> \
        <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;bs_not_cleaned.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-empty-companies">Clean empty companies<a class="anchor-link" href="#Clean-empty-companies"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_selected</span> <span class="o">=</span> <span class="n">bs_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span>
                                     <span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="n">bs_cols_selected</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="o">~</span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(124520, 13)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;bs.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_CashFlow">02_CashFlow<a class="anchor-link" href="#02_CashFlow"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Operation</p>
<ul>
<li>NetIncomeLoss</li>
<li>ProfitLoss</li>
<li>NetCashProvidedByUsedInOperatingActivities: NetIncome + other positions ergibt diese Position</li>
</ul>
<p>Investing</p>
<ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>
<p>Financing activities</p>
<ul>
<li>PaymentsForRepurchaseOfCommonStock: Aktienrückkäufe</li>
<li>PaymentsOfDividends</li>
<li>NetCashProvidedByUsedInFinancingActivities</li>
</ul>
<p>Cash Bestand unterschied</p>
<ul>
<li>CashAndCashEquivalentsPeriodIncreaseDecrease: increase/decrease in cash</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;CF&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">cf_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(305903, 2909)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#cf_empty_count = get_empty_count(cf_pivot_value)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">cf_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(305903, 2909)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cash-Increase/Decrease">Cash Increase/Decrease<a class="anchor-link" href="#Cash-Increase/Decrease"> </a></h3><ul>
<li>'CashAndCashEquivalentsPeriodIncreaseDecrease',</li>
<li>'CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect',</li>
<li>'CashPeriodIncreaseDecrease',</li>
<li>'CashPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'NetCashProvidedByUsedInContinuingOperations'</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashAndCashEquivalentsPeriodIncreaseDecrease   217223
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge relevant columns from the UN dataset</span>
<span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">prepare_un_values</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span>
<span class="p">])</span>
<span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(305903, 2912)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if CashAndCashEquivalentsPeriodIncreaseDecrease is not present and CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>
<span class="c1"># is present, we can replace CashAndCashEquivalentsPeriodIncreaseDecrease.</span>
<span class="c1"># there are only about 12 entries where both are present</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecrease&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>


<span class="c1"># try to find data in joined un data</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashAndCashEquivalentsPeriodIncreaseDecrease   188780
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Operation">Operation<a class="anchor-link" href="#Operation"> </a></h3><ul>
<li>NetIncomeLoss</li>
<li>NetCashProvidedByUsedInOperatingActivities: NetIncome + other positions ergibt diese Position</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   195814
ProfitLoss   240347
NetCashProvidedByUsedInOperatingActivities   218636
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if only ProfitLoss is set, copy content to NetIncomeLoss</span>
<span class="c1"># if onlyNetIncomeLoss is set, copy to ProfitLoss</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   119998
ProfitLoss   119998
NetCashProvidedByUsedInOperatingActivities   187825
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Investing">Investing<a class="anchor-link" href="#Investing"> </a></h3><ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   219410
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> 
                      <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Financing-activities">Financing activities<a class="anchor-link" href="#Financing-activities"> </a></h3><ul>
<li>PaymentsForRepurchaseOfCommonStock: Aktienrückkäufe</li>
<li>PaymentsOfDividends</li>
<li>NetCashProvidedByUsedInFinancingActivities</li>
</ul>
<p>('CashProvidedByUsedInDiscontinuedOperationsFinancingActivities',
 'CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations',
 'NetCashProvidedByUsedInFinancingActivities',
 'NetCashProvidedByUsedInFinancingActivitiesContinuingOperations')</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="NetCashProvidedByUsedInFinancingActivities">NetCashProvidedByUsedInFinancingActivities<a class="anchor-link" href="#NetCashProvidedByUsedInFinancingActivities"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   219518
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> 
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsOfDividends">PaymentsOfDividends<a class="anchor-link" href="#PaymentsOfDividends"> </a></h4><p>Simply set to 0.0 if no data is present
 'PaymentsOfDividends',
 'PaymentsOfDividendsCommonStock',
 'PaymentsOfDividendsMinorityInterest',
 'PaymentsOfDividendsPreferredStockAndPreferenceStock',
 'PaymentsOfOrdinaryDividends',</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsOfDividendsTotal&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsOfDividends&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsCommonStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsMinorityInterest&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfOrdinaryDividends&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsForRepurchaseOfCommonStock:-Stock-buybacks">PaymentsForRepurchaseOfCommonStock: Stock buybacks<a class="anchor-link" href="#PaymentsForRepurchaseOfCommonStock:-Stock-buybacks"> </a></h4><p>'PaymentsForRepurchaseOfCommonStock',
 'PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations',
 'PaymentsForRepurchaseOfConvertiblePreferredStock',
 'PaymentsForRepurchaseOfPreferredStockAndPreferenceStock',
 'PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock',
 'PaymentsForRepurchaseOfRedeemablePreferredStock'</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsForRepurchaseOfCommonStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemablePreferredStock&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span>
                                     <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsOfDividendsTotal&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal&#39;</span><span class="p">]]</span> \
                  <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;cf_not_cleaned.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-empty-companies">Clean empty companies<a class="anchor-link" href="#Clean-empty-companies"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_selected</span> <span class="o">=</span> <span class="n">cf_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> 
                                     <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="o">.</span>
                                     <span class="s1">&#39;PaymentsOfDividendsTotal&#39;</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">cf_cols_selected</span><span class="p">[</span><span class="n">cf_cols_selected</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>514</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span> <span class="o">=</span> <span class="n">cf_cols_selected</span><span class="p">[</span><span class="o">~</span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(117038, 11)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;cf.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="03_IncomeStatement">03_IncomeStatement<a class="anchor-link" href="#03_IncomeStatement"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gross Margin</p>
<ul>
<li>Net Sales</li>
<li>Cost of Sales</li>
<li>Gross Margin -&gt; NetSales - CostOfSales</li>
</ul>
<p>Operating Expenses</p>
<ul>
<li>R&amp;D</li>
<li>Selling, general and admin</li>
<li><p>Total op expenses = R&amp;D + Selling, general and admin</p>
</li>
<li><p>Operating Income = Gross Margin - Total op expenses      -&gt; OperatingIncomeLoss</p>
</li>
<li>other income</li>
<li><p>Income before provision for income taxes = operating income + other income</p>
</li>
<li><p>Provision for income taxes</p>
</li>
<li>Net income = Income before taxes -taxes                   -&gt; NetIncomeLoss -&gt; also available in CF(!)</li>
</ul>
<p>Earning per share</p>
<ul>
<li>Basic</li>
<li>Diluted</li>
</ul>
<p>Shares used in computing earnings per share:</p>
<ul>
<li>basic</li>
<li>diluted</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;IS&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">is_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116298, 1927)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># is_empty_count = get_empty_count(is_pivot_value)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd</span> <span class="o">=</span> <span class="n">is_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd</span><span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_pivot_pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">pivot_group</span><span class="p">)</span> <span class="c1"># create a column that countains the number of not null values of the row</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116298, 1928)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span> <span class="o">=</span> <span class="n">is_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merge relevant columns from the UN dataset</span>
<span class="n">is_pivot_pd_copy</span> <span class="o">=</span> <span class="n">prepare_un_values</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NetIncomeLossAllocatedToLimitedPartners&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Revenues&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SalesRevenueNet&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RevenueFromContractWithCustomerExcludingAssessedTax&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;RevenueFromContractWithCustomerIncludingAssessedTax&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;CostOfGoodsAndServicesSold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfGoodsSold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfRevenue&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfServices&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">,</span>
    <span class="s1">&#39;OperatingIncomeLoss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">,</span>
    <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest&#39;</span><span class="p">,</span>
    
    <span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span>
<span class="p">])</span>
<span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(116298, 1945)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if there are less than 5 columns with values it is likely that this is not a complete statement</span>
<span class="c1"># often this indicates, that the real information is inside the ComprehensiveIncome Statement and not in an IncomeStatement</span>
<span class="n">is_pivot_pd_copy</span> <span class="o">=</span> <span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;value_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span> 
<span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(115899, 1945)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="shares">shares<a class="anchor-link" href="#shares"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;EarningsPerShareBasic&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EarningsPerShareBasicAndDiluted&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EarningsPerShareDiluted&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EarningsPerShareBasicDistributed&#39;</span><span class="p">,</span>   
 <span class="s1">&#39;EarningsPerShareDilutedDistributed&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>EarningsPerShareBasic   28706
EarningsPerShareBasicAndDiluted   94567
EarningsPerShareDiluted   29540
EarningsPerShareBasicDistributed   115882
EarningsPerShareDilutedDistributed   115882
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShareBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShareBasicAndDiluted&#39;</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShareBasicDistributed&#39;</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShareDiluted&#39;</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">)</span> 
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShareDilutedDistributed&#39;</span><span class="p">,</span> <span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;EarningsPerShare_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>EarningsPerShare_hj   7138
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;WeightedAverageNumberOfSharesOutstandingBasic&#39;</span><span class="p">,</span><span class="s1">&#39;WeightedAverageNumberOfDilutedSharesOutstanding&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WeightedAverageNumberOfSharesOutstandingBasic   42151
WeightedAverageNumberOfDilutedSharesOutstanding   42378
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;SharesOutstanding_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;WeightedAverageNumberOfSharesOutstandingBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;SharesOutstanding_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;WeightedAverageNumberOfDilutedSharesOutstanding&#39;</span><span class="p">,</span> <span class="s1">&#39;SharesOutstanding_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SharesOutstanding_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SharesOutstanding_hj   40947
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="NetIncome">NetIncome<a class="anchor-link" href="#NetIncome"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   15045
NetIncomeLossAvailableToCommonStockholdersBasic   91896
ProfitLoss   76463
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_NetIncomeLossAllocatedToLimitedPartners&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAllocatedToLimitedPartners&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span>


<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAllocatedToLimitedPartners&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss_hj   621
NetIncomeLoss   15026
ProfitLoss   76441
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="NetSales-/-Revenues">NetSales / Revenues<a class="anchor-link" href="#NetSales-/-Revenues"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> 
    <span class="s1">&#39;Revenues&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SalesRevenueNet&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RevenueFromContractWithCustomerExcludingAssessedTax&#39;</span><span class="p">,</span> <span class="c1"># Sales</span>
    <span class="s1">&#39;RevenueFromContractWithCustomerIncludingAssessedTax&#39;</span><span class="p">,</span> <span class="c1"># Sales</span>
<span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Revenues   72861
SalesRevenueNet   85708
RevenueFromContractWithCustomerExcludingAssessedTax   105818
RevenueFromContractWithCustomerIncludingAssessedTax   112696
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;Revenues_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_Revenues&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_SalesRevenueNet&#39;</span><span class="p">,</span> <span class="s1">&#39;SalesRevenueNet&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_RevenueFromContractWithCustomerExcludingAssessedTax&#39;</span><span class="p">,</span> <span class="s1">&#39;RevenueFromContractWithCustomerExcludingAssessedTax&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_RevenueFromContractWithCustomerIncludingAssessedTax&#39;</span><span class="p">,</span> <span class="s1">&#39;RevenueFromContractWithCustomerIncludingAssessedTax&#39;</span><span class="p">)</span>
<span class="c1">#copy_if_not_empty(is_pivot_pd_copy, &#39;cpy_RevenuesExcludingInterestAndDividends&#39;, &#39;RevenuesExcludingInterestAndDividends&#39;)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Revenues&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;SalesRevenueNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RevenueFromContractWithCustomerExcludingAssessedTax&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RevenueFromContractWithCustomerIncludingAssessedTax&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RevenuesExcludingInterestAndDividends&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RegulatedAndUnregulatedOperatingRevenue&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># some companies provide NonInterestIncome and InterestAndDividendIncomeOperating instead of a Revenue</span>
<span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span>  
                      <span class="s1">&#39;InterestAndDividendIncomeOperating&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NoninterestIncome&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>

<span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span>  
                      <span class="s1">&#39;InterestIncomeExpenseNet&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NoninterestIncome&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Revenues_hj   19673
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="CostOfSales">CostOfSales<a class="anchor-link" href="#CostOfSales"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span> 
    <span class="s1">&#39;CostOfGoodsAndServicesSold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfGoodsSold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfRevenue&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostOfServices&#39;</span><span class="p">,</span>
<span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CostOfGoodsAndServicesSold   92834
CostOfGoodsSold   92088
CostOfRevenue   97276
CostOfServices   106588
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CostOfGoodsAndServicesSold&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfGoodsAndServicesSold&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CostOfGoodsSold&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfGoodsSold&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CostOfRevenue&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CostOfServices&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfServices&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CostOfGoodsAndServicesSold&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">)</span>

<span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span>  
                      <span class="s1">&#39;CostOfGoodsSold&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CostOfServices&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CostOfGoodsSold&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CostOfServices&#39;</span><span class="p">,</span> <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CostOfRevenue_hj   52385
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="OperatingIncomeLoss">OperatingIncomeLoss<a class="anchor-link" href="#OperatingIncomeLoss"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;OperatingIncomeLoss&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>OperatingIncomeLoss   28924
IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments   59817
IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest   70434
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">,</span> <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest&#39;</span><span class="p">,</span> <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesExtraordinaryItemsNoncontrollingInterest&#39;</span><span class="p">,</span> <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>OperatingIncomeLoss_hj   4073
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Other">Other<a class="anchor-link" href="#Other"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CostsAndExpenses&#39;</span><span class="p">,</span> <span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">)</span>


<span class="n">Grossprofit</span> <span class="o">...</span> <span class="n">mitnehmen</span><span class="o">..</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Save">Save<a class="anchor-link" href="#Save"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span>
                    <span class="s1">&#39;Revenues_hj&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;CostOfRevenue_hj&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;OperatingIncomeLoss_hj&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;NetIncomeLoss_hj&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;SharesOutstanding_hj&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;EarningsPerShare_hj&#39;</span>
                 <span class="p">]]</span> \
                  <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;is_not_cleaned.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="xx_trials">xx_trials<a class="anchor-link" href="#xx_trials"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># index = is_pivot_pd_copy.form == &#39;10-K&#39;</span>
<span class="c1"># print(&#39;10-Ks&#39;, len(pd.unique(is_pivot_pd_copy[index].adsh))) # 32283</span>

<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;4&#39;)].count() # 32188</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;0&#39;)].count() # 96</span>

<span class="c1"># len(pd.unique(is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; </span>
<span class="c1">#                                (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; </span>
<span class="c1">#                                (is_pivot_pd_copy.qtrs.isin([&#39;0&#39;,&#39;4&#39;]) )].adsh) )# 32207</span>

<span class="c1"># index = is_pivot_pd_copy.form == &#39;10-Q&#39;</span>
<span class="c1"># print(&#39;10-Qs&#39;, len(pd.unique(is_pivot_pd_copy[index].adsh))) # 101521</span>
<span class="c1"># is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-Q&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;1&#39;)].count() # 101378</span>
<span class="c1"># is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-Q&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;2&#39;)].count() # 101378</span>
<span class="c1"># is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-Q&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;3&#39;)].count() # 101378</span>
<span class="n">is_pivot_pd_copy</span><span class="p">[(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">form</span> <span class="o">==</span> <span class="s1">&#39;10-Q&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">qtrs</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># 101378</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>cik                                                                        200
ticker                                                                     200
adsh                                                                       200
form                                                                       200
period                                                                     200
                                                                          ... 
WeightedAverageNumberOfSharesRestrictedStock                                 0
WeightedAverageNumberOfSharesTreasuryStock                                   0
WeightedAverageNumerDilutedLimitedPartnershipUnitsOutstandingAdjustment      0
WellServiceExpense                                                           0
WriteOffOfDeferredDebtIssuanceCost                                           0
Length: 2328, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">is_pivot_pd_copy</span><span class="p">[</span>\
                 
                 <span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">OperatingIncomeLoss_hj</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>  
                 <span class="o">&amp;</span><span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
            
<span class="c1">#                 &amp;(is_pivot_pd_copy.CostsAndExpenses.notnull())</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.CostOfGoodsAndServicesSold.isnull()) </span>
<span class="c1">#                  &amp;(is_pivot_pd_copy.CostOfGoodsSold.isnull()) </span>
<span class="c1">#                  &amp;(is_pivot_pd_copy.CostOfRevenue.isnull()) </span>
<span class="c1">#                  &amp;(is_pivot_pd_copy.CostOfServices.isnull())   </span>
                 
 <span class="c1">#                (is_pivot_pd_copy.EarningsPerShareBasic.isnull())</span>
<span class="c1">#                   &#39;, &#39;WeightedAverageNumberOfSharesOutstandingBasic&#39;      </span>

<span class="c1">#                      (is_pivot_pd_copy.NetIncomeLoss.notnull())  \</span>
<span class="c1">#                    &amp; (is_pivot_pd_copy.ProfitLoss.notnull())  \</span>
<span class="c1">#                  &amp; (is_pivot_pd_copy.NetIncomeLossAvailableToCommonStockholdersBasic.notnull()) \</span>
<span class="c1">#                 (is_pivot_pd_copy.Revenues.isnull())  \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.SalesRevenueNet.isnull())  \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.RevenueFromContractWithCustomerExcludingAssessedTax.isnull())   \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.RevenueFromContractWithCustomerIncludingAssessedTax.isnull())   \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.InterestAndDividendIncomeOperating.isnull())   \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.NoninterestIncome.isnull())   \</span>
<span class="c1">#                &amp;(is_pivot_pd_copy.RevenuesExcludingInterestAndDividends.isnull())   \</span>
<span class="c1">#                  &amp;(is_pivot_pd_copy.RegulatedAndUnregulatedOperatingRevenue.isnull())  \</span>
<span class="c1">#                 &amp;(is_pivot_pd_copy.SalesRevenueNet.isnull())  \</span>
                <span class="p">]</span> \
  <span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">,</span><span class="s2">&quot;qtrs&quot;</span><span class="p">,</span><span class="s2">&quot;value_count&quot;</span><span class="p">,</span>
    <span class="s1">&#39;OperatingIncomeLoss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CostsAndExpenses&#39;</span><span class="p">,</span>
<span class="c1">#     &#39;CostOfGoodsAndServicesSold&#39;,</span>
<span class="c1">#     &#39;CostOfGoodsSold&#39;,</span>
<span class="c1">#     &#39;CostOfRevenue&#39;,</span>
<span class="c1">#     &#39;CostOfServices&#39;,</span>
<span class="c1">#     &#39;NetIncomeLoss&#39;, &#39;ProfitLoss&#39;,&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span>
<span class="c1">#     &#39;Revenues&#39;,</span>
<span class="c1">#     &#39;SalesRevenueNet&#39;, </span>
<span class="c1">#      &#39;RevenueFromContractWithCustomerExcludingAssessedTax&#39;, # Sales</span>
<span class="c1">#      &#39;RevenueFromContractWithCustomerIncludingAssessedTax&#39;, # Sales</span>
<span class="c1">#     &#39;InterestAndDividendIncomeOperating&#39;,</span>
<span class="c1">#     &#39;NoninterestIncome&#39;,</span>
<span class="c1">#     &#39;RevenuesExcludingInterestAndDividends&#39;</span>
    
<span class="c1">#  &#39;Revenues&#39;,</span>
<span class="c1">#  &#39;SalesRevenueNet&#39;,</span>
<span class="c1">#  &#39;OperatingLeasesIncomeStatementLeaseRevenue&#39;,</span>


<span class="c1">#  &#39;RevenueFromCollaborativeArrangementExcludingRevenueFromContractWithCustomer&#39;,</span>
<span class="c1">#  &#39;RevenueNotFromContractWithCustomer&#39;,</span>
<span class="c1">#  &#39;RevenueNotFromContractWithCustomerExcludingInterestIncome&#39;,</span>
<span class="c1">#  &#39;RevenueNotFromContractWithCustomerOther&#39;,</span>
<span class="c1">#  &#39;RevenuesFromExternalCustomers&#39;,    </span>
<span class="c1"># &#39;CostOfGoodsAndServicesSold&#39;,</span>
<span class="c1">#  &#39;GrossProfit&#39;</span>
   
   
   
   <span class="p">]]</span> \
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>form</th>
      <th>fp</th>
      <th>qtrs</th>
      <th>value_count</th>
      <th>OperatingIncomeLoss</th>
      <th>IncomeLossFromContinuingOperationsBeforeIncomeTaxesMinorityInterestAndIncomeLossFromEquityMethodInvestments</th>
      <th>CostsAndExpenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31205</th>
      <td>798359</td>
      <td>IRET</td>
      <td>0000798359-12-000015</td>
      <td>2012-01-31</td>
      <td>10-Q</td>
      <td>Q3</td>
      <td>1</td>
      <td>27</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.226400e+07</td>
    </tr>
    <tr>
      <th>74534</th>
      <td>65172</td>
      <td>MSB</td>
      <td>0001104659-12-025296</td>
      <td>2012-01-31</td>
      <td>10-K</td>
      <td>FY</td>
      <td>4</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58282</th>
      <td>1328598</td>
      <td>FXE</td>
      <td>0001193125-12-110009</td>
      <td>2012-01-31</td>
      <td>10-Q</td>
      <td>Q1</td>
      <td>1</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>71016</th>
      <td>14177</td>
      <td>BRID</td>
      <td>0001437749-12-001969</td>
      <td>2012-01-31</td>
      <td>10-Q</td>
      <td>Q1</td>
      <td>1</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58391</th>
      <td>799850</td>
      <td>CRMT</td>
      <td>0001171843-12-000715</td>
      <td>2012-01-31</td>
      <td>10-Q</td>
      <td>Q3</td>
      <td>1</td>
      <td>18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.362500e+07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>49394</th>
      <td>799850</td>
      <td>CRMT</td>
      <td>0001171843-20-006280</td>
      <td>2020-07-31</td>
      <td>10-Q</td>
      <td>Q1</td>
      <td>1</td>
      <td>19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.623720e+08</td>
    </tr>
    <tr>
      <th>81583</th>
      <td>65172</td>
      <td>MSB</td>
      <td>0001558370-20-011056</td>
      <td>2020-07-31</td>
      <td>10-Q</td>
      <td>Q2</td>
      <td>1</td>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88069</th>
      <td>808450</td>
      <td>NAV</td>
      <td>0000808450-20-000098</td>
      <td>2020-07-31</td>
      <td>10-Q</td>
      <td>Q3</td>
      <td>1</td>
      <td>19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.703000e+09</td>
    </tr>
    <tr>
      <th>100464</th>
      <td>72333</td>
      <td>JWN</td>
      <td>0000072333-20-000195</td>
      <td>2020-07-31</td>
      <td>10-Q</td>
      <td>Q2</td>
      <td>1</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>57671</th>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>Q1</td>
      <td>1</td>
      <td>18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.975000e+08</td>
    </tr>
  </tbody>
</table>
<p>4073 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">adsh</span><span class="o">==</span><span class="s2">&quot;0000082166-20-000130&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>form</th>
      <th>period</th>
      <th>fp</th>
      <th>qtrs</th>
      <th>AntidilutiveSecuritiesExcludedFromComputationOfEarningsPerShareAmount</th>
      <th>NetIncomeLoss</th>
      <th>cpy_NetIncomeLoss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19921</th>
      <td>82166</td>
      <td>RAVN</td>
      <td>0000082166-20-000130</td>
      <td>10-Q</td>
      <td>2020-07-31</td>
      <td>Q2</td>
      <td>1</td>
      <td>321613.0</td>
      <td>5819000.0</td>
      <td>5819000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.qtrs == &#39;4&#39;) &amp; (is_pivot_pd_copy.fp != &#39;FY&#39;)]</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;4&#39;)].count() # 32188</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;)].count() #54080</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) ].count() #54100</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp != &#39;FY&#39;)].count() #20</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;0&#39;)].count() # 96</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;1&#39;)].count() # 21363</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;2&#39;)].count() # 69</span>
<span class="c1">#is_pivot_pd_copy[(is_pivot_pd_copy.form == &#39;10-K&#39;) &amp; (is_pivot_pd_copy.fp == &#39;FY&#39;) &amp; (is_pivot_pd_copy.qtrs == &#39;3&#39;)].count() # 56</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>cik                                                                        21363
ticker                                                                     21363
adsh                                                                       21363
form                                                                       21363
period                                                                     21363
                                                                           ...  
WeightedAverageNumberOfSharesRestrictedStock                                   0
WeightedAverageNumberOfSharesTreasuryStock                                     0
WeightedAverageNumerDilutedLimitedPartnershipUnitsOutstandingAdjustment        0
WellServiceExpense                                                             1
WriteOffOfDeferredDebtIssuanceCost                                            13
Length: 2328, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_pivot_pd_copy</span><span class="p">[</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">adsh</span> <span class="o">==</span> <span class="s1">&#39;0001401521-20-000018&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">pivot_group</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>128918    7
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#is_pivot_pd_copy[is_pivot_pd_copy.adsh == &#39;0001401521-20-000018&#39;].isnull().sum(axis=1)</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">is_pivot_pd_copy</span><span class="p">[(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">qtrs</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">qtrs</span> <span class="o">&gt;</span> <span class="s1">&#39;4&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">selection</span> <span class="o">==</span> <span class="mi">2320</span> <span class="c1"># shape[1]-8</span>
<span class="n">selection</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1556</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_empty_pd</span> <span class="o">=</span> <span class="n">cf_empty_count</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_empty_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, 3052)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_melt_pd</span> <span class="o">=</span> <span class="n">cf_empty_pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">133811</span> <span class="o">-</span><span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">canditates</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span><span class="s1">&#39;cpy_CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">]</span>

<span class="n">cf_melt_pd</span><span class="p">[</span><span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">canditates</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tag</th>
      <th>Count</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>350</th>
      <td>CashAndCashEquivalentsPeriodIncreaseDecrease</td>
      <td>30244</td>
      <td>103567</td>
    </tr>
    <tr>
      <th>351</th>
      <td>CashAndCashEquivalentsPeriodIncreaseDecreaseEx...</td>
      <td>132424</td>
      <td>1387</td>
    </tr>
    <tr>
      <th>360</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>130603</td>
      <td>3208</td>
    </tr>
    <tr>
      <th>361</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>119033</td>
      <td>14778</td>
    </tr>
    <tr>
      <th>382</th>
      <td>CashPeriodIncreaseDecrease</td>
      <td>132236</td>
      <td>1575</td>
    </tr>
    <tr>
      <th>383</th>
      <td>CashPeriodIncreaseDecreaseExcludingExchangeRat...</td>
      <td>133766</td>
      <td>45</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">cf_melt_pd</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span>
<span class="nb">sorted</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">sorted</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_count</span> <span class="o">=</span> <span class="n">get_empty_count</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_pd</span> <span class="o">=</span> <span class="n">empty_count</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span> <span class="o">=</span> <span class="n">empty_pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="c1"># df2 = pd.melt(df, id_vars=[&quot;location&quot;, &quot;name&quot;], var_name=&quot;Date&quot;, value_name=&quot;Value&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Tag&#39;, &#39;Count&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">df_all_selected</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001564590-20-043606&#39; and stmt == &#39;IS&#39; and qtrs==&#39;1&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="c1">#pd_frame = df_all_selected.where(&quot;adsh == &#39;0001628279-20-000210&#39;&quot;).toPandas()</span>
<span class="c1">#pd_frame = df_all_selected.where(&quot;adsh == &#39;0001193125-20-213555&#39;&quot;).toPandas()</span>
<span class="c1">#print(pd_frame.sort_values([&#39;report&#39;, &#39;line&#39;]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">pd_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd_frame</span><span class="p">[[</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="s1">&#39;qtrs&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;report&#39;</span><span class="p">,</span><span class="s1">&#39;qtrs&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fp</th>
      <th>cik</th>
      <th>tag</th>
      <th>value</th>
      <th>stmt</th>
      <th>report</th>
      <th>line</th>
      <th>period</th>
      <th>qtrs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>RevenueFromContractWithCustomerExcludingAssess...</td>
      <td>1.932100e+10</td>
      <td>IS</td>
      <td>4</td>
      <td>1</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>LaborAndRelatedExpense</td>
      <td>6.852000e+09</td>
      <td>IS</td>
      <td>4</td>
      <td>3</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>DepreciationDepletionAndAmortization</td>
      <td>9.260000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>6</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>FuelCosts</td>
      <td>5.650000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>7</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>CostOfPropertyRepairsAndMaintenance</td>
      <td>8.060000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>8</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>OtherCostAndExpenseOperating</td>
      <td>2.669000e+09</td>
      <td>IS</td>
      <td>4</td>
      <td>9</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>CostsAndExpenses</td>
      <td>1.773100e+10</td>
      <td>IS</td>
      <td>4</td>
      <td>10</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>OperatingIncomeLoss</td>
      <td>1.590000e+09</td>
      <td>IS</td>
      <td>4</td>
      <td>11</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>InterestIncomeExpenseNonoperatingNet</td>
      <td>-1.840000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>13</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>NetPeriodicDefinedBenefitsExpenseReversalOfExp...</td>
      <td>-2.010000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>14</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>OtherNonoperatingIncomeExpense</td>
      <td>-1.000000e+06</td>
      <td>IS</td>
      <td>4</td>
      <td>15</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>NonoperatingIncomeExpense</td>
      <td>1.600000e+07</td>
      <td>IS</td>
      <td>4</td>
      <td>16</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>IncomeLossFromContinuingOperationsBeforeIncome...</td>
      <td>1.606000e+09</td>
      <td>IS</td>
      <td>4</td>
      <td>17</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>IncomeTaxExpenseBenefit</td>
      <td>3.610000e+08</td>
      <td>IS</td>
      <td>4</td>
      <td>18</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>NetIncomeLoss</td>
      <td>1.245000e+09</td>
      <td>IS</td>
      <td>4</td>
      <td>19</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>EarningsPerShareBasic</td>
      <td>4.750000e+00</td>
      <td>IS</td>
      <td>4</td>
      <td>21</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>EarningsPerShareDiluted</td>
      <td>4.720000e+00</td>
      <td>IS</td>
      <td>4</td>
      <td>22</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Q1</td>
      <td>1048911</td>
      <td>CommonStockDividendsPerShareDeclared</td>
      <td>1.300000e+00</td>
      <td>IS</td>
      <td>4</td>
      <td>23</td>
      <td>2020-08-31</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsIncludingDisposalGroupAndDiscontinuedOperations</span>
<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsIncludingDisposalGroupAndDiscontinuedOperations</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents</span>
<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_report</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001492298-20-000025&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>585411</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;BS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>133872</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;EQ&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>86120</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">CostOfGoodsSold</span>
<span class="n">CostOfRevenue</span>
<span class="n">CostOfServices</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">is_pivot_pd_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;CostOf&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)]</span>
<span class="c1">#[x for x in is_pivot_pd_copy.columns.values if (&#39;Revenue&#39; in x) and (&#39;Customer&#39; in x)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;CompensationExpenseExcludingCostOfGoodAndServiceSold&#39;,
 &#39;CostOfChemicals&#39;,
 &#39;CostOfCoalProductsAndServices&#39;,
 &#39;CostOfDomesticRegulatedElectric&#39;,
 &#39;CostOfDomesticRegulatedGasRevenue&#39;,
 &#39;CostOfGoldProductsAndServices&#39;,
 &#39;CostOfGoodsAndServiceExcludingDepreciationDepletionAndAmortization&#39;,
 &#39;CostOfGoodsAndServicesEnergyCommoditiesAndServices&#39;,
 &#39;CostOfGoodsAndServicesSold&#39;,
 &#39;CostOfGoodsAndServicesSoldAmortization&#39;,
 &#39;CostOfGoodsAndServicesSoldDepreciation&#39;,
 &#39;CostOfGoodsAndServicesSoldDepreciationAndAmortization&#39;,
 &#39;CostOfGoodsAndServicesSoldOverhead&#39;,
 &#39;CostOfGoodsSold&#39;,
 &#39;CostOfGoodsSoldAmortization&#39;,
 &#39;CostOfGoodsSoldDepreciation&#39;,
 &#39;CostOfGoodsSoldDepreciationAndAmortization&#39;,
 &#39;CostOfGoodsSoldDepreciationDepletionAndAmortization&#39;,
 &#39;CostOfGoodsSoldDirectLabor&#39;,
 &#39;CostOfGoodsSoldDirectMaterials&#39;,
 &#39;CostOfGoodsSoldElectric&#39;,
 &#39;CostOfGoodsSoldExcludingDepreciationDepletionAndAmortization&#39;,
 &#39;CostOfGoodsSoldOilAndGas&#39;,
 &#39;CostOfGoodsSoldOverhead&#39;,
 &#39;CostOfGoodsSoldSalesTypeLease&#39;,
 &#39;CostOfGoodsSoldSubscription&#39;,
 &#39;CostOfMerchandiseSalesBuyingAndOccupancyCosts&#39;,
 &#39;CostOfNaturalGasPurchases&#39;,
 &#39;CostOfOtherAlternativeEnergy&#39;,
 &#39;CostOfOtherManufacturedProducts&#39;,
 &#39;CostOfOtherPropertyOperatingExpense&#39;,
 &#39;CostOfPropertyRepairsAndMaintenance&#39;,
 &#39;CostOfPurchasedOilAndGas&#39;,
 &#39;CostOfPurchasedPower&#39;,
 &#39;CostOfPurchasedWater&#39;,
 &#39;CostOfRealEstateRevenue&#39;,
 &#39;CostOfRealEstateSales&#39;,
 &#39;CostOfRealEstateSalesExcludingInterest&#39;,
 &#39;CostOfRealEstateSalesInterest&#39;,
 &#39;CostOfReimbursableExpense&#39;,
 &#39;CostOfRevenue&#39;,
 &#39;CostOfSecondaryProcessing&#39;,
 &#39;CostOfServices&#39;,
 &#39;CostOfServicesAmortization&#39;,
 &#39;CostOfServicesCatering&#39;,
 &#39;CostOfServicesDepreciation&#39;,
 &#39;CostOfServicesDepreciationAndAmortization&#39;,
 &#39;CostOfServicesDirectLabor&#39;,
 &#39;CostOfServicesDirectMaterials&#39;,
 &#39;CostOfServicesDirectTaxesAndLicensesCosts&#39;,
 &#39;CostOfServicesEnergyServices&#39;,
 &#39;CostOfServicesEnvironmentalRemediation&#39;,
 &#39;CostOfServicesExcludingDepreciationDepletionAndAmortization&#39;,
 &#39;CostOfServicesLicensesAndMaintenanceAgreements&#39;,
 &#39;CostOfServicesLicensesAndServices&#39;,
 &#39;CostOfServicesMaintenanceCosts&#39;,
 &#39;CostOfServicesOilAndGas&#39;,
 &#39;CostOfServicesOverhead&#39;,
 &#39;CostOfTransmission&#39;,
 &#39;CostOfTransmissionOther&#39;,
 &#39;CostOfUtilities&#39;,
 &#39;CostOfWorldwideUnregulatedElectric&#39;,
 &#39;DefinedBenefitPlanCostOfProvidingSpecialOrContractualTerminationBenefitRecognizedDuringPeriod&#39;,
 &#39;DerivativeCostOfHedge&#39;,
 &#39;FoodAndBeverageCostOfSales&#39;,
 &#39;OtherCostOfOperatingRevenue&#39;,
 &#39;OtherCostOfServices&#39;,
 &#39;PublicUtilitiesAllowanceForFundsUsedDuringConstructionCapitalizedCostOfEquity&#39;,
 &#39;RealEstateCostOfRealEstateSold&#39;,
 &#39;RealEstateInvestmentPartnershipCostOfSales&#39;,
 &#39;RelatedPartiesAmountInCostOfSales&#39;,
 &#39;RetailLandSalesInstallmentMethodTotalCostOfSale&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;StockholdersEquity&#39;,
 &#39;StockholdersEquityAttributableToParentNotAllowableForNetCapital&#39;,
 &#39;StockholdersEquityBeforeTreasuryStock&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterestAdjustedBalance1&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio1&#39;,
 &#39;StockholdersEquityNoteSubscriptionsReceivable&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

