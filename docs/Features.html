---

title: Features

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 07_Features.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_combined_folder</span>   <span class="o">=</span> <span class="s2">&quot;D:/data_mt/06_combined/&quot;</span>
<span class="n">all_features_folder</span>   <span class="o">=</span> <span class="s2">&quot;D:/data_mt/07_features/&quot;</span>
<span class="n">all_data_local_folder</span> <span class="o">=</span> <span class="s2">&quot;./data/&quot;</span>

<span class="n">join_group</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;filed&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;fp&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_combined_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_combined_folder</span> <span class="o">+</span> <span class="s2">&quot;06_all_combined.csv&quot;</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">filed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filed</span><span class="p">)</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">null_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">null_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;null: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">null_count</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">inf_count</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">inf_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inf: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">inf_count</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span>    <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_value</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>  <span class="o">&gt;</span> <span class="n">max_value</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_value</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span>   <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>  <span class="o">&lt;</span> <span class="n">min_value</span><span class="p">),</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Load">01_Load<a class="anchor-link" href="#01_Load"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">load_combined_data</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">join_group</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(95395, 28)
{&#39;AssetsNoncurrent&#39;, &#39;c_Revenues&#39;, &#39;bs_qtrs&#39;, &#39;c_PaymentsOfDividendsTotal&#39;, &#39;Liabilities&#39;, &#39;is_qtrs&#39;, &#39;c_CashIncreaseDecrease&#39;, &#39;c_Equity&#39;, &#39;c_RetainedEarnings&#39;, &#39;cf_qtrs&#39;, &#39;LiabilitiesCurrent&#39;, &#39;LiabilitiesNoncurrent&#39;, &#39;c_PaymentsForRepurchaseOfStockTotal&#39;, &#39;c_NetIncomeLoss&#39;, &#39;c_OperatingIncomeLoss&#39;, &#39;GrossProfit&#39;, &#39;c_CashFromInvesting&#39;, &#39;AssetsCurrent&#39;, &#39;c_CashFromOperating&#39;, &#39;Assets&#39;, &#39;c_CashFromFinancing&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="02_Basic-Features">02_Basic Features<a class="anchor-link" href="#02_Basic-Features"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;period_day_of_week&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;period_day_of_month&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;period_day_of_year&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;period_week_of_year&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekofyear</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;period_month_of_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="03_In-report-Ratios-Features">03_In-report Ratios Features<a class="anchor-link" href="#03_In-report-Ratios-Features"> </a></h2><p>Contains features, that are created based on the data inside a single report.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>BalanceSheet Ratios</strong></p>
<ul>
<li>WorkingCapitalToAssets = (CurrentAssets - CurrentLiabilities) / CurrentAssets</li>
<li>CurrentRatio = CurrentAssets / CurrentLiabilities</li>
<li>DebtToEquity = Liabilities / Equity</li>
<li>DebtRatio = TotalLiabilities/TotalAssets</li>
</ul>
<p><strong>IncomeStatement Ratios</strong></p>
<ul>
<li>NetProfitMargin  = GrossProfit / Revenues</li>
<li>OperatingMargin  = OperatingIncome / Revenues</li>
<li>NetIncomeMargin  = NetIncome / Revenues </li>
</ul>
<p><strong>Cashflow Ratios</strong></p>
<ul>
<li>CashGeneratingPowerRatio = CashFromOperations / (CashFromOperations + CashFromFinancing + CashFromInvesting)</li>
<li>ExternalFinancingIndexRatio = CashFromFinancing / CashFromOperations)</li>
</ul>
<p><strong>IncomeStatment / BalanceSheet</strong></p>
<ul>
<li>ReturnOnEquity = NetIncome / (Average) Equity </li>
<li>ReturnOnAssets = NetIncome / TotalAssets</li>
<li>AssetsTurnoverRatio = NetSales / TotalAssets</li>
</ul>
<p>(Variation: NetIncome: use TTM NetIncome -&gt; NetIncome during the last 12 months)
(Variation: Total Assets: Use average of Assets over the period)</p>
<p><strong>IncomeStatement / CashFlow</strong></p>
<ul>
<li>DividendPayoutRatio = DividendsPaid / NetIncome</li>
<li>StockRepurchaseRatio = PaymentsForStockRepurchase / NetIncome </li>
<li>OperatingCashFlowRatio = CashFromOperations / Revenue</li>
</ul>
<p><strong>BalanceSheet / CashFlow</strong></p>
<ul>
<li>AssetEfficiencyRatio = CashFromOperations / Assets</li>
<li>CurrentLiabilityCoverageRatio = (CashFromOperations - DividendsPaid)/CurrentLiabilities</li>
<li>LongTermDebtCoverageRatio = (CashFromOperations - DividendsPaid)/NonCurrentLiabilities</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BalanceSheet-Ratios">BalanceSheet Ratios<a class="anchor-link" href="#BalanceSheet-Ratios"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_workcapToAssets&#39;</span><span class="p">,</span><span class="s1">&#39;r_currentRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_deptToEquity&#39;</span><span class="p">,</span><span class="s1">&#39;r_deptRatio&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># WorkingCapitalToAssets = (CurrentAssets - CurrentLiabilities) / CurrentAssets</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_workcapToAssets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">AssetsCurrent</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">AssetsCurrent</span>

<span class="c1"># CurrentRatio = CurrentAssets / CurrentLiabilities</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_currentRatio&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">AssetsCurrent</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span>

<span class="c1"># DebtToEquity = Liabilities / Equity</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_deptToEquity&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Liabilities</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Equity</span>

<span class="c1"># DebtRatio = TotalLiabilities/TotalAssets</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_deptRatio&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Liabilities</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">Assets</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_currentRatio   2
inf:  r_deptToEquity   5
null:  r_workcapToAssets   4
null:  r_currentRatio   4
null:  r_deptToEquity   4
null:  r_deptRatio   4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># WorkingCapitalToAssets = (CurrentAssets - CurrentLiabilities) / CurrentAssets</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_workcapToAssets</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_workcapToAssets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># CurrentRatio = CurrentAssets / CurrentLiabilities</span>
<span class="c1"># if there is no current dept, set the current ratio to 1</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_currentRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_currentRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># DebtToEquity = Liabilities / Equity</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_deptToEquity</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Liabilities</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_deptToEquity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># DebtRatio = TotalLiabilities/TotalAssets</span>
<span class="c1"># if there is no total dept, set the deptRatio to 1</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_deptRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Liabilities</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_deptRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_deptToEquity&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="c1"># a good ratio is below 2</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_currentRatio&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="c1"># a good current ratio is between 1..2, a 10</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_deptRatio&#39;</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#  a good debt to asset ratio should be below 1, so a 5 is already a bad sign</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_workcapToAssets&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">#  a good debt to asset ratio should be below 1, so a 5 is already a bad sign</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">bs_ratio_cols</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bs_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="IncomeStatement-Ratios">IncomeStatement Ratios<a class="anchor-link" href="#IncomeStatement-Ratios"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_netProfitMargin&#39;</span><span class="p">,</span><span class="s1">&#39;r_operatingMargin&#39;</span><span class="p">,</span><span class="s1">&#39;r_netIncomeMargin&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># NetProfitMargin  = GrossProfit / Revenues</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_netProfitMargin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">GrossProfit</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Revenues</span>

<span class="c1"># OperatingMargin  = OperatingIncome / Revenues</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_operatingMargin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_OperatingIncomeLoss</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Revenues</span>

<span class="c1"># NetIncomeMargin  = NetIncome / Revenues </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_netIncomeMargin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Revenues</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">is_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">is_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_netProfitMargin   2239
inf:  r_operatingMargin   3526
inf:  r_netIncomeMargin   3526
null:  r_netProfitMargin   1287
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if there is no GrossProfit, set, netProfitMargin to 0.0</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_netProfitMargin</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">GrossProfit</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_netProfitMargin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># this ratios should be between 0 and 1, everything else is not &quot;normal&quot;. Therefore, we limit the range to -1..2</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_netProfitMargin&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_operatingMargin&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_netIncomeMargin&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">is_ratio_cols</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">is_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">is_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CashFlow-Ratios">CashFlow Ratios<a class="anchor-link" href="#CashFlow-Ratios"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_cashGenPowerRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_extFinancingIndexRatio&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># CashGeneratingPowerRatio = CashFromOperations / (CashFromOperations + CashFromFinancing + CashFromInvesting)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_cashGenPowerRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_c_CashFromOperating</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_c_CashFromOperating</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">c_CashFromInvesting</span><span class="p">)</span>

<span class="c1"># ExternalFinancingIndexRatio = CashFromFinancing / CashFromOperations)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_extFinancingIndexRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_c_CashFromOperating</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_cashGenPowerRatio   262
inf:  r_extFinancingIndexRatio   3
null:  r_cashGenPowerRatio   4
null:  r_extFinancingIndexRatio   4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_cashGenPowerRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_c_CashFromOperating</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_cashGenPowerRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_extFinancingIndexRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_CashFromFinancing</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_extFinancingIndexRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_cashGenPowerRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_extFinancingIndexRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">cf_ratio_cols</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="IncomeStatment-/-BalanceSheet-Ratios">IncomeStatment / BalanceSheet Ratios<a class="anchor-link" href="#IncomeStatment-/-BalanceSheet-Ratios"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">isbs_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_returnOnEquity&#39;</span><span class="p">,</span><span class="s1">&#39;r_returnOnAssets&#39;</span><span class="p">,</span><span class="s1">&#39;r_assetsTurnoverRatio&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ReturnOnEquity = NetIncome / (Average) Equity </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_returnOnEquity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Equity</span>

<span class="c1"># ReturnOnAssets = NetIncome / TotalAssets</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_returnOnAssets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">Assets</span>

<span class="c1"># AssetsTurnoverRatio = NetSales / TotalAssets</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_assetsTurnoverRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Revenues</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">Assets</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">isbs_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">isbs_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_returnOnEquity   9
inf:  r_returnOnAssets   4
inf:  r_assetsTurnoverRatio   4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_returnOnEquity&#39;</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_returnOnAssets&#39;</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_assetsTurnoverRatio&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">isbs_ratio_cols</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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PF2nTh0KCwvLnH81dB+B1ERqP+dTr54bc+cuJCxsrK39li9fQr16brWmLSu6j6DCIAgICCAgIMCujXt5eWGxWLjpppsAOHXqFJ6enjRv3hyLxWJbrni+iEh1e+yxx5k5cxoAERETWL58CTNnTuOJJ0Y6uLLqc00vH73//vtJSkoCYOfOnbi5udGyZUt8fX1JTk6moKCAX375hSNHjtCxY8drWYqISJliY+fyxBMjiYmZQcOGDYmJmcETT4wkNtY4j6Gu8mcNrV69GovFwoQJE3jssceYNm0aQUFB1KtXjzlz5gDg7+/Pnj17bCeSY2JiqF+/flWXIiJyRWJj5xIbO9ewXXt61lANY9Q/xNpC7efcamv76VlDIiJSLgWBiIjBKQhERAzOaQemqVPHVPFCTqo275sRqP2cW21sv4r2yWlPFouISNVQ15CIiMEpCEREDE5BICJicAoCERGDUxCIiBicgkBExOAUBCIiBqcgEBExOAWBiIjBOe0jJhxtz549rFu3jsjIyCp5v1OnTjFr1ix2795NgwYN8PT05IUXXuCOO+4od71JkybxzTffcP3115eYHx8fj4uLy1XVkJaWxocffkhMTAxr1qzB3d2d4ODgq94XEXEuCgI7/fzzz5w+fbpK3uvChQuMGDGCQYMG8eqrr2Iymfj6668ZOXIkH3zwAbfccku5648fP57Q0NBK19GxY0fbSHHffvst99xzT6XfsyaqKSFebNy4cRw5coTk5OQqqadYVe9nTXH06FGWL1/OK6+8UubrX331FXPnFo0u9p///If/+Z//wd3dnVatWrF06dLqLPWK9enTh/r16+Pq6gpATk4O3t7ezJo1C3d398uut2jRInr27Em3bt2YMmUKQ4YMsWu0R0MFwbZt23j11VcpLCzk9ttvZ/bs2aWWiY+PJyEhgV9//ZXevXszYsQIpk2bxsmTJzGZTLzwwgt4e3uzaNEizp8/z/Lly/Hy8mL79u3MmjULgMcee4yxY8cClNheq1atyMzM5JdffuH48eM8/PDDhIWFkZKSQrNmzRg1apStjr/85S+Ehoby9ttv88orr9CnTx/69evH5s2byc3NZfbs2Xh7e5e7v2fOnOHFF1/kxIkTtG3blp9//plly5axffv2y9a7ZMkSwsLC2LBhA9988w3XXXcdU6ZM4YsvvsDDw4Njx47x9NNPk5KSUiVt4gg1KcSzs7P58ccfMZvNfPvtt3Tt2rVK6oKq3c+aJCMjg6NHj1729fvuu4/77rsP+ONv28fHp7rKs9ubb75Jq1atALh06RJDhw4lMTGRoUOHXnadHTt22PYtJibG7m0bKggAjhw5wr///W8aNWp02WUyMzNJSUmhbt26TJw4kUGDBvHggw9isVhsjTN+/Hi2b99OWFgY8fHxV7S9xYsXs2/fPlatWkVOTg59+/Zl2LBhpKWllZni3bt3Z/78+bbpxo0b8/HHH7Ny5UreeOMNFi9eDBR9K3jvvfdsy3Xt2pXo6GgWLlxI+/bteeutt9i2bRsjRoy4ot9Rz5496dOnD/fccw99+/blX//6F6mpqQwePJjExEQGDBhwRe9TlWpriCcnJ9O9e3fatm3Lhx9+aAuCn376iWnTppGfn4+bmxuxsbHccMMNREVFceDAAQCGDh3KI488wqlTpyrcz969e5d6v5tvvvmatcXZs2eJiooiMzMTi8XCvffeS0xMDJmZmURERHD+/Hnq1KnD1KlT6dy5M7Nnz+brr7+mTp069O3bl7Fjx3Lu3DlmzpzJgQMHKCgoYPTo0QQHB/Pyyy9z7NgxZsyYwTPPPFPm+11O8b+ZcePGAUXfxP/3f/+X7du3l/jbsVgseHh48MMPP5CZmclzzz3HoEGDyM3NZerUqezbtw+TycSoUaMYMGAAAwcO5B//+Afe3t4UFBTQu3dvEhISOH78OLGxsVy4cIEmTZowY8YMbrzxRh577DGuv/56Dhw4wIIFC0rVmZOTQ05ODo0bNwbg/fffJykpidzcXFxdXZk3bx579uxh7969TJ06lSVLlvDyyy/bQu/111/nk08+wcXFhb/85S9ERkaW21VsuCBo06ZNuSEAcMcdd1C3btGvZsuWLRw6dIhFixYBkJ+fX+63kYq25+PjQ7169WjWrBmNGzcmJycHk8lEQUFBqXXz8vIwmf54fGzxt5zbb7+d9evX2+Zfrmtox44dzJs3z7Zde//hDxo0iMWLFzN48GA+/fTTEqFTnWpjiMfHx/P888/Ttm1bFi5cSFRUFI0bN+a9997jySefJCAggISEBHbv3o3FYuG3334jMTGRzMxM5s2bxyOPPEJMTEyF+zl58uRS72fv38OVtMWXX35Jhw4dWLRoEZcuXSIoKIgffviBL7/8kgceeICnnnqKTZs2sWvXLsxmM5s2bWLt2rXk5uYyefJkLl68yPLly7nzzjuZPXs2Z8+eZciQIdx11122D77o6GiWLFlS6v3KC4Ly/PlvZ9KkSZw8eZIPPviA/fv32476Fi9eTJMmTfj000/Jzs7m4Ycfpn379vTv35+1a9fi7e3NN998Q/v27WnUqBFTp07l9ddfp2XLlnz11Ve89NJLrFixAoB27dqxZMkS2/affvppXFxcOH36NM2bN2f48OEEBARw9uxZPv/8c1auXEn9+vVZuHAhq1at4qWXXiIuLo6xY8fSrl072/ts3LiRDRs2EBcXh6urK+PGjePDDz9k2LBhl913wwVB/fr1r2qZwsJC3nvvPVsyWywWmjVrRnp6um0Zk8nEn5/mnZeXd9ntubm5lVqvU6dOrF69ulQd3333XYnun+J1/xwO5fnztgBbuJVXb1m6d++OxWJh/fr1tGrVCi8vryvaflWrbSGenp7OyZMn6dmzJ66urnTo0IHExESeeOIJ7r//fmbOnMlXX31Fnz596N27N7///juHDx9m1KhR+Pr68uKLL17xfpb1fpVRUVsEBwezZ88eVqxYwaFDh/j11185f/489957L+PGjSM9PZ3777+f4cOH4+LigpubG0OGDKF3795ERETg5ubGli1buHDhAnFxcQCcP3+eAwcO0LBhQ9t2yno/e/35bweKjuxMJhNt27bl119/BeCbb76xnZto2rQpDz74INu3bycoKIhHH32UF198kU8//ZR+/fpx5MgRjh49SlhYmO09z549a/u5U6dOJbZf3DW0bt06Zs2ahb+/PyaTCQ8PD+bNm8fatWs5cuQIX331FR06dLjsfnzzzTcEBQXRoEEDoOiLXGJiYrlBoMtHK9CjRw8++OADoKjPNSQkhNzcXFxcXMjPzwegSZMmHDx4EKvVytGjR9m3b99VbSMwMJDc3FzeeOMN2wf05s2biY+PL9HlcLV69epFQkICAD/88AOHDx++4npdXFxsH3Amk4kBAwbw8ssvV8lJaXvZG+JJSUkkJSWxZs0a2rZtW2L5qgjx3bt3l6rjSkI8Li6OS5cu4efnR58+fTh8+DAffvghAP7+/iQkJNCpUydWrFhBdHQ0TZo0Ye3atQwfPpzDhw8zcOBAfv/99yvaz7LerzIqaouVK1cyZ84cmjZtyvDhw7n11luxWq3cfffdrF27ll69epGSksKYMWOoW7cuH330ERMmTODXX39lyJAhHD58mMLCQl599dUS+1UcqMXKer/y2NPef26z/x6+xWq1UlBQgNlspk2bNmzbto2tW7fy4IMPUlhYSKtWrWz1x8fH2z5Lyvsd+vn5cd999xEVFQXAiRMnePTRR8nJycHX15eBAweWquPPCgsLS80r/qy6HAVBBaZOncr3339PSEgIEydOZM6cOXh4eNCpUye+//575s6dS8+ePWnRogX+/v7ExMRw9913X9U26tWrx3vvvceRI0fw9/fH39+fd999l3/+85/ceuutFa6/aNEi+vfvX+K/n3/+mTFjxpCdnU1ISAjLli2zHdVcSb09e/bk9ddfJzU1FYCgoCByc3Pp27fvVe2bI9XkEL906RLJycmsWLGCDRs2sGHDBr744guysrLYtm0b4eHhpKWlMWTIECZMmMCPP/7IF198QWRkJA888ABTp07F3d2dEydOXNF+lvV+19LXX3/No48+Sr9+/bh48SI//fQThYWFzJkzh08++YSBAwcybdo0fvzxR3788UeGDx9O9+7d+fvf/86tt97K4cOH6dGjh+1I2WKx0K9fP06cOFFiv8p6v/I0adKEn3/+GSi6qiorK+uq9qtHjx58/PHHQNGJ/i+++MJ2dV3//v2ZPXs2Pj4+NGjQgFtuuYXffvuNnTt3AkXBHxERcUXbmTBhArt27eLLL78kLS2N1q1b88QTT9CxY0c+//xz25e0P39h+3ONa9eu5cKFC+Tn5xMXF0ePHj3K3Z6huoZ8fHwqvHogNDS0xLdeLy8v3njjjVLLtWnThn/961+26eI+37K2Waz4BFWxDRs22H5u0qQJsbGxl63rz8v+eT+KT3Jezquvvmr7uU+fPkBR8FRUb1BQEEFBQUDRN4yvvvqK/v37U69evXK3V5NMnTqVadOmERISAlAixJcsWcLcuXMZP348cXFx+Pv706ZNG7tDfM6cObZD+ZYtW1YY4hs2bOCGG27grrvuss3z8PDg4Ycf5sMPP2TMmDFMmTKFpUuX4urqyvTp0+nQoQPr168nKCgINzc3+vXrR7t27a5oP8t6v2vp8ccfZ/r06bz55pt4eHjQpUsXjh07xmOPPcYLL7xgu89l9uzZ3HHHHXTu3Jng4GAaNGhA165d8fX15Z577mH69OkEBwdTUFBAZGQkN910E40aNSInJ4fIyEief/75Uu9XnsDAQNatW0dgYCB33nnnFV/iW+y5555j+vTphISEUFBQwJgxY7jzzjsBeOihh4iOjrZ92NerV4+FCxcSExPDxYsX8fDwqLC+Ys2aNWP06NHMmTOHjz76iNWrVxMYGIjVaqV79+62Cwbuu+8+oqOjS7xv7969SU9PZ9CgQeTn59OrV68Ku8wMOVRlSkpKmR/uAElJSdVcTfUpvkKi+BK1K/Xss89y4sQJ3nnnHZo2bXqNqhMRRzFkEIjzMmqI10Rqi9pDQSAiYnA6WSwiYnAKAhERg1MQiIgYnIJARMTgFAQiIgb3/8ccOMmzwSFXAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">isbs_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">isbs_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="IncomeStatement-/-CashFlow">IncomeStatement / CashFlow<a class="anchor-link" href="#IncomeStatement-/-CashFlow"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iscf_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_dividendPayoutRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_stockRepurchaseRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_operatingCashFlowRatio&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Dividend Payout Ratio = DividendsPaid / NetIncome</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_dividendPayoutRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span>

<span class="c1"># StockRepurchaseRatio = PaymentsForStockRepurchase / NetIncome </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_stockRepurchaseRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsForRepurchaseOfStockTotal</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_NetIncomeLoss</span>

<span class="c1"># Operating Cash Flow Ratio = CashFromOperations / Revenue</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_operatingCashFlowRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_c_CashFromOperating</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">c_Revenues</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">iscf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">iscf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_dividendPayoutRatio   2
inf:  r_stockRepurchaseRatio   3
inf:  r_operatingCashFlowRatio   3526
null:  r_dividendPayoutRatio   3
null:  r_stockRepurchaseRatio   2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df[&#39;r_dividendPayoutRatio&#39;] = df.c_PaymentsOfDividendsTotal / df.c_NetIncomeLoss</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_dividendPayoutRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_dividendPayoutRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># df[&#39;r_stockRepurchaseRatio&#39;] = df.c_PaymentsForRepurchaseOfStockTotal / df.c_NetIncomeLoss</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">r_stockRepurchaseRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsForRepurchaseOfStockTotal</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;r_stockRepurchaseRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_dividendPayoutRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_stockRepurchaseRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_operatingCashFlowRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">iscf_ratio_cols</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">iscf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">iscf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BalanceSheet-/-CashFlow">BalanceSheet / CashFlow<a class="anchor-link" href="#BalanceSheet-/-CashFlow"> </a></h3><h4 id="calculate">calculate<a class="anchor-link" href="#calculate"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bscf_ratio_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_assetEfficiencyRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_currentLiabCoverageRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_longtermDeptCoverageRatio&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># AssetEfficiencyRatio = CashFromOperations / Assets</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_assetEfficiencyRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">c_CashFromOperating</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">Assets</span> 

<span class="c1"># CurrentLiabilityCoverageRatio = (CashFromOperations - DividendsPaid) / CurrentLiabilities</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_currentLiabCoverageRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_CashFromOperating</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesCurrent</span>  

<span class="c1"># LongTermDebtCoverageRatio = (CashFromOperations - DividendsPaid) / NonCurrentLiabilities</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;r_longtermDeptCoverageRatio&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_CashFromOperating</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesNoncurrent</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bscf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bscf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>inf:  r_assetEfficiencyRatio   4
inf:  r_currentLiabCoverageRatio   6
inf:  r_longtermDeptCoverageRatio   39262
null:  r_longtermDeptCoverageRatio   23
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">r_longtermDeptCoverageRatio</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">LiabilitiesNoncurrent</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="s1">&#39;r_longtermDeptCoverageRatio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_longtermDeptCoverageRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_currentLiabCoverageRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;r_assetEfficiencyRatio&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">r_longtermDeptCoverageRatio</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;r_currentLiabCoverageRatio&#39;</span><span class="p">,</span><span class="s1">&#39;r_assetEfficiencyRatio&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># final check for null/nan and inf values</span>
<span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bscf_ratio_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bscf_ratio_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_01_features_ratios.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_01_features_ratios.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;07_01_features_ratios.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/07_01_features_ratios.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="04_Increase/Decrease-Features---&quot;Change-Ratios&quot;">04_Increase/Decrease Features - "Change Ratios"<a class="anchor-link" href="#04_Increase/Decrease-Features---&quot;Change-Ratios&quot;"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The growthrate of an attribute is defined by <br>
(newValue - lastValue) / lastValue</p>
<p>For instance: lastYearsRevenue = 10 Mio, thisYearRevenue = 20 Mio =&gt; (20 - 10) / 10 = 2</p>
<p>But we have distinguish if "lastValue" was negativ.<p>
For instance: lastYearsRevenue = -10 Mio, thisYearRevenue = -20 Mio =&gt; (-20 - -10) / -10 =&gt; (-20 + 10) / -10 = 2<br>
Would also equals to 2.0, as in the example with 20Mio and 10Mio</p>
<p><p>
Therefore, for every "growthrate"-feature two features will be created. The first one ends with "_p" and contains the value when the "lastValue" was &gt; 0 and the second names with "_n" and contains the results when "lastValue" was &lt; 0.</p>
<p>This is done based on the Quater, so Q1 data are compared with the last Q1, Q2 with the last Q2, Q3 with the last Q3 and FY with the last FY.</p>
<p>Growth-Rates for the following positions will be calculated:
<br>
<strong>BalanceSheet GrowthRatios for</strong></p>
<ul>
<li>AssetsCurrent</li>
<li>AssetsNoncurrent</li>
<li>LiabilitiesCurrent</li>
<li>LiabilitiesNoncurrent</li>
<li>c_Equity</li>
<li>c_RetainedEarnings</li>
</ul>
<p><strong>IncomeStatement GrowthRatios for</strong></p>
<ul>
<li>c_Revenues</li>
<li>GrossProfit</li>
<li>c_OperatingIncomeLoss</li>
<li>c_NetIncomeLoss</li>
</ul>
<p><strong>CashflowStatement GrowthRatios for</strong></p>
<ul>
<li>c_CashFromInvesting</li>
<li>c_CashFromFinancing</li>
<li>c_CashFromOperating</li>
<li>c_PaymentsOfDividendsTotal</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calculate_growth</span><span class="p">(</span><span class="n">all_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">grouped_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">data_cols</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">new_cols_prefix</span><span class="p">:</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    
    <span class="k">for</span> <span class="n">data_col</span><span class="p">,</span> <span class="n">new_col_prefix</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data_cols</span><span class="p">,</span> <span class="n">new_cols_prefix</span><span class="p">):</span>
        <span class="n">col_name_p</span> <span class="o">=</span> <span class="n">new_col_prefix</span> <span class="o">+</span> <span class="s2">&quot;_p&quot;</span>
        <span class="n">col_name_n</span> <span class="o">=</span> <span class="n">new_col_prefix</span> <span class="o">+</span> <span class="s2">&quot;_n&quot;</span>
        
        <span class="n">all_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_name_p</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">all_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_name_n</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    
        <span class="n">is_positiv_arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped_df</span><span class="p">[</span><span class="n">data_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">is_negativ_arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped_df</span><span class="p">[</span><span class="n">data_col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">data_arr</span> <span class="o">=</span> <span class="n">all_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        
        <span class="n">change_arr</span> <span class="o">=</span> <span class="p">((</span><span class="n">data_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">data_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">data_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">all_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">col_name_p</span><span class="p">]</span> <span class="o">=</span>  <span class="n">is_positiv_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">change_arr</span>
        <span class="n">all_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">col_name_n</span><span class="p">]</span> <span class="o">=</span>  <span class="n">is_negativ_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">change_arr</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">list_data_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span> <span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;c_RetainedEarnings&#39;</span><span class="p">,</span> <span class="s1">&#39;c_Equity&#39;</span><span class="p">]</span>
<span class="n">list_new_cols</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gr_revenue&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_grosspr&#39;</span> <span class="p">,</span> <span class="s1">&#39;gr_opiincome&#39;</span><span class="p">,</span>          <span class="s1">&#39;gr_netincome&#39;</span><span class="p">,</span>    <span class="s1">&#39;gr_earnings&#39;</span><span class="p">,</span>        <span class="s1">&#39;gr_equity&#39;</span><span class="p">]</span>

<span class="n">list_data_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">])</span>
<span class="n">list_new_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;gr_asscur&#39;</span><span class="p">,</span>     <span class="s1">&#39;gr_assnoncur&#39;</span><span class="p">,</span>     <span class="s1">&#39;gr_liabcur&#39;</span><span class="p">,</span>         <span class="s1">&#39;gr_liabnoncur&#39;</span>        <span class="p">])</span>

<span class="n">list_data_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;c_CashFromInvesting&#39;</span><span class="p">,</span> <span class="s1">&#39;c_CashFromFinancing&#39;</span><span class="p">,</span> <span class="s1">&#39;c_CashFromOperating&#39;</span><span class="p">,</span> <span class="s1">&#39;c_PaymentsOfDividendsTotal&#39;</span><span class="p">])</span>
<span class="n">list_new_cols</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;gr_cashfrominv&#39;</span><span class="p">,</span>      <span class="s1">&#39;gr_cashfromfin&#39;</span><span class="p">,</span>      <span class="s1">&#39;gr_cashfromope&#39;</span><span class="p">,</span>      <span class="s1">&#39;gr_dividends&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># multiprocessing is not really working in jupyter on windows</span>
<span class="c1"># therfore there ist the 07_features_growth.py skript, which which enables multiprocessing</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span> <span class="s1">&#39;fp&#39;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">calculate_growth</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">list_data_cols</span><span class="p">,</span> <span class="n">list_new_cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;duration: &quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save-raw">Save raw<a class="anchor-link" href="#Save-raw"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_02_features_growth_raw.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_02_features_growth_raw.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;07_02_features_growth_raw.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="05_Correct_ChangeRatios">05_Correct_ChangeRatios<a class="anchor-link" href="#05_Correct_ChangeRatios"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_02_features_growth.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gr_cols</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;gr_&quot;</span> <span class="ow">in</span> <span class="n">x</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gr_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gr_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>null:  gr_revenue_n   3101
null:  gr_revenue_p   3101
null:  gr_grosspr_n   1113
null:  gr_grosspr_p   1113
null:  gr_opiincome_n   4
null:  gr_opiincome_p   4
null:  gr_netincome_n   5
null:  gr_netincome_p   5
null:  gr_earnings_n   5756
null:  gr_earnings_p   5756
null:  gr_equity_n   5
null:  gr_equity_p   5
null:  gr_assnoncur_n   19000
null:  gr_assnoncur_p   19000
null:  gr_liabcur_n   2
null:  gr_liabcur_p   2
null:  gr_liabnoncur_n   34550
null:  gr_liabnoncur_p   34550
null:  gr_cashfrominv_n   1123
null:  gr_cashfrominv_p   1123
null:  gr_cashfromfin_n   1447
null:  gr_cashfromfin_p   1447
null:  gr_cashfromope_n   3
null:  gr_cashfromope_p   3
null:  gr_dividends_n   40551
null:  gr_dividends_p   40551
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">base_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">gr_col_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">0.0</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">0.0</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span>  <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">1.0</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span>  <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">0.0</span> 
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span>  <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="mf">0.0</span>     
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">base_col</span><span class="p">]</span>  <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">gr_col_prefix</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BalanceSheet-GrowthRatios">BalanceSheet GrowthRatios<a class="anchor-link" href="#BalanceSheet-GrowthRatios"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_gr_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gr_asscur_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_assnoncur_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_liabcur_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_liabnoncur_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_earnings_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_equity_n&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gr_asscur_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_assnoncur_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_liabcur-p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_liabnoncur_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_earnings_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_equity_p&#39;</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">gr_assnoncur_n</span>  <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># no &quot;negative&quot; assets  are possible</span>
<span class="n">df</span><span class="o">.</span><span class="n">gr_asscur_n</span>     <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># no &quot;negative&quot; assets  are possible</span>
<span class="n">df</span><span class="o">.</span><span class="n">gr_liabcur_n</span>    <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># no &quot;negative&quot; values for liabilities  are possible</span>
<span class="n">df</span><span class="o">.</span><span class="n">gr_liabnoncur_n</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># no &quot;negative&quot; values liabilities  are possible</span>


<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span>         <span class="s1">&#39;gr_asscur&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span>      <span class="s1">&#39;gr_assnoncur&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span>    <span class="s1">&#39;gr_liabcur&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_liabnoncur&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_RetainedEarnings&#39;</span><span class="p">,</span>    <span class="s1">&#39;gr_earnings&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_Equity&#39;</span><span class="p">,</span>              <span class="s1">&#39;gr_equity&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_asscur_p&#39;</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_assnoncur_p&#39;</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_liabcur_p&#39;</span><span class="p">,</span>    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_liabnoncur_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_earnings_p&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_earnings_n&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_equity_p&#39;</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_equity_n&#39;</span><span class="p">,</span>     <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Income-Statement-GrowthRatios">Income Statement GrowthRatios<a class="anchor-link" href="#Income-Statement-GrowthRatios"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_gr_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gr_revenue_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_grosspr_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_opiincome_n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_netincome_n&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gr_revenue_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_grosspr_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_opiincome_p&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_netincome_p&#39;</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span>            <span class="s1">&#39;gr_revenue&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;GrossProfit&#39;</span><span class="p">,</span>           <span class="s1">&#39;gr_grosspr&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_OperatingIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_opiincome&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_NetIncomeLoss&#39;</span><span class="p">,</span>       <span class="s1">&#39;gr_netincome&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_revenue_p&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_revenue_n&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_grosspr_n&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_grosspr_p&#39;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_opiincome_n&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_opiincome_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_netincome_n&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_netincome_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CashflowStatement-GrowthRatios">CashflowStatement GrowthRatios<a class="anchor-link" href="#CashflowStatement-GrowthRatios"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_gr_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gr_cashfrominv_p&#39;</span><span class="p">,</span><span class="s1">&#39;gr_cashfromfin_p&#39;</span><span class="p">,</span><span class="s1">&#39;gr_cashfromope_p&#39;</span><span class="p">,</span><span class="s1">&#39;gr_dividends_p&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gr_cashfrominv_n&#39;</span><span class="p">,</span><span class="s1">&#39;gr_cashfromfin_n&#39;</span><span class="p">,</span><span class="s1">&#39;gr_cashfromope_n&#39;</span><span class="p">,</span><span class="s1">&#39;gr_dividends_n&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-null/na">correct null/na<a class="anchor-link" href="#correct-null/na"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">gr_dividends_n</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># no &quot;negativ&quot; previous value are possible</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">gr_dividends_p</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="s1">&#39;gr_dividends_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># we give some credit that a dividend was payed compared to the prior period. </span>
<span class="c1"># however the real value would be infinite which doesn&#39; make sense, so we reduce that to 100%</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">gr_dividends_p</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="s1">&#39;gr_dividends_p&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.0</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_CashFromInvesting&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_cashfrominv&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_CashFromFinancing&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromfin&#39;</span><span class="p">)</span>
<span class="n">correct_null_gr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;c_CashFromOperating&#39;</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromope&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="correct-range">correct range<a class="anchor-link" href="#correct-range"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_dividends_p&#39;</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfrominv_n&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfrominv_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromfin_n&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromfin_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromope_n&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">cap_ratios</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;gr_cashfromope_p&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_inf_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gr_cols</span><span class="p">)</span>
<span class="n">print_null_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gr_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="save">save<a class="anchor-link" href="#save"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_03_features_growth.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_03_features_growth.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;07_03_features_growth.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="06_Financial-Period-one-hot-encoding">06_Financial Period one-hot-encoding<a class="anchor-link" href="#06_Financial-Period-one-hot-encoding"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="add-one-hot_encoding-for-financial-period">add one hot_encoding for financial period<a class="anchor-link" href="#add-one-hot_encoding-for-financial-period"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_03_features_growth.csv&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;fp_&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(95395, 84)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="save">save<a class="anchor-link" href="#save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_04_features_fp.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make copy to directory under git control</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">all_features_folder</span> <span class="o">+</span> <span class="s2">&quot;07_04_features_fp.csv&quot;</span><span class="p">,</span> <span class="n">all_data_local_folder</span> <span class="o">+</span> <span class="s2">&quot;07_04_features_fp.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./data/07_04_features_fp.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XX_Trials">XX_Trials<a class="anchor-link" href="#XX_Trials"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_raw</span><span class="o">.</span><span class="n">c_PaymentsOfDividendsTotal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/d3fzzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAmEUlEQVR4nO3deVxU973/8dewKqIIZEYgpsnjEeuSS4xajdZLyY1RAUWpqL0qVVOVuIaQW22s+nOtJlcNkrpFo2m8jY0lEReswaVJ48NqjFk0mtgsV00VFJDFAIIMM+f3B9dpCC7AgAOZ9/PxyEO/53vOzOcQmfec71m+JsMwDERExG15uLoAERFxLQWBiIibUxCIiLg5BYGIiJtTEIiIuDkFgYiIm2vWQVBSUkJsbCwXL16s1fq/+c1vSE9Pd7Szs7NJSEggOjqaqVOnUlpa2liliog0Wc02CE6ePMno0aM5f/78HdfNyclhypQp7Nu3r9ryRYsWMWbMGDIzMwkPD2fdunWNVK2ISNPVbIMgLS2NBQsWYLFYHMt27tzJsGHDiIuLY86cOVy/fh2AjIwMnnjiCWJiYhzrWq1Wjh8/TlRUFADx8fFkZmbe3Z0QEWkCmm0QLF26lJ49ezraX331FWlpaWzbto1du3YRHBzM5s2bAZg0aRIjR46stn1hYSH+/v54eXkBYDabycnJuXs7ICLSRHi5uoCGcuzYMb755ht+8YtfAFXf+B966KFbrm8YBiaTqdqy77dFRNzBDyYIbDYbMTExzJs3D4DS0lJsNtst1w8KCqK4uBibzYanpyd5eXnVhplERNxFsx0a+r7evXtz4MAB8vPzMQyDhQsXsmXLlluu7+3tTc+ePdm7dy9QdX4hMjLybpUrItJk/GCCoHPnzsyYMYPx48czePBg7HY7Tz311G23WbBgAWlpaQwaNIgPP/yQ5OTku1OsiEgTYtJjqEVE3NsP5ohARETqR0EgIuLmFAQiIm6u2V4+WlhYit2u0xvStAQH+5OfX+LqMkSq8fAwERjY6pb9zTYI7HZDQSBNkv5dSnOjoSERETenIBARcXMKAhERN6cgEBFxcwoCkQaQnv4mkZG98fT0JDKyN+npb7q6JJFaczoIbjdd5Jo1a3j88ceJi4sjLi6OrVu3ApoiUn5Y0tPfZNmyJSxbtoLy8nKWLVvBsmVLFAbSbDgVBHeaLvL06dOkpKSwa9cudu3aRUJCAqApIuWHJTV1Jampa4iIiMTb25uIiEhSU9eQmrrS1aWJ1IpTQXCz6SK/6/Tp02zYsIEhQ4awePFirl+/riki5Qfnyy+/4NKlrGpDQ5cuZfHll1+4ujSRWnHqhrKlS5fesq+0tJQuXbowa9Ys7r//fmbPns26detISEhokCkig4P96123SEMKCwtjyZIF/OlPfyIiIoLDhw8zZswYwsLCMJtbu7o8kTtqtDuLW7VqxSuvvOJoT5gwgTlz5jBmzJgGmSIyP79Ed3BKk2C32zEMg6KiawAUFV3DMAzsdjt5ecUurk6k6hETt/vy3GhXDWVnZ/PWW2852oZh4OXlVW2KSEBTREqzd/nyZebPX8KcObNo0aIFc+bMYv78JVy+fNnVpYnUSqMFQYsWLVixYgUXLlzAMAy2bt3KgAEDNEWk/OB07NiJ0NAwDh06hs1m49ChY4SGhtGxYydXlyZSKw0eBImJiZw6dYqgoCAWL17M1KlTiY6OxjAMfvWrXwGaIlJ+WJKTZ5KcPIPDhw9htVo5fPgQyckzSE6e6erSRGql2U5VqXME0pSkp79JaupKvvzyCzp27ERy8kzi40e6uiwR4M7nCBQEIg3IbG6tE8TS5LjsZLGIO9EjJqQ5a7YT04g0FenpbzJv3nO0bOmHYRiUlpYyb95zABoekmZBRwQiTlq8+P/h4eHJSy+t4/r167z00jo8PDxZvPj/ubo0kVpREIg4KTs7mzVrNlR71tCaNRvIzs52dWkitaIgEGkAf//7oWrnCP7+90OuLkmk1nTVkIiTOnb8EVevXuWee8zk5eViNlu4ciWPgIAAvvzyn64uT0RXDYk0vqpnZZlM4OHhwb8enVX3Z2iJuIKCQMRJRUWFPP30swQFBQMQFBTM008/S1FRoYsrE6kdBYFIA4iIiKz2rKGICD0/S5oPBYGIk8LCwnj66cnVnjX09NOTCQsLc3VpIrWiIBBx0vz5S6istPHMM9No0aIFzzwzjcpKG/PnL3F1aSK1oiAQcVJ8/Eh+/vN4cnJysNvt5OTk8POfx+uuYmk2FAQiTkpPf5MDB/azbdt2Kioq2LZtOwcO7NfzhqTZ0H0EIk6KjOzNsmUriIiIdDx99PDhQ8yZM4tDh465ujwRPYZapLGFhLTlwoU8vL29HUFgtVq57z4zly8Xubo8Ed1QJtLYOnbsxLFjR6stO3bsqKaqlGZDj6EWcVJy8kyeeupJWrb04+LFC7Rvfx9lZdf43e/+29WlidSKgkCkAZSXX6eo6CqGYXDp0iVatGjh6pJEas3poaGSkhJiY2O5ePFijb6DBw8SFxfH0KFDmTZtGlevXgVgx44dREREEBcXR1xcHKtWrXK2DBGXqZqPwIPQ0FBMJhOhoaF4eHhoPgJpNpwKgpMnTzJ69GjOnz9fo6+kpISFCxeyceNGdu/eTadOnVi9ejUAp0+fZvbs2ezatYtdu3bx7LPPOlOGiEtlZ2fj69ui2sQ0vr4tNB+BNBtOBUFaWhoLFizAYrHU6LNarSxYsIB27doB0KlTJy5dugTAqVOn2LFjB0OGDGHmzJmOIwWR5mrq1BnVJqaZOnWGq0sSqTWngmDp0qX07Nnzpn2BgYEMGDAAgPLycjZu3Ej//v0BMJvNTJs2jd27dxMaGsrixYudKUPE5VJTV/CTn4Tj6enJT34STmrqCleXJFJrjX6yuLi4mOnTp9O5c2eGDRsGwNq1ax39kyZNcgRGXdzumliRuykoKIjCwkJKS0ux2+1kZ2dht9sJCgrCbG7t6vJE7qhRgyA3N5eJEyfSp08f5syZA1QFw/bt23nyyScBMAwDT0/POr+2biiTpsJuNzAMCA4O5sqVKwQHB5Obm4fdbpCXV+zq8kRcd0OZzWZjypQpxMTEMHfuXEz/N22Tn58fmzZt4uTJkwC8/vrr9ToiEGkqiooKSUqqPjFNUpImppHmo8GPCBITE0lKSuLy5ct8/vnn2Gw29u3bB0B4eDhLly4lNTWVhQsXUl5ezgMPPMDy5csbugyRuyoiIpJ58xY6HjHxt7+9w+9/n+LqskRqRc8aEnFSt26dsdlsrF+/mdjYgezZs5+pUyfi6enJiRP/cHV5InccGtKdxSJOmj9/CcnJ04mPj3Usa9GiBampa2+zlUjToYfOiTjp+PFjVFRUYDZbMJlMmM0WKioqOH5cj6CW5kFBIOKkP/5xCwsW/I7PPvsau93OZ599zYIFv+OPf9zi6tJEakXnCEScZLG04fz5y/j5+TlOFl+7do0HHgghN/dbV5cnovkIRBqbj48vW7a8Wm3Zli2v4uPj66KKROpGQSDipLFjx7N48XzWr1/DtWvXWL9+DYsXz2fs2PGuLk2kVjQ0JNIAfvGLn/Pee+9iGAYmk4nHHnuctLSdri5LBNDQkEijS09/k9OnP6V9+/swmUy0b38fp09/Snr6m64uTaRWdEQg4qRu3TpTUlJCQEBbsrIucu+97bl6tQh/f3/dUCZNgo4IRBpZdnY2N75O3fheZRhoYhppNhQEIg3A09Oz2gxl9XmiroirKAhERNyczhGIOMliaUPr1m1o2/Zf5wiKioooLv5WN5RJk6BzBCKNLCwsjMrKSi5duoTdbufSpUtUVlYSFhbm6tJEakVBIOKkmJhYysrKMAw7AIZhp6ysjJiY2DtsKdI0KAhEnPT223to2bIlJlPVr5PJ5EHLli15++09Lq5MpHYUBCJOys7Oxtvbi9DQUEwmE6GhoXh7e+nyUWk2FAQiDcBk8qh2+eiNowOR5kBXDYk4yWJpg59fK4KDg7l48QLt299Hfn4+166V6qohaRI0VaXIXVBWdo2srHIMwyArK8tx4likOXD6+LWkpITY2FguXrxYo+/MmTPEx8cTFRXF3LlzqaysBKrGVBMSEoiOjmbq1KmUlpY6W4aIy3h4ePzfU0er2iZT1aMmPDw0PCTNg1P/Uk+ePMno0aM5f/78TftnzZrF/Pnz2bdvH4ZhkJaWBsCiRYsYM2YMmZmZhIeHs27dOmfKEHEpu/3m3/5vtVykqXEqCNLS0liwYAEWi6VGX1ZWFuXl5XTr1g2A+Ph4MjMzsVqtHD9+nKioqGrLRZozLy8vbDYbADabDS8vjbpK8+HUv9alS5fesi83Nxez2exom81mcnJyKCwsxN/f3/GLcmO5SHNWWVmJyeSBYdgxmTwcw6AizUGjfW2x2+2YbgyagmPmpht/ftf327VxuzPgIq7Qtm0AV69eJSAggMLCQgDM5tYurkrkzhotCEJCQsjLy3O0r1y5gsViISgoiOLiYmw2G56enuTl5d10aOlOdPmoNCU+Pr74+7emqKgIf//WlJZeo6LiOnl5xa4uTcR1D52799578fX15aOPPgJg165dREZG4u3tTc+ePdm7dy8AO3fuJDIysrHKELlLDC5duoRhVP0J+pIizUeDB0FiYiKnTp0CYOXKlTz//PNER0dz7do1xo0bB8CCBQtIS0tj0KBBfPjhhyQnJzd0GSJ3jclkoqKigspKKwCVlVYqKirqNeQp4gq6s1jESe3aBXCzXyOTyUROzlUXVCRSneYjEGlkhmHg69ui2jJf3xY3DQeRpkhBINIArNYKFi1aRmlpKYsWLcNqrXB1SSK1pqEhESdZLG0wmUx4enpRWWnFy8sbm60SwzD00DlpEvTQOZG7wDCMaieLRZoTDQ2JiLg5BYGIiJtTEIiIuDkFgUgDefLJiRQVFfHkkxNdXYpIneiqIREnWSxtbtmnq4akKdANZSIiclsKApEGcuPZQnrGkDQ3CgKRBnJjlLWZjraKG1MQiDQAb29vvLy8AfDy8sbb29vFFYnUnu4sFmkAVuu/7ibWncXS3OiIQETEzSkIRETcnIJApIG0bdsWk8lE27ZtXV2KSJ3oHIFIAykqKqr2p0hzoSMCERE3pyAQEXFzTg0NZWRksH79eiorKxk/fjwJCQmOvjNnzjB79mxHu6CggICAAPbs2cOOHTt48cUXCQ4OBuA//uM/ePbZZ50pRURE6qneQZCTk8OqVatIT0/Hx8eHUaNG0bt3bzp06ABAly5d2LVrFwBlZWWMHDmShQsXAnD69Glmz55NbGys83sgIiJOqffQ0JEjR+jTpw9t27bFz8+PqKgoMjMzb7ruhg0b6NWrFz179gTg1KlT7NixgyFDhjBz5kyuXr1a3zJERMRJ9Q6C3NxczGazo22xWMjJyamxXnFxMWlpacyYMcOxzGw2M23aNHbv3k1oaCiLFy+ubxkiIuKkeg8N2e32ak9ZNAzjpk9d3L17N/3793ecDwBYu3at4++TJk1iwIABdX7/2z1bW6SpMJtbu7oEkTuqdxCEhITw4YcfOtp5eXlYLJYa6x08eJDJkyc72sXFxWzfvp0nn3wSqAoQT0/POr+/JqaR5iAvr9jVJYg03sQ0ffv25ejRoxQUFFBWVsb+/fuJjIysto5hGHz22Wd0797dsczPz49NmzZx8uRJAF5//fV6HRGIiEjDqPcRQbt27Xj22WcZN24cVquVESNG0LVrVxITE0lKSuLhhx+moKAAb29vfH19Hdt5enqSmprKwoULKS8v54EHHmD58uUNsjMiIlJ3mrNYxEmas1iaOs1ZLCIit6UgEBFxcwoCERE3pyAQEXFzCgIRETenIBARcXMKAhERN6cgEBFxcwoCERE3pyAQEXFzCgIRETenIBARcXMKAhERN6cgEBFxcwoCERE3pyAQEXFzCgIRETenIBARcXMKAhERN6cgEBFxc04FQUZGBoMGDWLgwIFs3bq1Rv+aNWt4/PHHiYuLIy4uzrFOdnY2CQkJREdHM3XqVEpLS50pQ0REnOBV3w1zcnJYtWoV6enp+Pj4MGrUKHr37k2HDh0c65w+fZqUlBS6d+9ebdtFixYxZswYBg8ezNq1a1m3bh2zZs2q/16IiEi91fuI4MiRI/Tp04e2bdvi5+dHVFQUmZmZ1dY5ffo0GzZsYMiQISxevJjr169jtVo5fvw4UVFRAMTHx9fYTkRE7p56HxHk5uZiNpsdbYvFwqeffupol5aW0qVLF2bNmsX999/P7NmzWbduHQkJCfj7++PlVfXWZrOZnJycOr9/cLB/fUsXuWvM5tauLkHkjuodBHa7HZPJ5GgbhlGt3apVK1555RVHe8KECcyZM4cxY8ZUWw+o0a6N/PwS7HajHpWL3D15ecWuLkEEDw/Tbb8813toKCQkhLy8PEc7Ly8Pi8XiaGdnZ/PWW2852oZh4OXlRVBQEMXFxdhstptuJyIid1e9g6Bv374cPXqUgoICysrK2L9/P5GRkY7+Fi1asGLFCi5cuIBhGGzdupUBAwbg7e1Nz5492bt3LwA7d+6stp2IiNxdJsMw6j2+kpGRwYYNG7BarYwYMYLExEQSExNJSkri4YcfZt++faxevRqr1UqPHj1YtGgRPj4+ZGVlMXv2bPLz8wkNDSUlJYWAgIA6vbeGhqSpsFja3LIvN/fbu1iJyM3daWjIqSBwJQWBNBUKAmnqGu0cgYiI/DAoCERE3JyCQETEzSkIRETcnIJARMTNKQhERNycgkBExM0pCERE3JyCQETEzSkIRETcnIJARMTNKQhERNycgkBExM0pCERE3JyCQETEzSkIRETcnIJARMTNKQhERNycgkBExM0pCERE3JxTQZCRkcGgQYMYOHAgW7durdF/8OBB4uLiGDp0KNOmTePq1asA7Nixg4iICOLi4oiLi2PVqlXOlCEiIk4wGYZh1GfDnJwcRo8eTXp6Oj4+PowaNYqUlBQ6dOgAQElJCdHR0Wzfvp127drx0ksvUVxczLx581iyZAndu3cnNja23oXn55dgt9erdJEGZbG0uWVfbu63d7ESkZvz8DARHOx/6/76vvCRI0fo06cPbdu2xc/Pj6ioKDIzMx39VquVBQsW0K5dOwA6derEpUuXADh16hQ7duxgyJAhzJw503GkICIid59XfTfMzc3FbDY72haLhU8//dTRDgwMZMCAAQCUl5ezceNGxo4dC4DZbGbChAn06NGDlJQUFi9ezIsvvlin979duok0FWZza1eXIHJH9Q4Cu92OyWRytA3DqNa+obi4mOnTp9O5c2eGDRsGwNq1ax39kyZNcgRGXWhoSJqDvLxiV5cg0nhDQyEhIeTl5TnaeXl5WCyWauvk5uYyZswYOnXqxNKlS4GqYHjttdcc6xiGgaenZ33LEBERJ9U7CPr27cvRo0cpKCigrKyM/fv3ExkZ6ei32WxMmTKFmJgY5s6d6zha8PPzY9OmTZw8eRKA119/vV5HBCIi0jDqPTTUrl07nn32WcaNG4fVamXEiBF07dqVxMREkpKSuHz5Mp9//jk2m419+/YBEB4eztKlS0lNTWXhwoWUl5fzwAMPsHz58gbbIRERqZt6Xz7qajpHIE2FLh+Vpq7RzhGIiMgPg4JARMTNKQhERNycgkBExM0pCERE3JyCQETEzSkIRETcnIJARMTNKQhERNycgkBExM0pCERE3JyCQETEzSkIRETcnIJARMTNKQhERNycgkBExM0pCERE3JyCQETEzSkIRETcnFNBkJGRwaBBgxg4cCBbt26t0X/mzBni4+OJiopi7ty5VFZWApCdnU1CQgLR0dFMnTqV0tJSZ8oQEREn1DsIcnJyWLVqFX/605/YuXMnf/7zn/n666+rrTNr1izmz5/Pvn37MAyDtLQ0ABYtWsSYMWPIzMwkPDycdevWObcXIiJSb/UOgiNHjtCnTx/atm2Ln58fUVFRZGZmOvqzsrIoLy+nW7duAMTHx5OZmYnVauX48eNERUVVWy4iIq7hVd8Nc3NzMZvNjrbFYuHTTz+9Zb/ZbCYnJ4fCwkL8/f3x8vKqtlykqRk+fAj/+79fOfUa3bp1vuM6Dz74Y7Zvz3DqfUScUe8gsNvtmEwmR9swjGrtW/V/fz2gRrs2goP961G1uLMRf5iFh19JrdcPmd6FELo0YkX/Mv2d39R6Xfs1f9761YpGrEbcTb2DICQkhA8//NDRzsvLw2KxVOvPy8tztK9cuYLFYiEoKIji4mJsNhuenp41tqut/PwS7HajvuWLG1ofO79RXtdiaXPLvtzcbxvlPfPyihvldeWHycPDdNsvz/U+R9C3b1+OHj1KQUEBZWVl7N+/n8jISEf/vffei6+vLx999BEAu3btIjIyEm9vb3r27MnevXsB2LlzZ7XtRETk7jIZhlHvr9UZGRls2LABq9XKiBEjSExMJDExkaSkJB5++GH+8Y9/MG/ePEpKSvi3f/s3nn/+eXx8fMjKymL27Nnk5+cTGhpKSkoKAQEBdXpvHRFIU+GKIwKRurjTEYFTQeBKCgJpKtq3N1NRcb3Gch8fXy5ezLvJFiJ3152CoN7nCESkit1uw8fHB7vdoLLSipeXNx4eJux2m6tLE6kVPWJCxEmVlZU8+mgfbLaqO+dttqr2jTvpRZo6DQ2JOCkkpC12ux2LxcKVK1e45557yM3NxcPDg8uXi1xdnkjjXTUkIlVufCEZNGgIBQUFDBo0pNpykaZORwQiTrJY2nDfffdx4cIFx7IbbV01JE2BjghE7oKsrCwWLVpGaWkpixYtIysry9UlidSagkCkAdjt9tu2RZoyDQ2JOMliaUOrVq24fr3Ccfmor68PpaWlGhqSJkFDQyKNzMfHl5iYWDp06ICHhwcdOnQgJiYWHx9fV5cmUisKAhEnjR07nvT0N8nPz8cwDPLz80lPf5OxY8e7ujSRWlEQiDipV6/etGrVisLCQgzDoLCwkFatWtGrV29XlyZSKwoCESelpq5ky5Y3yM6uOiLIzs5ny5Y3SE1d6erSRGpFJ4tFnBQS0pYLF/Lw9vbGbG5NXl4xVquV++4z685iaRJ0slikkXXs2Iljx45WW3bs2FE6duzkoopE6kZBIOKk5OSZJCfP4PDhQ1itVg4fPkRy8gySk2e6ujSRWtFjqEWcFB8/kuPHjzFq1HAqKq7j4+PL2LHjiY8f6erSRGpFRwQiTkpPf5MDB/azbdt2Kioq2LZtOwcO7Cc9/U1XlyZSKzpZLOKkyMjeLFu2goiISMfJ4sOHDzFnziwOHTrm6vJENFWlSGPTVUPS1OmqIZFGpquGpLmrdxBkZ2eTkJBAdHQ0U6dOpbS0tMY6ubm5TJw4kbi4OIYNG8bRo1W/LFarlR49ehAXF+f4z2bT/K7SPOmqIWnu6j00NHnyZIYOHcrgwYNZu3Yt165dY9asWdXWmTlzJt27dychIYGzZ88yduxYDh06xJkzZ1i1ahWbN2+ud+EaGpKmJD39TVJTV/Lll1/QsWMnkpNn6qohaTIa5RyB1Wqld+/efPDBB3h5eXHp0iV++ctf8te//rXaevv27aNPnz4EBARgs9no3bs37777Lnv27CEtLQ2TyYSXlxczZ87k0UcfrVMNCgJpim6cIxBpSu4UBPW6j6CwsBB/f3+8vKo2N5vN5OTk1FgvKirK8ffNmzfTpUsXWrdujclk4oknnmDy5Ml89dVXJCYmkpGRQVBQUH3KERERJ9wxCN5++22ef/75asvuv/9+TCZTtWXfb3/Xa6+9xp///Gdef/11AEaNGuXoe+ihh+jatSsff/wx/fv3r3Xht0s3EVcym1u7ugSROrljEMTExBATE1Nt2Y2hIZvNhqenJ3l5eVgslptuv3z5ct577z22bt1KSEgIADt37qRHjx786Ec/AsAwDLy9vetUuIaGpCnS0JA0RY1y+ai3tzc9e/Zk7969QNUHe2RkZI31XnvtNY4dO8Ybb7zhCAGAL774gldffRWAs2fPcubMGX7yk5/UpxQREXFSva8aysrKYvbs2eTn5xMaGkpKSgoBAQG88cYb5ObmkpSUxKOPPoq/vz9t2rRxbLdx40ZatWrFnDlzOHv2LCaTiblz59KnT586vX9hYamOCKTJCQ72Jz+/xNVliFTj4WEiMLDVLfub7Z3FIiLSMHRnsYiIm1MQiIi4OQWBiIibUxCIiLg5BYGIiJtTEIiIuDkFgYiIm1MQiIi4OQWBiIibq9djqMU9Xbx4kejoaB588EFMJhNWqxWLxcLzzz9f7VlSrpKWloafnx+xsbG3XKe0tJSVK1dy+PBhWrZsib+/P08//TQ//elPAfjss8+YPn069957L3369GHbtm3cc889GIaB3W5n1KhR/PKXvwTgpZdeIjw8nCeeeOKm73Wr/tWrVwPw9NNPO7W/Fy9eZNy4cbzzzjs37V+0aBEff/wxVquVf/7znzz44IMAjBs3juHDh9dY/9133+X8+fP86le/uuV7pqen88EHH/DCCy/ccp2xY8cyY8YMevfuXW35nX5e4joKAqkTi8XCrl27HO0XXniB5cuXk5KS4sKqqnz88ce3neDIMAymTJlCly5d+Mtf/oKPjw+ff/45Tz31FC+++KJj4qShQ4fyX//1X6xevZpRo0Y5PrALCgoYP348vr6+jBw5kmeeeea29dypv7EtWLAA+FdgfPf/282cPn26Uetx9c9Dbk1BIE7p3bs3KSkpvP322/zhD3+gvLyciooKli1bRnBwMOPHj+edd97Bw8ODY8eO8corr5CYmMjLL7+Mt7c3Fy9epF+/fvj5+XHw4EGg6sGE99xzD4cOHeL3v/89lZWVtG/fniVLlhAYGEi/fv0YOnQohw8fpqysjP/+7//m22+/5Z133uH999/HbDZTVFTEpk2b8PT0pH379qxYsYITJ06QnZ3N//zP/zjmz3jooYeYOnUq69ato7y8nDfeeAMAHx+fGvsaFBTE1KlTeeWVVxg5ciSzZ8/m0Ucf5YsvvqBdu3ZMmDABqPqmP3ToUP7617/y6KOPEh8fz6ZNm0hLSyMwMJA2bdrQtWtXgDrtY3h4OJ9//jlz584FoHPnzo7aMjIyauyvr6/vTf+fnTt3jvnz51NUVISfnx9z587Fz8+Pbdu2ARAWFkZERARz5syhuLiY3Nxchg0bVqcP8rfeeosXXniBb7/9lrlz59KvXz/Hzys+Pr7WryN3h84RSL1ZrVb27dtHt27d2LZtGy+//DK7d+9m0qRJbNy4kfvvv5/27dtz7NgxoOpx5Tc+BE6ePMmiRYvYvn07W7duJSgoiPT0dDp16sRf/vIXCgoKePHFF9m8eTM7d+4kIiKClStXOt67bdu2vPXWW4waNYoNGzbQt29f+vXrR1JSEj/72c9ITU3l1VdfJT09nXvvvZezZ89y6tQpwsPDa0yi1KtXL06dOsVjjz3GqFGjGDVqFDNmzLjpPnfs2JGzZ89WWxYXF8eePXsAKCkp4ZNPPuGxxx5z9J86dYrt27ezY8cO/vCHP3D58mWAOu8jwHPPPcfMmTPZsWMH7du3d6x7s/29lVmzZjF27FgyMjL47W9/yzPPPMOPfvQjx74PHz6cPXv2EBsbS1paGhkZGWzZsoWCgoJbvub3tW7dmh07djBv3jzWrl1b6+3ENXREIHWSm5tLXFwcABUVFXTt2pVf//rXeHl58c4773Du3Dk++OADPDyqvmMMHz6c3bt3061bN95//30WLlzIiRMn6NixI6GhoQAEBgY6xujDwsL49ttvOXnyJJcuXWLcuHEA2O12AgICHHX87Gc/A+DHP/4x+/fvr1Hn448/zujRo+nfvz9RUVF06dKFI0eOYLPZaqxrtVpvO8Ped5lMJlq0aFFt2UMPPURFRQXffPMNn3zyCf369at2RPHBBx/w2GOP0apV1WOAo6Ojsdvtdd7HgoICcnNz+fd//3cA4uPj2b59+y3392ZKS0v55z//ycCBAwHo1q0bAQEBNYJj4sSJvP/++2zevJmvvvoKq9VKWVlZrX5GgGO2wQ4dOlBYWFjr7cQ1FARSJ98/RwBVHy7Dhw9n6NCh9OrVi06dOrF161ag6kNv1apV7Nu3j8jISMdwxfdnpPP09KzWttls9OjRg5dffhmA69evU1pa6ui/8Tq3+gCfN28e//jHP3jvvfeYNWsWM2bM4JFHHuGPf/wjVqu12vufOHGC8PDwWu3/F1984Tjp+l1Dhw5l7969fPLJJzz11FPV+kwmE9992ruXlxcVFRV13sfvv853f2Y3298bgf1dN3vqvGEYNQLyhRde4MKFC8TGxtK/f3+OHDly021v5UZttQ1YcS0NDYnTzp8/j8lkYsqUKfTu3ZsDBw44PlhatmxJZGQkKSkpdRobfuSRRzhx4gTnzp0DYN26dSxfvvy223h6emKz2aisrGTgwIEEBgYyefJk4uLiOHPmDD179qRDhw4sW7YMq9UKVJ0gXb9+PdOmTbtjTbm5ubz88sskJCTU6BsyZAh79+7lm2++qTHb3k9/+lPeffddiouLuX79OgcOHKjXPgYGBhIWFsbf/vY3AMdw1K3292b8/f1p37694yjqxIkTXLlyhR//+Md4enpSWVkJwN///ncmTpxITEwM586dIycnB7vdfsefkTRPOiIQp3Xu3JkuXboQExODyWQiIiKCjz76yNE/ePBgPv74Yx555JFav6bZbGbZsmUkJydjt9tp164dK1asuO02ffv2JSUlhdatW5OUlMSECRPw9fUlODjYcbnjmjVrWLVqFbGxsXh6ehIQEMCKFStqXOp4w7Zt2zh48KDj2/h//ud/Mnjw4BrrhYaGEhgYSPfu3Wt8C+7SpQvjx49nxIgRtGnThrCwsHrv44oVK/jtb39Lamoq3bp1A6qOMG61v7d6jYULF7J69Wq8vb1ZvXo1Pj4+9OrVi+eee4577rmHyZMn85vf/IYWLVoQEhJCeHg4Fy9evG1t0nxphjJpVDabjVWrVhEcHHzb69Plh2/69OkMGTKE6OhoV5ci36MjAmlUw4cPJzAwkPXr17u6FGlAv/71r/n6669rLO/Xr99NLzNNSkri3Llzt73PQ1xHRwQiIm5OJ4tFRNycgkBExM0pCERE3JyCQETEzSkIRETcnIJARMTN/X/3x4xnTWj0hAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#df[df.ticker == &#39;AAPL&#39;].sort_values(&#39;period&#39;)[[&#39;adsh&#39;,&#39;period&#39;, &#39;period_year&#39;,&#39;fp&#39;,&#39;bs_qtrs&#39;,&#39;is_qtrs&#39;,&#39;cf_qtrs&#39;,&#39;c_CashFromOperating&#39;,&#39;CashFromFinancing&#39;,&#39;CashFromInvesting&#39;,&#39;c_RetainedEarnings&#39;]]</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span> <span class="o">==</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[[</span><span class="s1">&#39;period&#39;</span><span class="p">,</span> <span class="s1">&#39;period_year&#39;</span><span class="p">,</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span><span class="s1">&#39;c_CashFromOperating&#39;</span><span class="p">,</span><span class="s1">&#39;CashFromFinancing&#39;</span><span class="p">,</span><span class="s1">&#39;CashFromInvesting&#39;</span><span class="p">,</span><span class="s1">&#39;c_RetainedEarnings&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span> <span class="o">==</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)[[</span><span class="s1">&#39;c_Revenues&#39;</span><span class="p">,</span> <span class="s1">&#39;period&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span><span class="s1">&#39;INTC&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">test_df</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span>  <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;INTC&#39;</span><span class="p">,</span>  <span class="s1">&#39;INTC&#39;</span><span class="p">,</span>   <span class="s1">&#39;INTC&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;B&#39;</span> <span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q2&#39;</span><span class="p">,</span>   <span class="s1">&#39;Q3&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q4&#39;</span><span class="p">,</span>  <span class="s1">&#39;Q1&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q2&#39;</span><span class="p">,</span>     <span class="s1">&#39;Q3&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;C&#39;</span> <span class="p">:</span>  <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span>    <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>    <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span>   <span class="mf">2.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span>      <span class="mf">2.0</span><span class="p">,</span>       <span class="mf">3.0</span><span class="p">]</span> \
                  <span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ticker</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;D1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;D2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        
    <span class="n">pos_arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;D1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;D2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">df_sample</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes: &quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">C</span>
<span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">array</span> <span class="o">/</span> <span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np_arr</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_arr</span><span class="p">)</span>
<span class="n">np_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">np_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">np_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_arr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mylist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span> <span class="s1">&#39;fp&#39;</span><span class="p">]))[]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span><span class="s1">&#39;INTC&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">test_df</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>filed</th>
      <th>form</th>
      <th>bs_qtrs</th>
      <th>fp</th>
      <th>Assets</th>
      <th>...</th>
      <th>r_returnOnAssets</th>
      <th>r_assetsTurnoverRatio</th>
      <th>r_dividendPayoutRatio</th>
      <th>r_stockRepurchaseRatio</th>
      <th>r_operatingCashFlowRatio</th>
      <th>r_assetEfficiencyRatio</th>
      <th>r_currentLiabCoverageRatio</th>
      <th>r_longtermDeptCoverageRatio</th>
      <th>period_year</th>
      <th>period_month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>91201</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-12-182321</td>
      <td>2012-03-31</td>
      <td>2012-04-25</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q2</td>
      <td>1.509340e+11</td>
      <td>...</td>
      <td>0.077001</td>
      <td>0.259623</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.804650</td>
      <td>0.208906</td>
      <td>0.984236</td>
      <td>1.922622</td>
      <td>2012</td>
      <td>2012-03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6675</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0001193125-12-212253</td>
      <td>2012-03-31</td>
      <td>2012-05-04</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q1</td>
      <td>7.181700e+10</td>
      <td>...</td>
      <td>0.038125</td>
      <td>0.179707</td>
      <td>0.383126</td>
      <td>0.554785</td>
      <td>0.230280</td>
      <td>0.041383</td>
      <td>0.161042</td>
      <td>inf</td>
      <td>2012</td>
      <td>2012-03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32844</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0001193125-12-329132</td>
      <td>2012-06-30</td>
      <td>2012-08-01</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q2</td>
      <td>7.235200e+10</td>
      <td>...</td>
      <td>0.039073</td>
      <td>0.186602</td>
      <td>0.744959</td>
      <td>1.031128</td>
      <td>0.571143</td>
      <td>0.106576</td>
      <td>0.531885</td>
      <td>inf</td>
      <td>2012</td>
      <td>2012-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17177</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-12-314552</td>
      <td>2012-06-30</td>
      <td>2012-07-25</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q3</td>
      <td>1.628960e+11</td>
      <td>...</td>
      <td>0.054170</td>
      <td>0.215002</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.191217</td>
      <td>0.256114</td>
      <td>1.261948</td>
      <td>2.306247</td>
      <td>2012</td>
      <td>2012-06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87974</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-12-444068</td>
      <td>2012-09-30</td>
      <td>2012-10-31</td>
      <td>10-K</td>
      <td>0.0</td>
      <td>FY</td>
      <td>1.760640e+11</td>
      <td>...</td>
      <td>0.237033</td>
      <td>0.888927</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.324942</td>
      <td>0.288850</td>
      <td>1.319496</td>
      <td>2.633389</td>
      <td>2012</td>
      <td>2012-09</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14308</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0001193125-12-444095</td>
      <td>2012-09-30</td>
      <td>2012-10-31</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q3</td>
      <td>7.444100e+10</td>
      <td>...</td>
      <td>0.039924</td>
      <td>0.180774</td>
      <td>1.087147</td>
      <td>1.376178</td>
      <td>0.955488</td>
      <td>0.172727</td>
      <td>0.805405</td>
      <td>inf</td>
      <td>2012</td>
      <td>2012-09</td>
    </tr>
    <tr>
      <th>6</th>
      <td>83302</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-13-022339</td>
      <td>2012-12-31</td>
      <td>2013-01-24</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q1</td>
      <td>1.960880e+11</td>
      <td>...</td>
      <td>0.066695</td>
      <td>0.277998</td>
      <td>0.000000</td>
      <td>0.149105</td>
      <td>0.429740</td>
      <td>0.119467</td>
      <td>0.499712</td>
      <td>1.071491</td>
      <td>2012</td>
      <td>2012-12</td>
    </tr>
    <tr>
      <th>7</th>
      <td>20567</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0001193125-13-065416</td>
      <td>2012-12-31</td>
      <td>2013-02-19</td>
      <td>10-K</td>
      <td>0.0</td>
      <td>FY</td>
      <td>8.435100e+10</td>
      <td>...</td>
      <td>0.130467</td>
      <td>0.632370</td>
      <td>0.395275</td>
      <td>0.464334</td>
      <td>0.354024</td>
      <td>0.223874</td>
      <td>1.126841</td>
      <td>inf</td>
      <td>2012</td>
      <td>2012-12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>58808</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0000050863-13-000043</td>
      <td>2013-03-31</td>
      <td>2013-04-29</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q1</td>
      <td>8.308300e+10</td>
      <td>...</td>
      <td>0.024614</td>
      <td>0.151415</td>
      <td>0.544743</td>
      <td>0.273350</td>
      <td>0.340620</td>
      <td>0.051575</td>
      <td>0.268774</td>
      <td>inf</td>
      <td>2013</td>
      <td>2013-03</td>
    </tr>
    <tr>
      <th>9</th>
      <td>81220</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-13-168288</td>
      <td>2013-03-31</td>
      <td>2013-04-24</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q2</td>
      <td>1.947430e+11</td>
      <td>...</td>
      <td>0.049024</td>
      <td>0.223900</td>
      <td>0.000000</td>
      <td>0.204253</td>
      <td>0.824026</td>
      <td>0.184500</td>
      <td>1.011885</td>
      <td>1.513161</td>
      <td>2013</td>
      <td>2013-03</td>
    </tr>
    <tr>
      <th>10</th>
      <td>59337</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0000050863-13-000087</td>
      <td>2013-06-30</td>
      <td>2013-07-29</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q2</td>
      <td>8.566100e+10</td>
      <td>...</td>
      <td>0.023348</td>
      <td>0.149555</td>
      <td>1.118500</td>
      <td>0.677500</td>
      <td>0.703068</td>
      <td>0.105147</td>
      <td>0.594433</td>
      <td>inf</td>
      <td>2013</td>
      <td>2013-06</td>
    </tr>
    <tr>
      <th>11</th>
      <td>25646</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-13-300670</td>
      <td>2013-06-30</td>
      <td>2013-07-24</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q3</td>
      <td>1.998560e+11</td>
      <td>...</td>
      <td>0.034525</td>
      <td>0.176742</td>
      <td>0.000000</td>
      <td>2.601449</td>
      <td>1.238796</td>
      <td>0.218948</td>
      <td>1.204824</td>
      <td>1.088968</td>
      <td>2013</td>
      <td>2013-06</td>
    </tr>
    <tr>
      <th>12</th>
      <td>32618</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0000050863-13-000104</td>
      <td>2013-09-30</td>
      <td>2013-10-28</td>
      <td>10-Q</td>
      <td>0.0</td>
      <td>Q3</td>
      <td>9.055100e+10</td>
      <td>...</td>
      <td>0.032578</td>
      <td>0.148900</td>
      <td>1.138305</td>
      <td>0.643729</td>
      <td>1.093080</td>
      <td>0.162759</td>
      <td>0.820180</td>
      <td>inf</td>
      <td>2013</td>
      <td>2013-09</td>
    </tr>
    <tr>
      <th>13</th>
      <td>11380</td>
      <td>320193</td>
      <td>AAPL</td>
      <td>0001193125-13-416534</td>
      <td>2013-09-30</td>
      <td>2013-10-30</td>
      <td>10-K</td>
      <td>0.0</td>
      <td>FY</td>
      <td>2.070000e+11</td>
      <td>...</td>
      <td>0.178923</td>
      <td>0.825652</td>
      <td>0.000000</td>
      <td>0.617221</td>
      <td>0.314002</td>
      <td>0.259256</td>
      <td>1.229236</td>
      <td>1.348629</td>
      <td>2013</td>
      <td>2013-09</td>
    </tr>
    <tr>
      <th>14</th>
      <td>49869</td>
      <td>50863</td>
      <td>INTC</td>
      <td>0000050863-14-000020</td>
      <td>2013-12-31</td>
      <td>2014-02-14</td>
      <td>10-K</td>
      <td>0.0</td>
      <td>FY</td>
      <td>9.235800e+10</td>
      <td>...</td>
      <td>0.104160</td>
      <td>0.570692</td>
      <td>0.465593</td>
      <td>0.253638</td>
      <td>0.394172</td>
      <td>0.224951</td>
      <td>1.201135</td>
      <td>inf</td>
      <td>2013</td>
      <td>2013-12</td>
    </tr>
  </tbody>
</table>
<p>15 rows ?51 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span>  <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;INTC&#39;</span><span class="p">,</span>  <span class="s1">&#39;INTC&#39;</span><span class="p">,</span>   <span class="s1">&#39;INTC&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;B&#39;</span> <span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q2&#39;</span><span class="p">,</span>   <span class="s1">&#39;Q3&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q4&#39;</span><span class="p">,</span>  <span class="s1">&#39;Q1&#39;</span><span class="p">,</span>    <span class="s1">&#39;Q2&#39;</span><span class="p">,</span>     <span class="s1">&#39;Q3&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;C&#39;</span> <span class="p">:</span>  <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span>    <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>    <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span>   <span class="mf">2.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span>      <span class="mf">2.0</span><span class="p">,</span>       <span class="mf">3.0</span><span class="p">]</span> \
                  <span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ticker</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;D1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;D2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        
    <span class="n">pos_arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;D1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;D2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">df_sample</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>AAPL   (4, 3)
[ True False False  True]


INTC   (3, 3)
[ True  True  True]


</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D1</th>
      <th>D2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Q1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AAPL</td>
      <td>Q2</td>
      <td>-1.0</td>
      <td>-2.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AAPL</td>
      <td>Q3</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAPL</td>
      <td>Q4</td>
      <td>2.0</td>
      <td>-0.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>INTC</td>
      <td>Q1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>INTC</td>
      <td>Q2</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>INTC</td>
      <td>Q3</td>
      <td>3.0</td>
      <td>0.5</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes: &quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">x</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
yes:  Index([&#39;B&#39;, &#39;C&#39;], dtype=&#39;object&#39;)
-------
&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
&lt;class &#39;pandas.core.series.Series&#39;&gt;
-------
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\ieu\Anaconda3\envs\spark\lib\site-packages\pandas\core\generic.py:5303: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self[name] = value
C:\ieu\Anaconda3\envs\spark\lib\site-packages\ipykernel_launcher.py:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  
C:\ieu\Anaconda3\envs\spark\lib\site-packages\pandas\core\groupby\generic.py:1474: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  fast_path = lambda group: func(group, *args, **kwargs)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Q1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Q1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Q2</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Q2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Q3</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Q3</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">C</span>
<span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    1.0
1    1.0
2    3.0
3    2.0
4    5.0
5    3.0
Name: C, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">array</span> <span class="o">/</span> <span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;PandasArray&gt;
[1.0, 3.0, 0.6666666666666666, 2.5, 0.6]
Length: 5, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np_arr</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_arr</span><span class="p">)</span>
<span class="n">np_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">np_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">np_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_arr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;PandasArray&gt;
[1.0, 1.0, 3.0, 2.0, 5.0, 3.0]
Length: 6, dtype: float64
&lt;PandasArray&gt;
[1.0, 1.0, 3.0, 0.6666666666666666, 2.5, 0.6]
Length: 6, dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    1.000000
1    1.000000
2    3.000000
3    0.666667
4    2.500000
5    0.600000
Name: C, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mylist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;cik&#39;</span><span class="p">,</span> <span class="s1">&#39;fp&#39;</span><span class="p">]))[]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

