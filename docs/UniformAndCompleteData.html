---

title: uniform and complete

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_UniformAndCompleteData.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="n">get_spark_session</span> <span class="c1"># initialze spark</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.dataframe</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_pivot_selected_folder</span>  <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_select&quot;</span>
<span class="n">all_pivoted_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_split&quot;</span>
<span class="n">all_processed_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_processed/&quot;</span>

<span class="n">col_list</span> <span class="o">=</span>    <span class="p">[</span><span class="s2">&quot;stmt&quot;</span><span class="p">,</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;uom&quot;</span><span class="p">]</span>
<span class="n">pivot_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">]</span>
<span class="n">statements</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;IS&#39;</span><span class="p">,</span><span class="s1">&#39;CF&#39;</span><span class="p">,</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span><span class="s1">&#39;BS&#39;</span><span class="p">,</span><span class="s1">&#39;CI&#39;</span><span class="p">,</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span><span class="s1">&#39;UN&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># init Spark</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark_session</span><span class="p">()</span> <span class="c1"># Session anlegen</span>
<span class="n">spark</span> <span class="c1"># display the moste important information of the session</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <p><b>SparkSession - in-memory</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="http://192.168.0.163:4040">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v2.4.5</code></dd>
              <dt>Master</dt>
                <dd><code>local[*]</code></dd>
              <dt>AppName</dt>
                <dd><code>default</code></dd>
            </dl>
        </div>
        
            </div>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">stmt</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivoted_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">stmt</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spark_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Get count of both null and missing values in pyspark</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">isnan</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">col</span>
<span class="k">def</span> <span class="nf">get_empty_count</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">count</span><span class="p">(</span><span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">isNull</span><span class="p">(),</span> <span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">complete_addition</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">):</span>
    <span class="n">missingtwo</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span>

    <span class="n">missingone</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span>  
    
    <span class="n">missingsum</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">copy_if_not_empty</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">,</span> <span class="n">to_zero_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sourcecol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">to_zero_col</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">to_zero_col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">copy_if_not_empty_for_ticker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">,</span> <span class="n">to_zero_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ticker</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="n">sourcecol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>

    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">to_zero_col</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">to_zero_col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">set_to_zero_if_null</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">do_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_null_count</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Raw_data">00_Raw_data<a class="anchor-link" href="#00_Raw_data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivot_selected_folder</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Balance_Sheet">01_Balance_Sheet<a class="anchor-link" href="#01_Balance_Sheet"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133872, 2342)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd</span> <span class="o">=</span> <span class="n">bs_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span> <span class="o">=</span> <span class="n">bs_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Assets">Assets<a class="anchor-link" href="#Assets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   579
AssetsNoncurrent   127026
AssetsCurrent   30421
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">)</span>
<span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>
<span class="c1"># if Assets contains data and current not, copy from Assets to current and set noncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>
<span class="c1"># if AssetsCurrent contains data and Assets does not, copy to Assets ans set noncurrent t 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   419
AssetsNoncurrent   419
AssetsCurrent   419
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133872, 2342)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Liabilities">Liabilities<a class="anchor-link" href="#Liabilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   34118
LiabilitiesNoncurrent   117766
LiabilitiesCurrent   30837
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
<span class="c1"># if Liabilities contains data and current is empty, copy to current and set NonCurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
<span class="c1"># if only current Liabilities, copy to Liabilities and set Noncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   783
LiabilitiesNoncurrent   781
LiabilitiesCurrent   783
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133872, 2342)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Equity">Equity<a class="anchor-link" href="#Equity"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesAndStockholdersEquity&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   12883
RetainedEarningsAccumulatedDeficit   10583
LiabilitiesAndStockholdersEquity   710
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesAndStockholdersEquity&#39;</span><span class="p">)</span> <span class="c1"># has to be the same</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PartnersCapital&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> <span class="c1"># if there is partner capital, we consider it the same as stockholder equity</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> <span class="c1">#dito</span>
<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesAndStockholdersEquity&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   1277
RetainedEarningsAccumulatedDeficit   0
LiabilitiesAndStockholdersEquity   409
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133872, 2342)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-empty-companies">Clean empty companies<a class="anchor-link" href="#Clean-empty-companies"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_selected</span> <span class="o">=</span> <span class="n">bs_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> 
                                     <span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="n">bs_cols_selected</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="o">~</span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(124520, 13)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;bs.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="xx_trials">xx_trials<a class="anchor-link" href="#xx_trials"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selected</span> <span class="o">=</span> <span class="n">bs_piivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FXE&#39;</span>
<span class="n">sel_df</span> <span class="o">=</span> <span class="n">bs_piivot_pd_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>
<span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">do_copy</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>34</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_liabilities_copy</span><span class="p">[(</span><span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">StockholdersEquity</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>  <span class="p">][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;StockholdersEquityBeforeTreasuryStock&quot;</span><span class="p">,</span> <span class="s2">&quot;LiabilitiesAndStockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;RetainedEarningsAccumulatedDeficit&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>StockholdersEquityBeforeTreasuryStock</th>
      <th>LiabilitiesAndStockholdersEquity</th>
      <th>RetainedEarningsAccumulatedDeficit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>119910</th>
      <td>9892</td>
      <td>BCR</td>
      <td>0001193125-09-155929</td>
      <td>2009-06-30</td>
      <td>NaN</td>
      <td>2.762700e+09</td>
      <td>1.097400e+09</td>
    </tr>
    <tr>
      <th>19396</th>
      <td>1357615</td>
      <td>KBR</td>
      <td>0001140361-09-017252</td>
      <td>2009-06-30</td>
      <td>NaN</td>
      <td>5.647000e+09</td>
      <td>7.320000e+08</td>
    </tr>
    <tr>
      <th>5106</th>
      <td>783325</td>
      <td>WEC</td>
      <td>0000107815-09-000047</td>
      <td>2009-06-30</td>
      <td>NaN</td>
      <td>1.229830e+10</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>104965</th>
      <td>1037676</td>
      <td>ACI</td>
      <td>0000950123-09-031842</td>
      <td>2009-06-30</td>
      <td>NaN</td>
      <td>4.028997e+09</td>
      <td>4.684620e+08</td>
    </tr>
    <tr>
      <th>92620</th>
      <td>72903</td>
      <td>XEL</td>
      <td>0001104659-09-046313</td>
      <td>2009-06-30</td>
      <td>NaN</td>
      <td>2.498725e+10</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>26879</th>
      <td>1089819</td>
      <td>CNL</td>
      <td>0001089819-20-000013</td>
      <td>2020-06-30</td>
      <td>NaN</td>
      <td>7.729180e+09</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>8114</th>
      <td>783325</td>
      <td>WEC</td>
      <td>0000107815-20-000246</td>
      <td>2020-06-30</td>
      <td>NaN</td>
      <td>3.504200e+10</td>
      <td>6.222800e+09</td>
    </tr>
    <tr>
      <th>40671</th>
      <td>799233</td>
      <td>HTLD</td>
      <td>0000799233-20-000044</td>
      <td>2020-06-30</td>
      <td>NaN</td>
      <td>9.304990e+08</td>
      <td>8.558300e+08</td>
    </tr>
    <tr>
      <th>91662</th>
      <td>1549922</td>
      <td>SMLP</td>
      <td>0001564590-20-038480</td>
      <td>2020-06-30</td>
      <td>NaN</td>
      <td>2.586502e+09</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>69179</th>
      <td>65172</td>
      <td>MSB</td>
      <td>0001558370-20-011056</td>
      <td>2020-07-31</td>
      <td>NaN</td>
      <td>1.293815e+07</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>868 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_liabilities_copy</span><span class="p">[(</span><span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">StockholdersEquity</span><span class="o">.</span><span class="n">isnull</span><span class="p">())][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;Assets&quot;</span><span class="p">,</span> <span class="s2">&quot;StockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;LiabilitiesAndStockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;RetainedEarningsAccumulatedDeficit&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>Assets</th>
      <th>StockholdersEquity</th>
      <th>LiabilitiesAndStockholdersEquity</th>
      <th>RetainedEarningsAccumulatedDeficit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14125</th>
      <td>97476</td>
      <td>TXN</td>
      <td>0001140361-09-017223</td>
      <td>2009-06-30</td>
      <td>1.151000e+10</td>
      <td>NaN</td>
      <td>1.151000e+10</td>
      <td>2.116300e+10</td>
    </tr>
    <tr>
      <th>5967</th>
      <td>890801</td>
      <td>MFE</td>
      <td>0000950123-09-031492</td>
      <td>2009-06-30</td>
      <td>3.710919e+09</td>
      <td>NaN</td>
      <td>3.710919e+09</td>
      <td>6.208520e+08</td>
    </tr>
    <tr>
      <th>78888</th>
      <td>1170650</td>
      <td>MHS</td>
      <td>0000950123-09-027011</td>
      <td>2009-06-30</td>
      <td>1.777026e+10</td>
      <td>NaN</td>
      <td>1.777030e+10</td>
      <td>4.532500e+09</td>
    </tr>
    <tr>
      <th>71915</th>
      <td>1140859</td>
      <td>ABC</td>
      <td>0000950123-09-030790</td>
      <td>2009-06-30</td>
      <td>1.273575e+10</td>
      <td>NaN</td>
      <td>1.273575e+10</td>
      <td>2.806404e+09</td>
    </tr>
    <tr>
      <th>128768</th>
      <td>1004440</td>
      <td>CEG</td>
      <td>0001047469-09-007384</td>
      <td>2009-06-30</td>
      <td>1.999840e+10</td>
      <td>NaN</td>
      <td>1.999840e+10</td>
      <td>2.002700e+09</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13387</th>
      <td>29644</td>
      <td>DCI</td>
      <td>0000029644-20-000046</td>
      <td>2020-07-31</td>
      <td>2.244600e+09</td>
      <td>NaN</td>
      <td>2.244600e+09</td>
      <td>1.430000e+09</td>
    </tr>
    <tr>
      <th>69179</th>
      <td>65172</td>
      <td>MSB</td>
      <td>0001558370-20-011056</td>
      <td>2020-07-31</td>
      <td>1.293815e+07</td>
      <td>NaN</td>
      <td>1.293815e+07</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>13338</th>
      <td>1041859</td>
      <td>PLCE</td>
      <td>0001628280-20-013276</td>
      <td>2020-07-31</td>
      <td>1.167939e+09</td>
      <td>NaN</td>
      <td>1.167939e+09</td>
      <td>-6.386200e+07</td>
    </tr>
    <tr>
      <th>64756</th>
      <td>900075</td>
      <td>CPRT</td>
      <td>0000900075-20-000021</td>
      <td>2020-07-31</td>
      <td>3.455261e+09</td>
      <td>NaN</td>
      <td>3.455261e+09</td>
      <td>1.937853e+09</td>
    </tr>
    <tr>
      <th>42167</th>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>1.713800e+09</td>
      <td>NaN</td>
      <td>1.713800e+09</td>
      <td>6.914000e+08</td>
    </tr>
  </tbody>
</table>
<p>9236 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_liabilities_copy</span><span class="p">[(</span><span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">adsh</span> <span class="o">==</span> <span class="s1">&#39;0001104659-09-029605&#39;</span><span class="p">)][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-166-7219c605d87f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>bs_pivot_liabilities_copy<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">(</span>bs_pivot_liabilities_copy<span class="ansi-yellow-intense-fg ansi-bold">.</span>adsh <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-blue-intense-fg ansi-bold">&#39;0001104659-09-029605&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#34;cik&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-blue-intense-fg ansi-bold">&#34;ticker&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;adsh&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-blue-intense-fg ansi-bold">&#34;period&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-blue-intense-fg ansi-bold">&#34;report&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;line&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>sort_values<span class="ansi-yellow-intense-fg ansi-bold">(</span>by<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-blue-intense-fg ansi-bold">&#39;period&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">C:\ieu\Anaconda3\envs\spark\lib\site-packages\pandas\core\frame.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-intense-fg ansi-bold">(self, key)</span>
<span class="ansi-green-fg">   2804</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> is_iterator<span class="ansi-yellow-intense-fg ansi-bold">(</span>key<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   2805</span>                 key <span class="ansi-yellow-intense-fg ansi-bold">=</span> list<span class="ansi-yellow-intense-fg ansi-bold">(</span>key<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2806</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>indexer <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>loc<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_listlike_indexer<span class="ansi-yellow-intense-fg ansi-bold">(</span>key<span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> raise_missing<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">True</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">   2807</span> 
<span class="ansi-green-fg">   2808</span>         <span class="ansi-red-intense-fg ansi-bold"># take() does not accept boolean indexers</span>

<span class="ansi-green-intense-fg ansi-bold">C:\ieu\Anaconda3\envs\spark\lib\site-packages\pandas\core\indexing.py</span> in <span class="ansi-cyan-fg">_get_listlike_indexer</span><span class="ansi-blue-intense-fg ansi-bold">(self, key, axis, raise_missing)</span>
<span class="ansi-green-fg">   1551</span> 
<span class="ansi-green-fg">   1552</span>         self._validate_read_indexer(
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1553</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>keyarr<span class="ansi-yellow-intense-fg ansi-bold">,</span> indexer<span class="ansi-yellow-intense-fg ansi-bold">,</span> o<span class="ansi-yellow-intense-fg ansi-bold">.</span>_get_axis_number<span class="ansi-yellow-intense-fg ansi-bold">(</span>axis<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> raise_missing<span class="ansi-yellow-intense-fg ansi-bold">=</span>raise_missing
<span class="ansi-green-fg">   1554</span>         )
<span class="ansi-green-fg">   1555</span>         <span class="ansi-green-intense-fg ansi-bold">return</span> keyarr<span class="ansi-yellow-intense-fg ansi-bold">,</span> indexer

<span class="ansi-green-intense-fg ansi-bold">C:\ieu\Anaconda3\envs\spark\lib\site-packages\pandas\core\indexing.py</span> in <span class="ansi-cyan-fg">_validate_read_indexer</span><span class="ansi-blue-intense-fg ansi-bold">(self, key, indexer, axis, raise_missing)</span>
<span class="ansi-green-fg">   1644</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>name <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-blue-intense-fg ansi-bold">&#34;loc&#34;</span> <span class="ansi-green-intense-fg ansi-bold">and</span> <span class="ansi-green-intense-fg ansi-bold">not</span> raise_missing<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1645</span>                 not_found <span class="ansi-yellow-intense-fg ansi-bold">=</span> list<span class="ansi-yellow-intense-fg ansi-bold">(</span>set<span class="ansi-yellow-intense-fg ansi-bold">(</span>key<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">-</span> set<span class="ansi-yellow-intense-fg ansi-bold">(</span>ax<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1646</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">raise</span> KeyError<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">f&#34;{not_found} not in index&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   1647</span> 
<span class="ansi-green-fg">   1648</span>             <span class="ansi-red-intense-fg ansi-bold"># we skip the warning on Categorical/Interval</span>

<span class="ansi-red-intense-fg ansi-bold">KeyError</span>: &#34;[&#39;line&#39;, &#39;report&#39;] not in index&#34;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_count</span> <span class="o">=</span> <span class="n">get_empty_count</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_pd</span> <span class="o">=</span> <span class="n">empty_count</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span> <span class="o">=</span> <span class="n">empty_pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="c1"># df2 = pd.melt(df, id_vars=[&quot;location&quot;, &quot;name&quot;], var_name=&quot;Date&quot;, value_name=&quot;Value&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Tag&#39;, &#39;Count&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">df_all_selected</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001104659-20-108360&#39; and stmt = &#39;BS&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="n">pd_frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stmt</th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>form</th>
      <th>tag</th>
      <th>value</th>
      <th>report</th>
      <th>line</th>
      <th>fp</th>
      <th>uom</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>CashAndCashEquivalentsAtCarryingValue</td>
      <td>1.077000e+08</td>
      <td>2</td>
      <td>3</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>10</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>RestrictedCashAndCashEquivalentsAtCarryingValue</td>
      <td>6.400000e+06</td>
      <td>2</td>
      <td>4</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>38</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AccountsReceivableNetCurrent</td>
      <td>1.667000e+08</td>
      <td>2</td>
      <td>5</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>32</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>ContractWithCustomerAssetNetCurrent</td>
      <td>4.520000e+07</td>
      <td>2</td>
      <td>6</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>17</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>InventoryNet</td>
      <td>5.977000e+08</td>
      <td>2</td>
      <td>7</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AssetsOfDisposalGroupIncludingDiscontinuedOper...</td>
      <td>2.200000e+07</td>
      <td>2</td>
      <td>9</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>12</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>OtherAssetsCurrent</td>
      <td>6.160000e+07</td>
      <td>2</td>
      <td>10</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>31</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AssetsCurrent</td>
      <td>1.074200e+09</td>
      <td>2</td>
      <td>11</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>26</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>PropertyPlantAndEquipmentNet</td>
      <td>1.270000e+08</td>
      <td>2</td>
      <td>12</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>9</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>IntangibleAssetsNetIncludingGoodwill</td>
      <td>1.231000e+08</td>
      <td>2</td>
      <td>14</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>0</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>OperatingLeaseRightOfUseAsset</td>
      <td>8.580000e+07</td>
      <td>2</td>
      <td>15</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>35</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>OtherAssetsNoncurrent</td>
      <td>1.018000e+08</td>
      <td>2</td>
      <td>17</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>7</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>Assets</td>
      <td>1.713800e+09</td>
      <td>2</td>
      <td>19</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>19</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AccountsPayableCurrent</td>
      <td>1.798000e+08</td>
      <td>2</td>
      <td>22</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>33</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AccruedLiabilitiesCurrent</td>
      <td>1.450000e+08</td>
      <td>2</td>
      <td>23</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>27</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>LiabilitiesOfDisposalGroupIncludingDiscontinue...</td>
      <td>2.870000e+07</td>
      <td>2</td>
      <td>25</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>LiabilitiesCurrent</td>
      <td>3.943000e+08</td>
      <td>2</td>
      <td>26</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>15</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>LongTermDebtNoncurrent</td>
      <td>2.551000e+08</td>
      <td>2</td>
      <td>27</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>18</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>OperatingLeaseLiabilityNoncurrent</td>
      <td>6.800000e+07</td>
      <td>2</td>
      <td>28</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>30</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>DeferredRevenueNoncurrent</td>
      <td>7.020000e+07</td>
      <td>2</td>
      <td>29</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>20</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>OtherLiabilities</td>
      <td>3.560000e+07</td>
      <td>2</td>
      <td>30</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>13</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>LiabilitiesNoncurrent</td>
      <td>4.289000e+08</td>
      <td>2</td>
      <td>31</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>22</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>PreferredStockValue</td>
      <td>NaN</td>
      <td>2</td>
      <td>33</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>24</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>CommonStockValue</td>
      <td>4.530000e+07</td>
      <td>2</td>
      <td>34</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>37</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AdditionalPaidInCapitalCommonStock</td>
      <td>4.731000e+08</td>
      <td>2</td>
      <td>35</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>16</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>RetainedEarningsAccumulatedDeficit</td>
      <td>6.914000e+08</td>
      <td>2</td>
      <td>36</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>25</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>TreasuryStockCommonValue</td>
      <td>2.761000e+08</td>
      <td>2</td>
      <td>37</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>36</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AccumulatedOtherComprehensiveIncomeLossNetOfTax</td>
      <td>-4.310000e+07</td>
      <td>2</td>
      <td>38</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>28</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>StockholdersEquityIncludingPortionAttributable...</td>
      <td>8.906000e+08</td>
      <td>2</td>
      <td>39</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>6</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>LiabilitiesAndStockholdersEquity</td>
      <td>1.713800e+09</td>
      <td>2</td>
      <td>40</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>21</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AllowanceForDoubtfulAccountsReceivableCurrent</td>
      <td>2.090000e+07</td>
      <td>3</td>
      <td>1</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>23</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>AccumulatedDepreciationDepletionAndAmortizatio...</td>
      <td>2.437000e+08</td>
      <td>3</td>
      <td>2</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>8</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>PreferredStockParOrStatedValuePerShare</td>
      <td>1.000000e+00</td>
      <td>3</td>
      <td>3</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>34</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>PreferredStockSharesAuthorized</td>
      <td>2.500000e+05</td>
      <td>3</td>
      <td>4</td>
      <td>Q1</td>
      <td>shares</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>PreferredStockSharesIssued</td>
      <td>0.000000e+00</td>
      <td>3</td>
      <td>5</td>
      <td>Q1</td>
      <td>shares</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>CommonStockParOrStatedValuePerShare</td>
      <td>1.000000e+00</td>
      <td>3</td>
      <td>6</td>
      <td>Q1</td>
      <td>USD</td>
    </tr>
    <tr>
      <th>14</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>CommonStockSharesAuthorized</td>
      <td>1.000000e+08</td>
      <td>3</td>
      <td>7</td>
      <td>Q1</td>
      <td>shares</td>
    </tr>
    <tr>
      <th>11</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>CommonStockSharesIssued</td>
      <td>4.530079e+07</td>
      <td>3</td>
      <td>8</td>
      <td>Q1</td>
      <td>shares</td>
    </tr>
    <tr>
      <th>29</th>
      <td>BS</td>
      <td>1750</td>
      <td>AIR</td>
      <td>0001104659-20-108360</td>
      <td>2020-08-31</td>
      <td>10-Q</td>
      <td>TreasuryStockShares</td>
      <td>9.999965e+06</td>
      <td>3</td>
      <td>9</td>
      <td>Q1</td>
      <td>shares</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_report</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001492298-20-000025&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>585411</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;BS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>133872</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;EQ&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>86120</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;StockholdersEquity&#39;,
 &#39;StockholdersEquityAttributableToParentNotAllowableForNetCapital&#39;,
 &#39;StockholdersEquityBeforeTreasuryStock&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterestAdjustedBalance1&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio1&#39;,
 &#39;StockholdersEquityNoteSubscriptionsReceivable&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

