---

title: uniform and complete

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_UniformAndCompleteData.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once the data is pivoted, we want to create a dataset that contains only columns which appear in every report.</p>
<p>For instance, we want to have all the columns 'Assets', 'AssetsCurrent', 'AssetsNoncurrent' to be present in every balancesheet. However, not all desired tags are present and we have to find ways to calculate and complete them. Often, only 2 of 'Assets', 'AssetsCurrent', 'AssetsNoncurrent' are present, however, since Assets = AssetsCurrent + AssetsNoncurrent we can calculate the third.</p>
<p>Sometimes different tags are used to express the same meaning, so we have to figure out which tags belong together.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-Settings">Basic Settings<a class="anchor-link" href="#Basic-Settings"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># imports</span>
<span class="kn">from</span> <span class="nn">bfh_mt_hs2020_sec_data.core</span> <span class="kn">import</span> <span class="n">get_spark_session</span> <span class="c1"># initialze spark</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.dataframe</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>          <span class="c1"># provides high level file operations</span>
<span class="kn">import</span> <span class="nn">time</span>            <span class="c1"># used to measure execution time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_pivot_selected_folder</span>  <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_select&quot;</span>
<span class="n">all_pivoted_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_pivot_split&quot;</span>
<span class="n">all_processed_folder</span> <span class="o">=</span> <span class="s2">&quot;D:/data/parq_processed/&quot;</span>

<span class="n">col_list</span> <span class="o">=</span>    <span class="p">[</span><span class="s2">&quot;stmt&quot;</span><span class="p">,</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;fp&quot;</span><span class="p">,</span> <span class="s2">&quot;uom&quot;</span><span class="p">]</span>
<span class="n">pivot_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">]</span>
<span class="n">statements</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;IS&#39;</span><span class="p">,</span><span class="s1">&#39;CF&#39;</span><span class="p">,</span><span class="s1">&#39;CP&#39;</span><span class="p">,</span><span class="s1">&#39;BS&#39;</span><span class="p">,</span><span class="s1">&#39;CI&#39;</span><span class="p">,</span><span class="s1">&#39;EQ&#39;</span><span class="p">,</span><span class="s1">&#39;UN&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># init Spark</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark_session</span><span class="p">()</span> <span class="c1"># Session anlegen</span>
<span class="n">spark</span> <span class="c1"># display the moste important information of the session</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <p><b>SparkSession - in-memory</b></p>
                
        <div>
            <p><b>SparkContext</b></p>

            <p><a href="http://192.168.0.163:4040">Spark UI</a></p>

            <dl>
              <dt>Version</dt>
                <dd><code>v2.4.5</code></dd>
              <dt>Master</dt>
                <dd><code>local[*]</code></dd>
              <dt>AppName</dt>
                <dd><code>default</code></dd>
            </dl>
        </div>
        
            </div>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Tools">00_Tools<a class="anchor-link" href="#00_Tools"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are different helper methods which make transformation of the data easier</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">stmt</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Loads the pivoted data into a spark dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivoted_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">stmt</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spark_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Get count of both null and missing values in pyspark</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">isnan</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">col</span>
<span class="k">def</span> <span class="nf">get_empty_count</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">count</span><span class="p">(</span><span class="n">when</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">isNull</span><span class="p">(),</span> <span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">complete_addition</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    If there are columns that share the relation sumcol = addcol1 + addcol2</span>
<span class="sd">    this function ensures that a missing value is calculated based on the other two   </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missingtwo</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingtwo</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span>

    <span class="n">missingone</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingone</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span>  
    
    <span class="n">missingsum</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sumcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol2</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">addcol1</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">sumcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">addcol1</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missingsum</span><span class="p">,</span> <span class="n">addcol2</span><span class="p">]</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">copy_if_not_empty</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">,</span> <span class="n">to_zero_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    copies the value from the sourceol to the targetcol if the sourcecol is not empty and the targetcol is empty.</span>
<span class="sd">    As a third parameter, a column can be provided that has to be set to 0.0 in the rows where the values are copied    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sourcecol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">to_zero_col</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">to_zero_col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sum_into_empty_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">add1col</span><span class="p">,</span> <span class="n">add2col</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    adds the value of two not empty columns and stores the result in the empty targetcol</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">do_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">add1col</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">add2col</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_sum</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_sum</span><span class="p">,</span> <span class="n">add1col</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_sum</span><span class="p">,</span> <span class="n">add2col</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sum_cols_into_new_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">,</span> <span class="n">sumcolslist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; sums up the value  of several columns and stores the result in the targetcol.</span>
<span class="sd">        the columns that contain values to sum up may not be empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sumcolslist</span><span class="p">:</span>
        <span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span> <span class="o">+=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">copy_if_not_empty_for_ticker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">,</span> <span class="n">to_zero_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; copy the not empty sourcecol to the empty targetcol of a certain ticker.</span>
<span class="sd">        if provided, set the to_zero_col for the affected rows to zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ticker</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="n">sourcecol</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="n">targetcol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>

    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">targetcol</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">sourcecol</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">to_zero_col</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_copy</span><span class="p">,</span> <span class="n">to_zero_col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">set_to_zero_if_null</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; set null values of a column to 0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">do_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">do_set</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_null_count</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; print out howmany null values the provided cols contain </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="00_Raw_data">00_Raw_data<a class="anchor-link" href="#00_Raw_data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">all_pivot_selected_folder</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># it happens sometimes, that the data can not be associated with a right sheet (bs, is, cf, ..). in this cases, the data can appea under &quot;UN&quot;</span>
<span class="c1"># so if expected information cannot be found in the appropriate statement, we have to look in the un statement</span>
<span class="n">un_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;UN&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">un_pivot_pd</span> <span class="o">=</span> <span class="n">un_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">un_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(4074, 1958)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="01_Balance_Sheet">01_Balance_Sheet<a class="anchor-link" href="#01_Balance_Sheet"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133872, 2342)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd</span> <span class="o">=</span> <span class="n">bs_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_pd_copy</span> <span class="o">=</span> <span class="n">bs_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Assets">Assets<a class="anchor-link" href="#Assets"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   579
AssetsNoncurrent   127026
AssetsCurrent   30421
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Somtimes AssetsNet is present instead of Assets, copy its content to Assets</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsNet&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">)</span>

<span class="c1"># if one of the three provided columns is missing, calculate its content based on Assets = AssetsCurrent + AssetsNoncurrent</span>
<span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>

<span class="c1"># if Assets contains data but AssetsCurrent and AssetsNoncurrent are empty, assume that only AssetsCurrent is present</span>
<span class="c1"># copy value from Assets to AssetsCurrent and set AssetsNoncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>

<span class="c1"># if AssetsCurrent contains data and Assets  and AssetsNoncurrent are empty, assume that only AssetsCurrent is present</span>
<span class="c1"># copy value from AssetsCurrent to Assets and set AssetsNoncurrent to 0.0</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for how many entries Assets, AssetsNoncurrent and AsstesCurrent couldn&#39;t be completed</span>
<span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Assets   419
AssetsNoncurrent   419
AssetsCurrent   419
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Liabilities">Liabilities<a class="anchor-link" href="#Liabilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   34118
LiabilitiesNoncurrent   117766
LiabilitiesCurrent   30837
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Completing the Liabilities columns follows the same logic as for the Assets columns</span>

<span class="n">complete_addition</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># check for how many entries we were not able to complete the Liabilities information</span>
<span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Liabilities   783
LiabilitiesNoncurrent   781
LiabilitiesCurrent   783
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Equity">Equity<a class="anchor-link" href="#Equity"> </a></h3><p>In the Equity section of the balance sheet, we are intereste in the StockholdersEquity and the Earnings (Tag. RetainedEarningsAccumulatedDeficit)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   12883
RetainedEarningsAccumulatedDeficit   10583
LiabilitiesAndStockholdersEquity   710
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># per  definition, LiabilitisAndStockholdersEquity has to match Assets in a balance sheet</span>
<span class="c1"># so if LiabilitiesAndStockholdersEquity is not set, we copy the value from the Assets column</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;Assets&#39;</span><span class="p">,</span> <span class="s1">&#39;LiabilitiesAndStockholdersEquity&#39;</span><span class="p">)</span> <span class="c1"># has to be the same</span>

<span class="c1"># if there is partner capital but no StockholdersEquite, we consider it the same as stockholder equity</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PartnersCapital&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> 

<span class="c1"># if there is StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest instead of StockholdersEquity, we use this as StocholdersEquity</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;</span><span class="p">,</span> <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)</span> 

<span class="c1"># if RetainedEarnings has no value, we set it to zero</span>
<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">bs_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>StockholdersEquity   1277
RetainedEarningsAccumulatedDeficit   0
LiabilitiesAndStockholdersEquity   409
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-empty-companies">Clean empty companies<a class="anchor-link" href="#Clean-empty-companies"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_selected</span> <span class="o">=</span> <span class="n">bs_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> 
                                     <span class="s1">&#39;Assets&#39;</span><span class="p">,</span><span class="s1">&#39;AssetsNoncurrent&#39;</span><span class="p">,</span> <span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;Liabilities&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesNoncurrent&#39;</span><span class="p">,</span><span class="s1">&#39;LiabilitiesCurrent&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">,</span><span class="s1">&#39;RetainedEarningsAccumulatedDeficit&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="n">bs_cols_selected</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span> <span class="o">=</span> <span class="n">bs_cols_selected</span><span class="p">[</span><span class="o">~</span><span class="n">bs_pivot_pd_copy</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(124520, 13)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_cols_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;bs.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CashFlow">CashFlow<a class="anchor-link" href="#CashFlow"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Operation</p>
<ul>
<li>NetIncomeLoss</li>
<li>ProfitLoss</li>
<li>NetCashProvidedByUsedInOperatingActivities: NetIncome + other positions ergibt diese Position</li>
</ul>
<p>Investing</p>
<ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>
<p>Financing activities</p>
<ul>
<li>PaymentsForRepurchaseOfCommonStock: Aktienrückkäufe</li>
<li>PaymentsOfDividends</li>
<li>NetCashProvidedByUsedInFinancingActivities</li>
</ul>
<p>Cash Bestand unterschied</p>
<ul>
<li>CashAndCashEquivalentsPeriodIncreaseDecrease: increase/decrease in cash</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_value</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;CF&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">spark_shape</span><span class="p">(</span><span class="n">cf_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133811, 3052)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_empty_count</span> <span class="o">=</span> <span class="n">get_empty_count</span><span class="p">(</span><span class="n">cf_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd</span> <span class="o">=</span> <span class="n">cf_pivot_value</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">cf_pivot_pd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133811, 3052)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cash-Increase/Decrease">Cash Increase/Decrease<a class="anchor-link" href="#Cash-Increase/Decrease"> </a></h3><ul>
<li>'CashAndCashEquivalentsPeriodIncreaseDecrease',</li>
<li>'CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect',</li>
<li>'CashPeriodIncreaseDecrease',</li>
<li>'CashPeriodIncreaseDecreaseExcludingExchangeRateEffect',</li>
<li>'NetCashProvidedByUsedInContinuingOperations'</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashAndCashEquivalentsPeriodIncreaseDecrease   30244
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># add possible columns from un set to  cf data with prefix cpy_</span>
<span class="n">un_cash_incdec</span> <span class="o">=</span> <span class="n">un_pivot_pd</span><span class="p">[[</span><span class="s2">&quot;adsh&quot;</span><span class="p">,</span>
    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
<span class="c1">#    &#39;CashPeriodIncreaseDecrease&#39;,</span>
<span class="c1">#    &#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;,</span>
<span class="c1">#    &#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39; </span>
<span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">un_cash_incdec</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;cpy_&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">un_cash_incdec</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cpy_adsh&#39;</span><span class="p">:</span><span class="s1">&#39;adsh&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="n">un_cash_incdec</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;adsh&#39;</span><span class="p">])</span>
<span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133811, 3055)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if CashAndCashEquivalentsPeriodIncreaseDecrease is not present and CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>
<span class="c1"># is present, we can replace CashAndCashEquivalentsPeriodIncreaseDecrease.</span>
<span class="c1"># there are only about 12 entries where both are present</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecrease&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInContinuingOperations&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>


<span class="c1"># try to find data in joined un data</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;cpy_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span> 
                                    <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">)</span> <span class="c1"># either or</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CashAndCashEquivalentsPeriodIncreaseDecrease   1563
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Operation">Operation<a class="anchor-link" href="#Operation"> </a></h3><ul>
<li>NetIncomeLoss</li>
<li>NetCashProvidedByUsedInOperatingActivities: NetIncome + other positions ergibt diese Position</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   58102
ProfitLoss   84716
NetCashProvidedByUsedInOperatingActivities   32125
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if only ProfitLoss is set, copy content to NetIncomeLoss</span>
<span class="c1"># if onlyNetIncomeLoss is set, copy to ProfitLoss</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLossAvailableToCommonStockholdersBasic&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">)</span> <span class="c1"># certain CFs just have this position</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetIncomeLoss   230
ProfitLoss   230
NetCashProvidedByUsedInOperatingActivities   501
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Investing">Investing<a class="anchor-link" href="#Investing"> </a></h3><ul>
<li>NetCashProvidedByUsedInInvestingActivities</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   33018
NetCashProvidedByUsedInInvestingActivitiesContinuingOperations   98645
CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations   128368
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> 
                      <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInInvestingActivities   0
NetCashProvidedByUsedInInvestingActivitiesContinuingOperations   98645
CashProvidedByUsedInInvestingActivitiesDiscontinuedOperations   128368
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Financing-activities">Financing activities<a class="anchor-link" href="#Financing-activities"> </a></h3><ul>
<li>PaymentsForRepurchaseOfCommonStock: Aktienrückkäufe</li>
<li>PaymentsOfDividends</li>
<li>NetCashProvidedByUsedInFinancingActivities</li>
</ul>
<p>('CashProvidedByUsedInDiscontinuedOperationsFinancingActivities',
 'CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations',
 'NetCashProvidedByUsedInFinancingActivities',
 'NetCashProvidedByUsedInFinancingActivitiesContinuingOperations')</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="NetCashProvidedByUsedInFinancingActivities">NetCashProvidedByUsedInFinancingActivities<a class="anchor-link" href="#NetCashProvidedByUsedInFinancingActivities"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   33202
NetCashProvidedByUsedInFinancingActivitiesContinuingOperations   100132
CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations   130954
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_into_empty_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> 
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivitiesContinuingOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
<span class="n">copy_if_not_empty</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations&#39;</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>

<span class="n">set_to_zero_if_null</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_null_count</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NetCashProvidedByUsedInFinancingActivities   0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsOfDividends">PaymentsOfDividends<a class="anchor-link" href="#PaymentsOfDividends"> </a></h4><p>Simply set to 0.0 if no data is present
 'PaymentsOfDividends',
 'PaymentsOfDividendsCommonStock',
 'PaymentsOfDividendsMinorityInterest',
 'PaymentsOfDividendsPreferredStockAndPreferenceStock',
 'PaymentsOfOrdinaryDividends',</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsOfDividendsTotal&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsOfDividends&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsCommonStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsMinorityInterest&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfDividendsPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;PaymentsOfOrdinaryDividends&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PaymentsForRepurchaseOfCommonStock:-Stock-buybacks">PaymentsForRepurchaseOfCommonStock: Stock buybacks<a class="anchor-link" href="#PaymentsForRepurchaseOfCommonStock:-Stock-buybacks"> </a></h4><p>'PaymentsForRepurchaseOfCommonStock',
 'PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations',
 'PaymentsForRepurchaseOfConvertiblePreferredStock',
 'PaymentsForRepurchaseOfPreferredStockAndPreferenceStock',
 'PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock',
 'PaymentsForRepurchaseOfRedeemablePreferredStock'</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sum_cols_into_new_target</span><span class="p">(</span><span class="n">cf_pivot_pd_copy</span><span class="p">,</span> <span class="s1">&#39;PaymentsForRepurchaseOfStockTotal&#39;</span><span class="p">,</span> 
                                 <span class="p">[</span><span class="s1">&#39;PaymentsForRepurchaseOfCommonStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;PaymentsForRepurchaseOfRedeemablePreferredStock&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-empty-companies">Clean empty companies<a class="anchor-link" href="#Clean-empty-companies"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_selected</span> <span class="o">=</span> <span class="n">cf_pivot_pd_copy</span><span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> 
                                     <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetIncomeLoss&#39;</span><span class="p">,</span> <span class="s1">&#39;ProfitLoss&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInOperatingActivities&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;NetCashProvidedByUsedInInvestingActivities&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;NetCashProvidedByUsedInFinancingActivities&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">incomplete_ciks</span> <span class="o">=</span> <span class="n">cf_cols_selected</span><span class="p">[</span><span class="n">cf_cols_selected</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>514</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span> <span class="o">=</span> <span class="n">cf_cols_selected</span><span class="p">[</span><span class="o">~</span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">cik</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">incomplete_ciks</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(117038, 11)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save">Save<a class="anchor-link" href="#Save"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_cols_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">all_processed_folder</span> <span class="o">+</span> <span class="s2">&quot;cf.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="xx_trials">xx_trials<a class="anchor-link" href="#xx_trials"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="p">[(</span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">StockholdersEquity</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>  <span class="p">][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;StockholdersEquityBeforeTreasuryStock&quot;</span><span class="p">,</span> <span class="s2">&quot;LiabilitiesAndStockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;RetainedEarningsAccumulatedDeficit&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selected</span> <span class="o">=</span> <span class="n">bs_piivot_pd_copy</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FXE&#39;</span>
<span class="n">sel_df</span> <span class="o">=</span> <span class="n">bs_piivot_pd_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>
<span class="n">do_copy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="s1">&#39;AssetsCurrent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sel_df</span><span class="p">[</span><span class="s1">&#39;Assets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
<span class="n">do_copy</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>34</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">cf_pivot_pd_copy</span><span class="p">[(</span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">Dividends</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>  \
<span class="c1">#              &amp;(cf_pivot_pd_copy.PaymentsOfDividendsCommonStock.notnull())  \</span>
<span class="c1">#                &amp;(cf_pivot_pd_copy.CashProvidedByUsedInFinancingActivitiesDiscontinuedOperations.notnull()) </span>
                <span class="p">]</span> \
  <span class="p">[[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> 
<span class="s1">&#39;Dividends&#39;</span><span class="p">,</span>
<span class="s1">&#39;PaymentsOfDividends&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PaymentsOfDividendsCommonStock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PaymentsOfDividendsMinorityInterest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PaymentsOfDividendsPreferredStockAndPreferenceStock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PaymentsOfOrdinaryDividends&#39;</span>

    <span class="p">]]</span> \
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cik</th>
      <th>ticker</th>
      <th>adsh</th>
      <th>period</th>
      <th>Dividends</th>
      <th>PaymentsOfDividends</th>
      <th>PaymentsOfDividendsCommonStock</th>
      <th>PaymentsOfDividendsMinorityInterest</th>
      <th>PaymentsOfDividendsPreferredStockAndPreferenceStock</th>
      <th>PaymentsOfOrdinaryDividends</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>65024</th>
      <td>91576</td>
      <td>KEY</td>
      <td>0000950123-10-018789</td>
      <td>2009-12-31</td>
      <td>0.0</td>
      <td>213000000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88525</th>
      <td>813920</td>
      <td>CEC</td>
      <td>0001140361-11-025400</td>
      <td>2011-03-31</td>
      <td>-4001000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>131975</th>
      <td>892482</td>
      <td>QUMU</td>
      <td>0000897101-11-001346</td>
      <td>2011-06-30</td>
      <td>-950000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>63359</th>
      <td>1401521</td>
      <td>UIHC</td>
      <td>0001401521-11-000020</td>
      <td>2011-06-30</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>102842</th>
      <td>1273801</td>
      <td>NRF</td>
      <td>0001047469-11-007027</td>
      <td>2011-06-30</td>
      <td>-27860000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18336000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>104588</th>
      <td>912593</td>
      <td>SUI</td>
      <td>0000912593-20-000137</td>
      <td>2020-06-30</td>
      <td>7781000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18311</th>
      <td>928340</td>
      <td>CWCO</td>
      <td>0001558370-20-010684</td>
      <td>2020-06-30</td>
      <td>1288154.0</td>
      <td>NaN</td>
      <td>2564980.0</td>
      <td>NaN</td>
      <td>5738.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>99044</th>
      <td>906345</td>
      <td>CPT</td>
      <td>0000906345-20-000052</td>
      <td>2020-06-30</td>
      <td>84138000.0</td>
      <td>165085000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83351</th>
      <td>706863</td>
      <td>UNB</td>
      <td>0000706863-20-000091</td>
      <td>2020-06-30</td>
      <td>2863000.0</td>
      <td>NaN</td>
      <td>2844000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>59095</th>
      <td>1442145</td>
      <td>VRSK</td>
      <td>0001437749-20-016475</td>
      <td>2020-06-30</td>
      <td>400000.0</td>
      <td>87900000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>270 rows × 10 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_liabilities_copy</span><span class="p">[(</span><span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">StockholdersEquity</span><span class="o">.</span><span class="n">isnull</span><span class="p">())][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;Assets&quot;</span><span class="p">,</span> <span class="s2">&quot;StockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;LiabilitiesAndStockholdersEquity&quot;</span><span class="p">,</span> <span class="s2">&quot;RetainedEarningsAccumulatedDeficit&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_liabilities_copy</span><span class="p">[(</span><span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">adsh</span> <span class="o">==</span> <span class="s1">&#39;0001104659-09-029605&#39;</span><span class="p">)][[</span><span class="s2">&quot;cik&quot;</span><span class="p">,</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span> <span class="s2">&quot;adsh&quot;</span><span class="p">,</span><span class="s2">&quot;period&quot;</span><span class="p">,</span><span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_empty_pd</span> <span class="o">=</span> <span class="n">cf_empty_count</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_empty_pd</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, 3052)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_melt_pd</span> <span class="o">=</span> <span class="n">cf_empty_pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">133811</span> <span class="o">-</span><span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">canditates</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span><span class="s1">&#39;cpy_CashAndCashEquivalentsPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashAndCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashPeriodIncreaseDecrease&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CashPeriodIncreaseDecreaseExcludingExchangeRateEffect&#39;</span><span class="p">]</span>

<span class="n">cf_melt_pd</span><span class="p">[</span><span class="n">cf_melt_pd</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">canditates</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tag</th>
      <th>Count</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>350</th>
      <td>CashAndCashEquivalentsPeriodIncreaseDecrease</td>
      <td>30244</td>
      <td>103567</td>
    </tr>
    <tr>
      <th>351</th>
      <td>CashAndCashEquivalentsPeriodIncreaseDecreaseEx...</td>
      <td>132424</td>
      <td>1387</td>
    </tr>
    <tr>
      <th>360</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>130603</td>
      <td>3208</td>
    </tr>
    <tr>
      <th>361</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>119033</td>
      <td>14778</td>
    </tr>
    <tr>
      <th>382</th>
      <td>CashPeriodIncreaseDecrease</td>
      <td>132236</td>
      <td>1575</td>
    </tr>
    <tr>
      <th>383</th>
      <td>CashPeriodIncreaseDecreaseExcludingExchangeRat...</td>
      <td>133766</td>
      <td>45</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">cf_melt_pd</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span>
<span class="nb">sorted</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">sorted</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_count</span> <span class="o">=</span> <span class="n">get_empty_count</span><span class="p">(</span><span class="n">bs_pivot_value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_pd</span> <span class="o">=</span> <span class="n">empty_count</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span> <span class="o">=</span> <span class="n">empty_pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="c1"># df2 = pd.melt(df, id_vars=[&quot;location&quot;, &quot;name&quot;], var_name=&quot;Date&quot;, value_name=&quot;Value&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">melt_pd</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Tag&#39;, &#39;Count&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_frame</span> <span class="o">=</span> <span class="n">df_all_selected</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0000906345-20-000052&#39; and stmt == &#39;CF&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="c1">#print(pd_frame.sort_values([&#39;report&#39;, &#39;line&#39;]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">pd_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd_frame</span><span class="p">[[</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;stmt&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tag</th>
      <th>value</th>
      <th>stmt</th>
      <th>report</th>
      <th>line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>ProfitLoss</td>
      <td>61978000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ProfitLoss</td>
      <td>17511000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>DepreciationDepletionAndAmortization</td>
      <td>184662000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>33</th>
      <td>GainLossOnDispositionOfAssets1</td>
      <td>382000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>0</th>
      <td>EquityMethodInvestmentDividendsOrDistributions</td>
      <td>4039000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>IncomeLossFromEquityMethodInvestments</td>
      <td>3755000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>IncomeLossFromEquityMethodInvestments</td>
      <td>1600000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ShareBasedCompensation</td>
      <td>7046000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>OtherOperatingActivitiesCashFlowStatement</td>
      <td>-3414000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>10</td>
    </tr>
    <tr>
      <th>19</th>
      <td>NetCashProvidedByUsedInOperatingActivities</td>
      <td>250174000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PaymentsToDevelopRealEstateAssets</td>
      <td>199598000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>13</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PaymentsToAcquireRealEstate</td>
      <td>0.0</td>
      <td>CF</td>
      <td>6</td>
      <td>14</td>
    </tr>
    <tr>
      <th>31</th>
      <td>PaymentsToAcquireOtherPropertyPlantAndEquipment</td>
      <td>4871000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>16</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PaymentsForProceedsFromOtherInvestingActivities</td>
      <td>1920000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>17</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NetCashProvidedByUsedInInvestingActivities</td>
      <td>-205636000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ProceedsFromLinesOfCredit</td>
      <td>358000000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RepaymentsOfLinesOfCredit</td>
      <td>402000000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>21</td>
    </tr>
    <tr>
      <th>27</th>
      <td>RepaymentsOfNotesPayable</td>
      <td>0.0</td>
      <td>CF</td>
      <td>6</td>
      <td>22</td>
    </tr>
    <tr>
      <th>25</th>
      <td>ProceedsFromNotesPayable</td>
      <td>743103000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>23</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PaymentsOfDividends</td>
      <td>165085000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>24</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ProceedsFromIssuanceOfCommonStock</td>
      <td>0.0</td>
      <td>CF</td>
      <td>6</td>
      <td>25</td>
    </tr>
    <tr>
      <th>32</th>
      <td>PaymentsOfFinancingCosts</td>
      <td>686000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>26</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ProceedsFromPaymentsForOtherFinancingActivities</td>
      <td>308000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>27</td>
    </tr>
    <tr>
      <th>28</th>
      <td>NetCashProvidedByUsedInFinancingActivities</td>
      <td>533640000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>578178000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>29</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>605677000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>30</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>605677000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>31</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CashAndCashEquivalentsAtCarryingValue</td>
      <td>601584000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>33</td>
    </tr>
    <tr>
      <th>11</th>
      <td>RestrictedCashAndCashEquivalents</td>
      <td>4093000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>34</td>
    </tr>
    <tr>
      <th>20</th>
      <td>CashCashEquivalentsRestrictedCashAndRestricted...</td>
      <td>605677000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>35</td>
    </tr>
    <tr>
      <th>30</th>
      <td>InterestPaidNet</td>
      <td>40551000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>37</td>
    </tr>
    <tr>
      <th>34</th>
      <td>IncomeTaxesPaid</td>
      <td>146000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>38</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Dividends</td>
      <td>84138000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ProceedsFromIssuanceOfSharesUnderIncentiveAndS...</td>
      <td>20117000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>41</td>
    </tr>
    <tr>
      <th>18</th>
      <td>RightOfUseAssetObtainedInExchangeForOperatingL...</td>
      <td>69000.0</td>
      <td>CF</td>
      <td>6</td>
      <td>43</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsIncludingDisposalGroupAndDiscontinuedOperations</span>
<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsIncludingDisposalGroupAndDiscontinuedOperations</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalentsPeriodIncreaseDecreaseIncludingExchangeRateEffect</span>

<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents</span>
<span class="n">gaap_CashCashEquivalentsRestrictedCashAndRestrictedCashEquivalents</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs_pivot_report</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;adsh == &#39;0001492298-20-000025&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>585411</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;BS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>133872</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_selected</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;adsh&#39;</span><span class="p">,</span><span class="s1">&#39;stmt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;stmt = &quot;EQ&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>86120</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#[x for x in cf_pivot_pd_copy.columns.values if (&#39;Dividends&#39; in x)]</span>
<span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cf_pivot_pd_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Repurchase&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;Stock&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;EmployeeStockOwnershipPlanESOPRepurchaseObligationAmount&#39;,
 &#39;PaymentsForRepurchaseOfCommonStock&#39;,
 &#39;PaymentsForRepurchaseOfCommonStockForEmployeeTaxWithholdingObligations&#39;,
 &#39;PaymentsForRepurchaseOfConvertiblePreferredStock&#39;,
 &#39;PaymentsForRepurchaseOfPreferredStockAndPreferenceStock&#39;,
 &#39;PaymentsForRepurchaseOfRedeemableConvertiblePreferredStock&#39;,
 &#39;PaymentsForRepurchaseOfRedeemablePreferredStock&#39;,
 &#39;ProceedsFromRepurchaseOfRedeemablePreferredStock&#39;,
 &#39;StockRepurchaseProgramRemainingAuthorizedRepurchaseAmount&#39;,
 &#39;StockRepurchasedAndRetiredDuringPeriodShares&#39;,
 &#39;StockRepurchasedAndRetiredDuringPeriodValue&#39;,
 &#39;StockRepurchasedDuringPeriodShares&#39;,
 &#39;StockRepurchasedDuringPeriodValue&#39;,
 &#39;TreasuryStockReissuedAtLowerThanRepurchasePrice&#39;,
 &#39;WeightedAverageNumberOfSharesCommonStockSubjectToRepurchaseOrCancellation&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bs_pivot_liabilities_copy</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;StockholdersEquity&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;StockholdersEquity&#39;,
 &#39;StockholdersEquityAttributableToParentNotAllowableForNetCapital&#39;,
 &#39;StockholdersEquityBeforeTreasuryStock&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest&#39;,
 &#39;StockholdersEquityIncludingPortionAttributableToNoncontrollingInterestAdjustedBalance1&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio&#39;,
 &#39;StockholdersEquityNoteStockSplitConversionRatio1&#39;,
 &#39;StockholdersEquityNoteSubscriptionsReceivable&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

